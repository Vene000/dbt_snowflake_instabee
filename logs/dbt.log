[0m02:58:50.272834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223077379B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223070F8CB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000223050417C0>]}


============================== 02:58:50.301625 | 740cd08f-d1f1-40f0-9151-9a70e78c76d0 ==============================
[0m02:58:50.301625 [info ] [MainThread]: Running with dbt=1.9.4
[0m02:58:50.302631 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Venee\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m02:58:50.303890 [error] [MainThread]: Encountered an error:
Runtime Error
  No dbt_project.yml found at expected path E:\desk\onedrive\Desktop\snowflake_instabee\dbt_project.yml
  Verify that each entry within packages.yml (and their transitive dependencies) contains a file named dbt_project.yml
  
[0m02:58:50.305907 [debug] [MainThread]: Command `dbt deps` failed at 02:58:50.305907 after 0.39 seconds
[0m02:58:50.306914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022307A4A060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002230795EC00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002230795DDC0>]}
[0m02:58:50.306914 [debug] [MainThread]: Flushing usage events
[0m02:58:50.788431 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:01:18.859003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BBA3E5EC60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BBA3E5EE10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BBA3E5EE70>]}


============================== 03:01:18.870165 | b69194ea-6b8e-4087-b164-5cad4c9795f9 ==============================
[0m03:01:18.870165 [info ] [MainThread]: Running with dbt=1.9.4
[0m03:01:18.870165 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Venee\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'E:\\desk\\onedrive\\Desktop\\snowflake_instabee\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt deps', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m03:01:18.880199 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m03:01:18.882204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'b69194ea-6b8e-4087-b164-5cad4c9795f9', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BBA51FBB90>]}
[0m03:01:19.076172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b69194ea-6b8e-4087-b164-5cad4c9795f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BBA3E5EE70>]}
[0m03:01:19.442823 [debug] [MainThread]: Set downloads directory='C:\Users\Venee\AppData\Local\Temp\dbt-downloads-rlm4x04j'
[0m03:01:19.454914 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m03:01:19.569786 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m03:01:19.578172 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m03:01:19.630892 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m03:01:19.648346 [info ] [MainThread]: Updating lock file in file path: E:\desk\onedrive\Desktop\snowflake_instabee/package-lock.yml
[0m03:01:19.664379 [debug] [MainThread]: Set downloads directory='C:\Users\Venee\AppData\Local\Temp\dbt-downloads-rejkk5k9'
[0m03:01:19.664379 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m03:01:20.122543 [info ] [MainThread]: Installed from version 1.3.0
[0m03:01:20.122543 [info ] [MainThread]: Up to date!
[0m03:01:20.122543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'b69194ea-6b8e-4087-b164-5cad4c9795f9', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BBA549F020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BBA549FFE0>]}
[0m03:01:20.122543 [debug] [MainThread]: Command `dbt deps` succeeded at 03:01:20.122543 after 1.58 seconds
[0m03:01:20.122543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BBA38726F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BBA3ADDA00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BBA3EE8200>]}
[0m03:01:20.122543 [debug] [MainThread]: Flushing usage events
[0m03:01:20.635086 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:01:47.541675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B2D25DE50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B2D25ED20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B2D25EBA0>]}


============================== 03:01:47.550615 | c8d76be8-6510-4bf8-8531-ca22c1cd7a3f ==============================
[0m03:01:47.550615 [info ] [MainThread]: Running with dbt=1.9.4
[0m03:01:47.550615 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'E:\\desk\\onedrive\\Desktop\\snowflake_instabee\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\Venee\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m03:01:47.555025 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'default'
[0m03:01:47.556335 [debug] [MainThread]: Command `dbt run` failed at 03:01:47.556335 after 0.18 seconds
[0m03:01:47.557338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B2D5977A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B2D6F2960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B2BBAC080>]}
[0m03:01:47.557338 [debug] [MainThread]: Flushing usage events
[0m03:01:48.077940 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:06:24.611027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216C04DF440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216C02B79B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216BE038F20>]}


============================== 03:06:24.618668 | 3a3c1cff-578b-44d3-a402-32c24590a34e ==============================
[0m03:06:24.618668 [info ] [MainThread]: Running with dbt=1.9.4
[0m03:06:24.619614 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'E:\\desk\\onedrive\\Desktop\\snowflake_instabee\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\Venee\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m03:06:24.631031 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m03:06:24.631031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '3a3c1cff-578b-44d3-a402-32c24590a34e', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216C0D6F410>]}
[0m03:06:24.887507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3a3c1cff-578b-44d3-a402-32c24590a34e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216B9E68710>]}
[0m03:06:25.101785 [debug] [MainThread]: Set downloads directory='C:\Users\Venee\AppData\Local\Temp\dbt-downloads-8pryia2e'
[0m03:06:25.102465 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m03:06:25.165288 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m03:06:25.166296 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m03:06:25.201737 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m03:06:25.209177 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m03:06:25.766442 [info ] [MainThread]: Installed from version 1.3.0
[0m03:06:25.768212 [info ] [MainThread]: Up to date!
[0m03:06:25.770341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '3a3c1cff-578b-44d3-a402-32c24590a34e', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216BE038F20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216C0D28320>]}
[0m03:06:25.773166 [debug] [MainThread]: Command `dbt deps` succeeded at 03:06:25.773166 after 1.41 seconds
[0m03:06:25.774172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216BEF0A720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216C0635A30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216C0D6E090>]}
[0m03:06:25.774172 [debug] [MainThread]: Flushing usage events
[0m03:06:26.219246 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:06:36.769698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF18071130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF18071250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF18071430>]}


============================== 03:06:36.775905 | 6d773da2-174c-4feb-ae32-74d919cf83d7 ==============================
[0m03:06:36.775905 [info ] [MainThread]: Running with dbt=1.9.4
[0m03:06:36.776919 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Venee\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'E:\\desk\\onedrive\\Desktop\\snowflake_instabee\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m03:06:36.797586 [error] [MainThread]: Encountered an error:
Parsing Error
  Env var required but not provided: 'PC_DBT_USER'
[0m03:06:36.798825 [debug] [MainThread]: Command `dbt run` failed at 03:06:36.798825 after 0.19 seconds
[0m03:06:36.800292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF185A4740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF16DF8590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF1892E930>]}
[0m03:06:36.800292 [debug] [MainThread]: Flushing usage events
[0m03:06:37.316687 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:15:00.578210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CBC241BFE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CBC083D6A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CBC46E1040>]}


============================== 03:15:00.584606 | 73ed5480-9557-43cf-a3e8-a0ac7931643a ==============================
[0m03:15:00.584606 [info ] [MainThread]: Running with dbt=1.9.4
[0m03:15:00.585714 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Venee\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'E:\\desk\\onedrive\\Desktop\\snowflake_instabee\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m03:15:00.796926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '73ed5480-9557-43cf-a3e8-a0ac7931643a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CBC60F9A00>]}
[0m03:15:00.913427 [debug] [MainThread]: Set downloads directory='C:\Users\Venee\AppData\Local\Temp\dbt-downloads-up8vam3z'
[0m03:15:00.913427 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m03:15:00.990077 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m03:15:00.991080 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m03:15:01.021979 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m03:15:01.027979 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m03:15:01.496372 [info ] [MainThread]: Installed from version 1.3.0
[0m03:15:01.496372 [info ] [MainThread]: Up to date!
[0m03:15:01.497410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '73ed5480-9557-43cf-a3e8-a0ac7931643a', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CBC61F2BA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CBC61F3560>]}
[0m03:15:01.501956 [debug] [MainThread]: Command `dbt deps` succeeded at 03:15:01.500954 after 1.19 seconds
[0m03:15:01.502969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CBC4F72060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CBC4681400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CBC4682300>]}
[0m03:15:01.503397 [debug] [MainThread]: Flushing usage events
[0m03:15:01.962252 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:15:16.149246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208BA0E32F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208BA0E31A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208BA0E2720>]}


============================== 03:15:16.155729 | 5a515693-3878-4e61-a3c7-63ead5c111fb ==============================
[0m03:15:16.155729 [info ] [MainThread]: Running with dbt=1.9.4
[0m03:15:16.156950 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Venee\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'E:\\desk\\onedrive\\Desktop\\snowflake_instabee\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m03:15:17.386817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5a515693-3878-4e61-a3c7-63ead5c111fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208C4282330>]}
[0m03:15:17.548006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5a515693-3878-4e61-a3c7-63ead5c111fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208BA5E8E60>]}
[0m03:15:17.550008 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m03:15:18.488088 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m03:15:18.489090 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m03:15:18.490359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '5a515693-3878-4e61-a3c7-63ead5c111fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208C440FD70>]}
[0m03:15:23.388434 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'sales_over_time' in the 'models' section of file 'models\marts\marts_schema.yml'
[0m03:15:23.868402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5a515693-3878-4e61-a3c7-63ead5c111fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208C49137A0>]}
[0m03:15:24.030322 [debug] [MainThread]: Wrote artifact WritableManifest to E:\desk\onedrive\Desktop\snowflake_instabee\target\manifest.json
[0m03:15:24.039571 [debug] [MainThread]: Wrote artifact SemanticManifest to E:\desk\onedrive\Desktop\snowflake_instabee\target\semantic_manifest.json
[0m03:15:24.230552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5a515693-3878-4e61-a3c7-63ead5c111fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208C44903B0>]}
[0m03:15:24.230552 [info ] [MainThread]: Found 15 models, 17 data tests, 3 sources, 590 macros
[0m03:15:24.232012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5a515693-3878-4e61-a3c7-63ead5c111fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208C43A0470>]}
[0m03:15:24.235028 [info ] [MainThread]: 
[0m03:15:24.235028 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:15:24.236174 [info ] [MainThread]: 
[0m03:15:24.236174 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m03:15:24.243743 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PC_DBT_DB'
[0m03:15:28.442982 [debug] [ThreadPool]: Using snowflake connection "list_PC_DBT_DB"
[0m03:15:28.442982 [debug] [ThreadPool]: On list_PC_DBT_DB: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "connection_name": "list_PC_DBT_DB"} */
show terse schemas in database PC_DBT_DB
    limit 10000
[0m03:15:28.443983 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:15:30.795990 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "connection_name": "list_PC_DBT_DB"} */
show terse schemas in database PC_DBT_DB
    limit 10000
[0m03:15:30.797369 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m03:15:30.798372 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_schemas
[0m03:15:30.798372 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m03:15:30.799373 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:15:30.799373 [debug] [MainThread]: Connection 'list_PC_DBT_DB' was left open.
[0m03:15:30.800871 [debug] [MainThread]: On list_PC_DBT_DB: No close available on handle
[0m03:15:30.801879 [info ] [MainThread]: 
[0m03:15:30.801879 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 6.56 seconds (6.56s).
[0m03:15:30.803290 [error] [MainThread]: Encountered an error:
Runtime Error
  Database error while listing schemas in database "PC_DBT_DB"
  Database Error
    250001 (08001): Failed to connect to DB: XU17144.europe-west4.gcp.snowflakecomputing.com:443. Incorrect username or password was specified.
[0m03:15:30.806081 [debug] [MainThread]: Command `dbt run` failed at 03:15:30.806081 after 14.82 seconds
[0m03:15:30.807033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208BA3DFF80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208C44C6EA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208C4B45760>]}
[0m03:15:30.808202 [debug] [MainThread]: Flushing usage events
[0m03:15:31.341085 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:31:16.380188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000158EDB5AF60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000158ED489100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000158ED463590>]}


============================== 03:31:16.386188 | 1771558b-58ca-48a6-aca2-aabd3b7b1636 ==============================
[0m03:31:16.386188 [info ] [MainThread]: Running with dbt=1.9.4
[0m03:31:16.387189 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\Venee\\.dbt', 'log_path': 'E:\\desk\\onedrive\\Desktop\\snowflake_instabee\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt debug', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m03:31:16.439172 [info ] [MainThread]: dbt version: 1.9.4
[0m03:31:16.440114 [info ] [MainThread]: python version: 3.12.10
[0m03:31:16.440114 [info ] [MainThread]: python path: C:\Users\Venee\AppData\Local\Microsoft\WindowsApps\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\python.exe
[0m03:31:16.441281 [info ] [MainThread]: os info: Windows-11-10.0.26100-SP0
[0m03:31:17.560601 [info ] [MainThread]: Using profiles dir at C:\Users\Venee\.dbt
[0m03:31:17.560601 [info ] [MainThread]: Using profiles.yml file at C:\Users\Venee\.dbt\profiles.yml
[0m03:31:17.560601 [info ] [MainThread]: Using dbt_project.yml file at E:\desk\onedrive\Desktop\snowflake_instabee\dbt_project.yml
[0m03:31:17.562096 [info ] [MainThread]: adapter type: snowflake
[0m03:31:17.563223 [info ] [MainThread]: adapter version: 1.9.2
[0m03:31:17.725894 [info ] [MainThread]: Configuration:
[0m03:31:17.727026 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m03:31:17.727026 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m03:31:17.727026 [info ] [MainThread]: Required dependencies:
[0m03:31:17.728470 [debug] [MainThread]: Executing "git --help"
[0m03:31:17.830083 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m03:31:17.831100 [debug] [MainThread]: STDERR: "b''"
[0m03:31:17.832101 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m03:31:17.832101 [info ] [MainThread]: Connection:
[0m03:31:17.833342 [info ] [MainThread]:   account: XU17144.europe-west4.gcp
[0m03:31:17.833342 [info ] [MainThread]:   user: PC_DBT_USER
[0m03:31:17.834387 [info ] [MainThread]:   database: PC_DBT_DB
[0m03:31:17.834387 [info ] [MainThread]:   warehouse: PC_DBT_WH
[0m03:31:17.835442 [info ] [MainThread]:   role: PC_DBT_ROLE
[0m03:31:17.835442 [info ] [MainThread]:   schema: DBT_
[0m03:31:17.836460 [info ] [MainThread]:   authenticator: None
[0m03:31:17.836460 [info ] [MainThread]:   oauth_client_id: None
[0m03:31:17.837469 [info ] [MainThread]:   query_tag: None
[0m03:31:17.837469 [info ] [MainThread]:   client_session_keep_alive: False
[0m03:31:17.839738 [info ] [MainThread]:   host: None
[0m03:31:17.840737 [info ] [MainThread]:   port: None
[0m03:31:17.842721 [info ] [MainThread]:   proxy_host: None
[0m03:31:17.842721 [info ] [MainThread]:   proxy_port: None
[0m03:31:17.843878 [info ] [MainThread]:   protocol: None
[0m03:31:17.843878 [info ] [MainThread]:   connect_retries: 1
[0m03:31:17.843878 [info ] [MainThread]:   connect_timeout: None
[0m03:31:17.845238 [info ] [MainThread]:   retry_on_database_errors: False
[0m03:31:17.845238 [info ] [MainThread]:   retry_all: False
[0m03:31:17.845238 [info ] [MainThread]:   insecure_mode: False
[0m03:31:17.846614 [info ] [MainThread]:   reuse_connections: True
[0m03:31:17.846614 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m03:31:18.611738 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m03:31:18.733383 [debug] [MainThread]: Using snowflake connection "debug"
[0m03:31:18.734385 [debug] [MainThread]: On debug: select 1 as id
[0m03:31:18.734385 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:31:19.312854 [debug] [MainThread]: Snowflake adapter: Error running SQL: select 1 as id
[0m03:31:19.313853 [debug] [MainThread]: Snowflake adapter: Rolling back transaction.
[0m03:31:19.314854 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m03:31:19.315854 [info ] [MainThread]: [31m1 check failed:[0m
[0m03:31:19.316854 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  250001 (08001): Failed to connect to DB: XU17144.europe-west4.gcp.snowflakecomputing.com:443. Incorrect username or password was specified.

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m03:31:19.318854 [debug] [MainThread]: Command `dbt debug` failed at 03:31:19.318854 after 3.33 seconds
[0m03:31:19.320855 [debug] [MainThread]: Connection 'debug' was left open.
[0m03:31:19.321193 [debug] [MainThread]: On debug: No close available on handle
[0m03:31:19.323190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000158ED915100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000158ED463590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000158F5AC74D0>]}
[0m03:31:19.324189 [debug] [MainThread]: Flushing usage events
[0m03:31:19.878410 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m04:01:08.219205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017B9052C890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017B93748200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017B907C6600>]}


============================== 04:01:08.227453 | 8391612f-f6ef-4322-b46c-dd99b538cf0f ==============================
[0m04:01:08.227453 [info ] [MainThread]: Running with dbt=1.9.4
[0m04:01:08.228783 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'E:\\desk\\onedrive\\Desktop\\snowflake_instabee\\logs', 'profiles_dir': 'C:\\Users\\Venee\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt debug', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m04:01:08.253258 [info ] [MainThread]: dbt version: 1.9.4
[0m04:01:08.253258 [info ] [MainThread]: python version: 3.12.10
[0m04:01:08.254261 [info ] [MainThread]: python path: C:\Users\Venee\AppData\Local\Microsoft\WindowsApps\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\python.exe
[0m04:01:08.254261 [info ] [MainThread]: os info: Windows-11-10.0.26100-SP0
[0m04:01:09.469962 [info ] [MainThread]: Using profiles dir at C:\Users\Venee\.dbt
[0m04:01:09.469962 [info ] [MainThread]: Using profiles.yml file at C:\Users\Venee\.dbt\profiles.yml
[0m04:01:09.471384 [info ] [MainThread]: Using dbt_project.yml file at E:\desk\onedrive\Desktop\snowflake_instabee\dbt_project.yml
[0m04:01:09.473318 [info ] [MainThread]: adapter type: snowflake
[0m04:01:09.474321 [info ] [MainThread]: adapter version: 1.9.2
[0m04:01:09.640885 [info ] [MainThread]: Configuration:
[0m04:01:09.640885 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m04:01:09.641887 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m04:01:09.642699 [info ] [MainThread]: Required dependencies:
[0m04:01:09.642699 [debug] [MainThread]: Executing "git --help"
[0m04:01:09.673493 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m04:01:09.674650 [debug] [MainThread]: STDERR: "b''"
[0m04:01:09.675650 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m04:01:09.676001 [info ] [MainThread]: Connection:
[0m04:01:09.676998 [info ] [MainThread]:   account: XU17144.europe-west4.gcp
[0m04:01:09.676998 [info ] [MainThread]:   user: VENNALLAA
[0m04:01:09.677996 [info ] [MainThread]:   database: PC_DBT_DB
[0m04:01:09.677996 [info ] [MainThread]:   warehouse: COMPUTE_WH
[0m04:01:09.678996 [info ] [MainThread]:   role: ACCOUNTADMIN
[0m04:01:09.678996 [info ] [MainThread]:   schema: DBT_
[0m04:01:09.679996 [info ] [MainThread]:   authenticator: None
[0m04:01:09.679996 [info ] [MainThread]:   oauth_client_id: None
[0m04:01:09.679996 [info ] [MainThread]:   query_tag: None
[0m04:01:09.680996 [info ] [MainThread]:   client_session_keep_alive: False
[0m04:01:09.680996 [info ] [MainThread]:   host: None
[0m04:01:09.681997 [info ] [MainThread]:   port: None
[0m04:01:09.681997 [info ] [MainThread]:   proxy_host: None
[0m04:01:09.682997 [info ] [MainThread]:   proxy_port: None
[0m04:01:09.682997 [info ] [MainThread]:   protocol: None
[0m04:01:09.682997 [info ] [MainThread]:   connect_retries: 1
[0m04:01:09.683997 [info ] [MainThread]:   connect_timeout: None
[0m04:01:09.683997 [info ] [MainThread]:   retry_on_database_errors: False
[0m04:01:09.684997 [info ] [MainThread]:   retry_all: False
[0m04:01:09.684997 [info ] [MainThread]:   insecure_mode: False
[0m04:01:09.685997 [info ] [MainThread]:   reuse_connections: True
[0m04:01:09.685997 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m04:01:10.454643 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m04:01:10.567573 [debug] [MainThread]: Using snowflake connection "debug"
[0m04:01:10.567573 [debug] [MainThread]: On debug: select 1 as id
[0m04:01:10.568578 [debug] [MainThread]: Opening a new connection, currently in state init
[0m04:01:11.139300 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.571 seconds
[0m04:01:11.140810 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m04:01:11.141738 [info ] [MainThread]: [32mAll checks passed![0m
[0m04:01:11.142896 [debug] [MainThread]: Command `dbt debug` succeeded at 04:01:11.142896 after 3.18 seconds
[0m04:01:11.143906 [debug] [MainThread]: Connection 'debug' was left open.
[0m04:01:11.143906 [debug] [MainThread]: On debug: Close
[0m04:01:11.256242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017B9DE41040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017B9D6CEC00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017B93BA5B80>]}
[0m04:01:11.257241 [debug] [MainThread]: Flushing usage events
[0m04:01:11.894911 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m04:02:19.604836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2A4DEF170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2A2B13FE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2A4CE7D40>]}


============================== 04:02:19.618362 | 4003a300-1187-460a-a374-77bfd3f71cb6 ==============================
[0m04:02:19.618362 [info ] [MainThread]: Running with dbt=1.9.4
[0m04:02:19.619490 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Venee\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'E:\\desk\\onedrive\\Desktop\\snowflake_instabee\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m04:02:20.990709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4003a300-1187-460a-a374-77bfd3f71cb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2B010DDC0>]}
[0m04:02:21.082820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4003a300-1187-460a-a374-77bfd3f71cb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2ADFCDD00>]}
[0m04:02:21.084824 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m04:02:21.905855 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m04:02:22.161669 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m04:02:22.161669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '4003a300-1187-460a-a374-77bfd3f71cb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2B0631010>]}
[0m04:02:24.656682 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'sales_over_time' in the 'models' section of file 'models\marts\marts_schema.yml'
[0m04:02:25.059252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4003a300-1187-460a-a374-77bfd3f71cb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2B07871A0>]}
[0m04:02:25.193074 [debug] [MainThread]: Wrote artifact WritableManifest to E:\desk\onedrive\Desktop\snowflake_instabee\target\manifest.json
[0m04:02:25.200503 [debug] [MainThread]: Wrote artifact SemanticManifest to E:\desk\onedrive\Desktop\snowflake_instabee\target\semantic_manifest.json
[0m04:02:25.242184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4003a300-1187-460a-a374-77bfd3f71cb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2B08F9AC0>]}
[0m04:02:25.242184 [info ] [MainThread]: Found 15 models, 17 data tests, 3 sources, 590 macros
[0m04:02:25.243196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4003a300-1187-460a-a374-77bfd3f71cb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2B0820DA0>]}
[0m04:02:25.247241 [info ] [MainThread]: 
[0m04:02:25.248248 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:02:25.249256 [info ] [MainThread]: 
[0m04:02:25.249256 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m04:02:25.257702 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PC_DBT_DB'
[0m04:02:25.395537 [debug] [ThreadPool]: Using snowflake connection "list_PC_DBT_DB"
[0m04:02:25.395537 [debug] [ThreadPool]: On list_PC_DBT_DB: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "connection_name": "list_PC_DBT_DB"} */
show terse schemas in database PC_DBT_DB
    limit 10000
[0m04:02:25.396543 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:02:26.079630 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.684 seconds
[0m04:02:26.084675 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PC_DBT_DB_DBT_'
[0m04:02:26.109974 [debug] [ThreadPool]: Using snowflake connection "list_PC_DBT_DB_DBT_"
[0m04:02:26.110974 [debug] [ThreadPool]: On list_PC_DBT_DB_DBT_: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "connection_name": "list_PC_DBT_DB_DBT_"} */
show objects in PC_DBT_DB.DBT_ limit 10000;
[0m04:02:26.110974 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:02:26.630535 [debug] [ThreadPool]: SQL status: SUCCESS 15 in 0.519 seconds
[0m04:02:26.639250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4003a300-1187-460a-a374-77bfd3f71cb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2A2E974A0>]}
[0m04:02:26.698870 [debug] [Thread-1 (]: Began running node model.snowflake_instabee.generate_surrogate_key
[0m04:02:26.699872 [info ] [Thread-1 (]: 1 of 15 START sql view model DBT_.generate_surrogate_key ....................... [RUN]
[0m04:02:26.701002 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.snowflake_instabee.generate_surrogate_key'
[0m04:02:26.701002 [debug] [Thread-1 (]: Began compiling node model.snowflake_instabee.generate_surrogate_key
[0m04:02:26.714921 [debug] [Thread-1 (]: Writing injected SQL for node "model.snowflake_instabee.generate_surrogate_key"
[0m04:02:26.715926 [debug] [Thread-1 (]: Began executing node model.snowflake_instabee.generate_surrogate_key
[0m04:02:26.764649 [debug] [Thread-1 (]: Writing runtime sql for node "model.snowflake_instabee.generate_surrogate_key"
[0m04:02:26.767094 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.generate_surrogate_key"
[0m04:02:26.768148 [debug] [Thread-1 (]: On model.snowflake_instabee.generate_surrogate_key: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.generate_surrogate_key"} */
create or replace   view PC_DBT_DB.DBT_.generate_surrogate_key
  
   as (
    
  );
[0m04:02:26.769155 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m04:02:27.402425 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bbd3d6-0001-b44c-0002-47d2000780fa
[0m04:02:27.403360 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 5 at position 2 unexpected ')'.
[0m04:02:27.412541 [debug] [Thread-1 (]: Database Error in model generate_surrogate_key (models\macros\generate_surrogate_key.sql)
  001003 (42000): SQL compilation error:
  syntax error line 5 at position 2 unexpected ')'.
  compiled code at target\run\snowflake_instabee\models\macros\generate_surrogate_key.sql
[0m04:02:27.429273 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4003a300-1187-460a-a374-77bfd3f71cb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2B0D87E00>]}
[0m04:02:27.430609 [error] [Thread-1 (]: 1 of 15 ERROR creating sql view model DBT_.generate_surrogate_key .............. [[31mERROR[0m in 0.71s]
[0m04:02:27.431615 [debug] [Thread-1 (]: Finished running node model.snowflake_instabee.generate_surrogate_key
[0m04:02:27.432620 [debug] [Thread-1 (]: Began running node model.snowflake_instabee.my_first_dbt_model
[0m04:02:27.432620 [debug] [Thread-4 (]: Marking all children of 'model.snowflake_instabee.generate_surrogate_key' to be skipped because of status 'error'.  Reason: Database Error in model generate_surrogate_key (models\macros\generate_surrogate_key.sql)
  001003 (42000): SQL compilation error:
  syntax error line 5 at position 2 unexpected ')'.
  compiled code at target\run\snowflake_instabee\models\macros\generate_surrogate_key.sql.
[0m04:02:27.433625 [info ] [Thread-1 (]: 2 of 15 START sql table model DBT_.my_first_dbt_model .......................... [RUN]
[0m04:02:27.434753 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.snowflake_instabee.generate_surrogate_key, now model.snowflake_instabee.my_first_dbt_model)
[0m04:02:27.435758 [debug] [Thread-1 (]: Began compiling node model.snowflake_instabee.my_first_dbt_model
[0m04:02:27.440123 [debug] [Thread-1 (]: Writing injected SQL for node "model.snowflake_instabee.my_first_dbt_model"
[0m04:02:27.443248 [debug] [Thread-1 (]: Began executing node model.snowflake_instabee.my_first_dbt_model
[0m04:02:27.484797 [debug] [Thread-1 (]: Writing runtime sql for node "model.snowflake_instabee.my_first_dbt_model"
[0m04:02:27.486649 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.my_first_dbt_model"
[0m04:02:27.487765 [debug] [Thread-1 (]: On model.snowflake_instabee.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.my_first_dbt_model"} */
create or replace transient table PC_DBT_DB.DBT_.my_first_dbt_model
         as
        (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (
    select 1 as id, 'Example record 1' as description
    union all
    select 2 as id, 'Example record 2' as description
)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
        );
[0m04:02:28.493251 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.004 seconds
[0m04:02:28.538449 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4003a300-1187-460a-a374-77bfd3f71cb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2A2DE0F50>]}
[0m04:02:28.539450 [info ] [Thread-1 (]: 2 of 15 OK created sql table model DBT_.my_first_dbt_model ..................... [[32mSUCCESS 1[0m in 1.10s]
[0m04:02:28.540800 [debug] [Thread-1 (]: Finished running node model.snowflake_instabee.my_first_dbt_model
[0m04:02:28.540800 [debug] [Thread-1 (]: Began running node model.snowflake_instabee.stg_instabee_orders
[0m04:02:28.541808 [info ] [Thread-1 (]: 3 of 15 START sql view model DBT_.stg_instabee_orders .......................... [RUN]
[0m04:02:28.543198 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.snowflake_instabee.my_first_dbt_model, now model.snowflake_instabee.stg_instabee_orders)
[0m04:02:28.543198 [debug] [Thread-1 (]: Began compiling node model.snowflake_instabee.stg_instabee_orders
[0m04:02:28.550226 [debug] [Thread-1 (]: Writing injected SQL for node "model.snowflake_instabee.stg_instabee_orders"
[0m04:02:28.553043 [debug] [Thread-1 (]: Began executing node model.snowflake_instabee.stg_instabee_orders
[0m04:02:28.558179 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.stg_instabee_orders"
[0m04:02:28.558179 [debug] [Thread-1 (]: On model.snowflake_instabee.stg_instabee_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.stg_instabee_orders"} */
select current_warehouse() as warehouse
[0m04:02:28.644530 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.085 seconds
[0m04:02:28.647545 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.stg_instabee_orders"
[0m04:02:28.647545 [debug] [Thread-1 (]: On model.snowflake_instabee.stg_instabee_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.stg_instabee_orders"} */
use warehouse pc_dbt_wh
[0m04:02:28.761668 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.113 seconds
[0m04:02:28.764668 [debug] [Thread-1 (]: Writing runtime sql for node "model.snowflake_instabee.stg_instabee_orders"
[0m04:02:28.768668 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.stg_instabee_orders"
[0m04:02:28.770335 [debug] [Thread-1 (]: On model.snowflake_instabee.stg_instabee_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.stg_instabee_orders"} */
create or replace   view PC_DBT_DB.DBT_.stg_instabee_orders
  
   as (
    with source as (

    select * from INSTABEE.PUBLIC.ORDERS

),

renamed as (

    select 
md5(cast(coalesce(cast(ORDER_ID as TEXT), '') || '-' || coalesce(cast(PRODUCT_ID as TEXT), '') || '-' || coalesce(cast(ROW_ID as TEXT), '') as TEXT)) as ORDER_LINE_ID,
ROW_ID,
ORDER_ID,	
ORDERDATE AS ORDER_DATE,
SHIPDATE AS SHIP_DATE,	
SHIP_MODE,	
CUSTOMER_ID,	
CUSTOMER_NAME,	
SEGMENT,
COUNTRY,
CITY,
STATE,	
POSTAL_CODE,	
REGION,	
PRODUCT_ID,	
CATEGORY as PRODUCT_CATEGORY,	
SUB_CATEGORY,	
PRODUCT_NAME,	
SALES,	
QUANTITY,	
DISCOUNT,	
PROFIT


    from source

)

select * from renamed
  );
[0m04:02:29.142780 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.372 seconds
[0m04:02:29.146793 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.stg_instabee_orders"
[0m04:02:29.147795 [debug] [Thread-1 (]: On model.snowflake_instabee.stg_instabee_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.stg_instabee_orders"} */
use warehouse COMPUTE_WH
[0m04:02:29.228128 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.080 seconds
[0m04:02:29.231154 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4003a300-1187-460a-a374-77bfd3f71cb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2B0E20560>]}
[0m04:02:29.232158 [info ] [Thread-1 (]: 3 of 15 OK created sql view model DBT_.stg_instabee_orders ..................... [[32mSUCCESS 1[0m in 0.69s]
[0m04:02:29.232158 [debug] [Thread-1 (]: Finished running node model.snowflake_instabee.stg_instabee_orders
[0m04:02:29.233249 [debug] [Thread-1 (]: Began running node model.snowflake_instabee.stg_instabee_people
[0m04:02:29.234370 [info ] [Thread-1 (]: 4 of 15 START sql view model DBT_.stg_instabee_people .......................... [RUN]
[0m04:02:29.234370 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.snowflake_instabee.stg_instabee_orders, now model.snowflake_instabee.stg_instabee_people)
[0m04:02:29.235855 [debug] [Thread-1 (]: Began compiling node model.snowflake_instabee.stg_instabee_people
[0m04:02:29.244002 [debug] [Thread-1 (]: Writing injected SQL for node "model.snowflake_instabee.stg_instabee_people"
[0m04:02:29.245004 [debug] [Thread-1 (]: Began executing node model.snowflake_instabee.stg_instabee_people
[0m04:02:29.248021 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.stg_instabee_people"
[0m04:02:29.249025 [debug] [Thread-1 (]: On model.snowflake_instabee.stg_instabee_people: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.stg_instabee_people"} */
select current_warehouse() as warehouse
[0m04:02:29.323749 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.074 seconds
[0m04:02:29.325887 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.stg_instabee_people"
[0m04:02:29.326889 [debug] [Thread-1 (]: On model.snowflake_instabee.stg_instabee_people: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.stg_instabee_people"} */
use warehouse pc_dbt_wh
[0m04:02:29.463769 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.136 seconds
[0m04:02:29.466875 [debug] [Thread-1 (]: Writing runtime sql for node "model.snowflake_instabee.stg_instabee_people"
[0m04:02:29.469001 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.stg_instabee_people"
[0m04:02:29.470189 [debug] [Thread-1 (]: On model.snowflake_instabee.stg_instabee_people: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.stg_instabee_people"} */
create or replace   view PC_DBT_DB.DBT_.stg_instabee_people
  
   as (
    with source as (

    select * from INSTABEE.PUBLIC.PEOPLE

)

select * from source
  );
[0m04:02:29.664942 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.194 seconds
[0m04:02:29.667947 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.stg_instabee_people"
[0m04:02:29.668990 [debug] [Thread-1 (]: On model.snowflake_instabee.stg_instabee_people: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.stg_instabee_people"} */
use warehouse COMPUTE_WH
[0m04:02:29.744638 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.075 seconds
[0m04:02:29.746669 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4003a300-1187-460a-a374-77bfd3f71cb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2B0F4C230>]}
[0m04:02:29.747680 [info ] [Thread-1 (]: 4 of 15 OK created sql view model DBT_.stg_instabee_people ..................... [[32mSUCCESS 1[0m in 0.51s]
[0m04:02:29.748681 [debug] [Thread-1 (]: Finished running node model.snowflake_instabee.stg_instabee_people
[0m04:02:29.750033 [debug] [Thread-1 (]: Began running node model.snowflake_instabee.stg_instabee_returns
[0m04:02:29.751036 [info ] [Thread-1 (]: 5 of 15 START sql view model DBT_.stg_instabee_returns ......................... [RUN]
[0m04:02:29.752085 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.snowflake_instabee.stg_instabee_people, now model.snowflake_instabee.stg_instabee_returns)
[0m04:02:29.753424 [debug] [Thread-1 (]: Began compiling node model.snowflake_instabee.stg_instabee_returns
[0m04:02:29.761044 [debug] [Thread-1 (]: Writing injected SQL for node "model.snowflake_instabee.stg_instabee_returns"
[0m04:02:29.762068 [debug] [Thread-1 (]: Began executing node model.snowflake_instabee.stg_instabee_returns
[0m04:02:29.765218 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.stg_instabee_returns"
[0m04:02:29.766222 [debug] [Thread-1 (]: On model.snowflake_instabee.stg_instabee_returns: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.stg_instabee_returns"} */
select current_warehouse() as warehouse
[0m04:02:29.839182 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.072 seconds
[0m04:02:29.842519 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.stg_instabee_returns"
[0m04:02:29.843026 [debug] [Thread-1 (]: On model.snowflake_instabee.stg_instabee_returns: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.stg_instabee_returns"} */
use warehouse pc_dbt_wh
[0m04:02:29.916552 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.073 seconds
[0m04:02:29.921062 [debug] [Thread-1 (]: Writing runtime sql for node "model.snowflake_instabee.stg_instabee_returns"
[0m04:02:29.923572 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.stg_instabee_returns"
[0m04:02:29.923572 [debug] [Thread-1 (]: On model.snowflake_instabee.stg_instabee_returns: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.stg_instabee_returns"} */
create or replace   view PC_DBT_DB.DBT_.stg_instabee_returns
  
   as (
    WITH source AS (
    SELECT * FROM INSTABEE.PUBLIC.RETURNS
),

deduplicated AS (
    SELECT order_id, MAX(returned) AS returned
    FROM source
    GROUP BY order_id
)

SELECT * FROM deduplicated
  );
[0m04:02:30.122426 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.198 seconds
[0m04:02:30.126764 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.stg_instabee_returns"
[0m04:02:30.127765 [debug] [Thread-1 (]: On model.snowflake_instabee.stg_instabee_returns: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.stg_instabee_returns"} */
use warehouse COMPUTE_WH
[0m04:02:30.202213 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.074 seconds
[0m04:02:30.204375 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4003a300-1187-460a-a374-77bfd3f71cb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2B0D4FDA0>]}
[0m04:02:30.206675 [info ] [Thread-1 (]: 5 of 15 OK created sql view model DBT_.stg_instabee_returns .................... [[32mSUCCESS 1[0m in 0.45s]
[0m04:02:30.208213 [debug] [Thread-1 (]: Finished running node model.snowflake_instabee.stg_instabee_returns
[0m04:02:30.208892 [debug] [Thread-1 (]: Began running node model.snowflake_instabee.my_second_dbt_model
[0m04:02:30.209906 [info ] [Thread-1 (]: 6 of 15 START sql view model DBT_.my_second_dbt_model .......................... [RUN]
[0m04:02:30.211006 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.snowflake_instabee.stg_instabee_returns, now model.snowflake_instabee.my_second_dbt_model)
[0m04:02:30.212015 [debug] [Thread-1 (]: Began compiling node model.snowflake_instabee.my_second_dbt_model
[0m04:02:30.217066 [debug] [Thread-1 (]: Writing injected SQL for node "model.snowflake_instabee.my_second_dbt_model"
[0m04:02:30.218747 [debug] [Thread-1 (]: Began executing node model.snowflake_instabee.my_second_dbt_model
[0m04:02:30.227633 [debug] [Thread-1 (]: Writing runtime sql for node "model.snowflake_instabee.my_second_dbt_model"
[0m04:02:30.228648 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.my_second_dbt_model"
[0m04:02:30.230080 [debug] [Thread-1 (]: On model.snowflake_instabee.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.my_second_dbt_model"} */
create or replace   view PC_DBT_DB.DBT_.my_second_dbt_model
  
   as (
    -- Use the `ref` function to select from other models

select *
from PC_DBT_DB.DBT_.my_first_dbt_model
where id = 1
  );
[0m04:02:30.488666 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.258 seconds
[0m04:02:30.493725 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4003a300-1187-460a-a374-77bfd3f71cb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2B0F893D0>]}
[0m04:02:30.495854 [info ] [Thread-1 (]: 6 of 15 OK created sql view model DBT_.my_second_dbt_model ..................... [[32mSUCCESS 1[0m in 0.28s]
[0m04:02:30.497881 [debug] [Thread-1 (]: Finished running node model.snowflake_instabee.my_second_dbt_model
[0m04:02:30.498894 [debug] [Thread-1 (]: Began running node model.snowflake_instabee.dim_customers
[0m04:02:30.499916 [info ] [Thread-1 (]: 7 of 15 START sql table model DBT_.dim_customers ............................... [RUN]
[0m04:02:30.499916 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.snowflake_instabee.my_second_dbt_model, now model.snowflake_instabee.dim_customers)
[0m04:02:30.500917 [debug] [Thread-1 (]: Began compiling node model.snowflake_instabee.dim_customers
[0m04:02:30.505228 [debug] [Thread-1 (]: Writing injected SQL for node "model.snowflake_instabee.dim_customers"
[0m04:02:30.507733 [debug] [Thread-1 (]: Began executing node model.snowflake_instabee.dim_customers
[0m04:02:30.511171 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.dim_customers"
[0m04:02:30.511171 [debug] [Thread-1 (]: On model.snowflake_instabee.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.dim_customers"} */
select current_warehouse() as warehouse
[0m04:02:30.583897 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.073 seconds
[0m04:02:30.587299 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.dim_customers"
[0m04:02:30.588303 [debug] [Thread-1 (]: On model.snowflake_instabee.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.dim_customers"} */
use warehouse pc_dbt_wh_large
[0m04:02:30.668642 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.079 seconds
[0m04:02:30.674106 [debug] [Thread-1 (]: Writing runtime sql for node "model.snowflake_instabee.dim_customers"
[0m04:02:30.677149 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.dim_customers"
[0m04:02:30.678528 [debug] [Thread-1 (]: On model.snowflake_instabee.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.dim_customers"} */
create or replace transient table PC_DBT_DB.DBT_.dim_customers
         as
        (SELECT DISTINCT
    customer_id,
    customer_name,
    segment
FROM PC_DBT_DB.DBT_.stg_instabee_orders
        );
[0m04:02:32.032061 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.352 seconds
[0m04:02:32.036771 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.dim_customers"
[0m04:02:32.037968 [debug] [Thread-1 (]: On model.snowflake_instabee.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.dim_customers"} */
use warehouse COMPUTE_WH
[0m04:02:32.112964 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.074 seconds
[0m04:02:32.115965 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4003a300-1187-460a-a374-77bfd3f71cb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2B0F88740>]}
[0m04:02:32.117906 [info ] [Thread-1 (]: 7 of 15 OK created sql table model DBT_.dim_customers .......................... [[32mSUCCESS 1[0m in 1.62s]
[0m04:02:32.120088 [debug] [Thread-1 (]: Finished running node model.snowflake_instabee.dim_customers
[0m04:02:32.121086 [debug] [Thread-1 (]: Began running node model.snowflake_instabee.dim_products
[0m04:02:32.122084 [info ] [Thread-1 (]: 8 of 15 START sql table model DBT_.dim_products ................................ [RUN]
[0m04:02:32.122544 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.snowflake_instabee.dim_customers, now model.snowflake_instabee.dim_products)
[0m04:02:32.123717 [debug] [Thread-1 (]: Began compiling node model.snowflake_instabee.dim_products
[0m04:02:32.127716 [debug] [Thread-1 (]: Writing injected SQL for node "model.snowflake_instabee.dim_products"
[0m04:02:32.128717 [debug] [Thread-1 (]: Began executing node model.snowflake_instabee.dim_products
[0m04:02:32.132717 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.dim_products"
[0m04:02:32.132717 [debug] [Thread-1 (]: On model.snowflake_instabee.dim_products: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.dim_products"} */
select current_warehouse() as warehouse
[0m04:02:32.208120 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.074 seconds
[0m04:02:32.210475 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.dim_products"
[0m04:02:32.211477 [debug] [Thread-1 (]: On model.snowflake_instabee.dim_products: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.dim_products"} */
use warehouse pc_dbt_wh_large
[0m04:02:32.284461 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.073 seconds
[0m04:02:32.287680 [debug] [Thread-1 (]: Writing runtime sql for node "model.snowflake_instabee.dim_products"
[0m04:02:32.290279 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.dim_products"
[0m04:02:32.291285 [debug] [Thread-1 (]: On model.snowflake_instabee.dim_products: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.dim_products"} */
create or replace transient table PC_DBT_DB.DBT_.dim_products
         as
        (WITH ranked_products AS (
  SELECT
    product_id,
    product_name,
    product_category,
    sub_category,
    ROW_NUMBER() OVER (
      PARTITION BY product_id 
      ORDER BY product_category NULLS LAST, sub_category NULLS LAST, product_name NULLS LAST
    ) as rn
  FROM PC_DBT_DB.DBT_.stg_instabee_orders
  WHERE product_id IS NOT NULL
  GROUP BY product_id, product_name, product_category, sub_category
)

SELECT
  product_id,
  product_name,
  product_category,
  sub_category
FROM ranked_products
WHERE rn = 1
        );
[0m04:02:33.275375 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.984 seconds
[0m04:02:33.307856 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.dim_products"
[0m04:02:33.308866 [debug] [Thread-1 (]: On model.snowflake_instabee.dim_products: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.dim_products"} */
use warehouse COMPUTE_WH
[0m04:02:33.457431 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.148 seconds
[0m04:02:33.459435 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4003a300-1187-460a-a374-77bfd3f71cb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2B0F4C440>]}
[0m04:02:33.460795 [info ] [Thread-1 (]: 8 of 15 OK created sql table model DBT_.dim_products ........................... [[32mSUCCESS 1[0m in 1.34s]
[0m04:02:33.462047 [debug] [Thread-1 (]: Finished running node model.snowflake_instabee.dim_products
[0m04:02:33.462047 [debug] [Thread-1 (]: Began running node model.snowflake_instabee.dim_regions
[0m04:02:33.463169 [info ] [Thread-1 (]: 9 of 15 START sql table model DBT_.dim_regions ................................. [RUN]
[0m04:02:33.464193 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.snowflake_instabee.dim_products, now model.snowflake_instabee.dim_regions)
[0m04:02:33.464193 [debug] [Thread-1 (]: Began compiling node model.snowflake_instabee.dim_regions
[0m04:02:33.469454 [debug] [Thread-1 (]: Writing injected SQL for node "model.snowflake_instabee.dim_regions"
[0m04:02:33.471125 [debug] [Thread-1 (]: Began executing node model.snowflake_instabee.dim_regions
[0m04:02:33.474410 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.dim_regions"
[0m04:02:33.475413 [debug] [Thread-1 (]: On model.snowflake_instabee.dim_regions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.dim_regions"} */
select current_warehouse() as warehouse
[0m04:02:33.542941 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.067 seconds
[0m04:02:33.544941 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.dim_regions"
[0m04:02:33.545941 [debug] [Thread-1 (]: On model.snowflake_instabee.dim_regions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.dim_regions"} */
use warehouse pc_dbt_wh_large
[0m04:02:33.625868 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.079 seconds
[0m04:02:33.628867 [debug] [Thread-1 (]: Writing runtime sql for node "model.snowflake_instabee.dim_regions"
[0m04:02:33.630869 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.dim_regions"
[0m04:02:33.630869 [debug] [Thread-1 (]: On model.snowflake_instabee.dim_regions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.dim_regions"} */
create or replace transient table PC_DBT_DB.DBT_.dim_regions
         as
        (SELECT DISTINCT
    r.region,
    r.state,
    p.regional_manager
FROM PC_DBT_DB.DBT_.stg_instabee_orders r
LEFT JOIN PC_DBT_DB.DBT_.stg_instabee_people p
    ON r.region = p.region
        );
[0m04:02:35.104427 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.473 seconds
[0m04:02:35.107875 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.dim_regions"
[0m04:02:35.108876 [debug] [Thread-1 (]: On model.snowflake_instabee.dim_regions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.dim_regions"} */
use warehouse COMPUTE_WH
[0m04:02:35.191146 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.081 seconds
[0m04:02:35.193173 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4003a300-1187-460a-a374-77bfd3f71cb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2B0E2B650>]}
[0m04:02:35.194175 [info ] [Thread-1 (]: 9 of 15 OK created sql table model DBT_.dim_regions ............................ [[32mSUCCESS 1[0m in 1.73s]
[0m04:02:35.195179 [debug] [Thread-1 (]: Finished running node model.snowflake_instabee.dim_regions
[0m04:02:35.195179 [debug] [Thread-1 (]: Began running node model.snowflake_instabee.fact_sales
[0m04:02:35.196206 [info ] [Thread-1 (]: 10 of 15 START sql table model DBT_.fact_sales ................................. [RUN]
[0m04:02:35.197209 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.snowflake_instabee.dim_regions, now model.snowflake_instabee.fact_sales)
[0m04:02:35.197209 [debug] [Thread-1 (]: Began compiling node model.snowflake_instabee.fact_sales
[0m04:02:35.203522 [debug] [Thread-1 (]: Writing injected SQL for node "model.snowflake_instabee.fact_sales"
[0m04:02:35.205763 [debug] [Thread-1 (]: Began executing node model.snowflake_instabee.fact_sales
[0m04:02:35.209273 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.fact_sales"
[0m04:02:35.210279 [debug] [Thread-1 (]: On model.snowflake_instabee.fact_sales: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.fact_sales"} */
select current_warehouse() as warehouse
[0m04:02:35.278581 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.068 seconds
[0m04:02:35.281581 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.fact_sales"
[0m04:02:35.281581 [debug] [Thread-1 (]: On model.snowflake_instabee.fact_sales: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.fact_sales"} */
use warehouse pc_dbt_wh_large
[0m04:02:35.357158 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.075 seconds
[0m04:02:35.360179 [debug] [Thread-1 (]: Writing runtime sql for node "model.snowflake_instabee.fact_sales"
[0m04:02:35.363203 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.fact_sales"
[0m04:02:35.364209 [debug] [Thread-1 (]: On model.snowflake_instabee.fact_sales: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.fact_sales"} */
create or replace transient table PC_DBT_DB.DBT_.fact_sales
         as
        (WITH base AS (
    SELECT
        o.order_line_id,
        o.order_id,
        o.order_date,
        o.ship_date,
        o.ship_mode,
        o.customer_id,
        o.product_id,
        o.country,
        o.region,
        o.state,
        o.sales,
        o.quantity,
        o.discount,
        o.profit,
        r.returned
    FROM PC_DBT_DB.DBT_.stg_instabee_orders o
    LEFT JOIN PC_DBT_DB.DBT_.stg_instabee_returns r
        ON o.order_id = r.order_id
)

SELECT *
FROM base
        );
[0m04:02:36.655740 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.292 seconds
[0m04:02:36.660310 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.fact_sales"
[0m04:02:36.661313 [debug] [Thread-1 (]: On model.snowflake_instabee.fact_sales: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.fact_sales"} */
use warehouse COMPUTE_WH
[0m04:02:36.743230 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.081 seconds
[0m04:02:36.745708 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4003a300-1187-460a-a374-77bfd3f71cb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2B0FA4FE0>]}
[0m04:02:36.746710 [info ] [Thread-1 (]: 10 of 15 OK created sql table model DBT_.fact_sales ............................ [[32mSUCCESS 1[0m in 1.55s]
[0m04:02:36.747711 [debug] [Thread-1 (]: Finished running node model.snowflake_instabee.fact_sales
[0m04:02:36.750092 [debug] [Thread-1 (]: Began running node model.snowflake_instabee.month_on_month_change
[0m04:02:36.750641 [info ] [Thread-1 (]: 11 of 15 START sql table model DBT_.month_on_month_change ...................... [RUN]
[0m04:02:36.751702 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.snowflake_instabee.fact_sales, now model.snowflake_instabee.month_on_month_change)
[0m04:02:36.753777 [debug] [Thread-1 (]: Began compiling node model.snowflake_instabee.month_on_month_change
[0m04:02:36.760006 [debug] [Thread-1 (]: Writing injected SQL for node "model.snowflake_instabee.month_on_month_change"
[0m04:02:36.761007 [debug] [Thread-1 (]: Began executing node model.snowflake_instabee.month_on_month_change
[0m04:02:36.765912 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.month_on_month_change"
[0m04:02:36.766819 [debug] [Thread-1 (]: On model.snowflake_instabee.month_on_month_change: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.month_on_month_change"} */
select current_warehouse() as warehouse
[0m04:02:36.835272 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.067 seconds
[0m04:02:36.837856 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.month_on_month_change"
[0m04:02:36.838862 [debug] [Thread-1 (]: On model.snowflake_instabee.month_on_month_change: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.month_on_month_change"} */
use warehouse pc_dbt_wh_large
[0m04:02:36.908770 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.070 seconds
[0m04:02:36.912321 [debug] [Thread-1 (]: Writing runtime sql for node "model.snowflake_instabee.month_on_month_change"
[0m04:02:36.915323 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.month_on_month_change"
[0m04:02:36.916554 [debug] [Thread-1 (]: On model.snowflake_instabee.month_on_month_change: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.month_on_month_change"} */
create or replace transient table PC_DBT_DB.DBT_.month_on_month_change
         as
        (SELECT
    DATE_TRUNC('month', order_date) AS order_month,
    SUM(sales) AS total_sales,
    LAG(SUM(sales)) OVER (ORDER BY DATE_TRUNC('month', order_date)) AS previous_month_sales,
    SUM(sales) - LAG(SUM(sales)) OVER (ORDER BY DATE_TRUNC('month', order_date)) AS change_in_sales
FROM PC_DBT_DB.DBT_.fact_sales
WHERE EXTRACT(YEAR FROM order_date) = 2019
GROUP BY 1
        );
[0m04:02:37.859886 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.943 seconds
[0m04:02:37.867074 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.month_on_month_change"
[0m04:02:37.868089 [debug] [Thread-1 (]: On model.snowflake_instabee.month_on_month_change: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.month_on_month_change"} */
use warehouse COMPUTE_WH
[0m04:02:37.954089 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.084 seconds
[0m04:02:37.957115 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4003a300-1187-460a-a374-77bfd3f71cb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2B0D49D30>]}
[0m04:02:37.959712 [info ] [Thread-1 (]: 11 of 15 OK created sql table model DBT_.month_on_month_change ................. [[32mSUCCESS 1[0m in 1.21s]
[0m04:02:37.961734 [debug] [Thread-1 (]: Finished running node model.snowflake_instabee.month_on_month_change
[0m04:02:37.962746 [debug] [Thread-1 (]: Began running node model.snowflake_instabee.monthly_returns_per_category
[0m04:02:37.963754 [info ] [Thread-1 (]: 12 of 15 START sql table model DBT_.monthly_returns_per_category ............... [RUN]
[0m04:02:37.966731 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.snowflake_instabee.month_on_month_change, now model.snowflake_instabee.monthly_returns_per_category)
[0m04:02:37.967730 [debug] [Thread-1 (]: Began compiling node model.snowflake_instabee.monthly_returns_per_category
[0m04:02:37.977556 [debug] [Thread-1 (]: Writing injected SQL for node "model.snowflake_instabee.monthly_returns_per_category"
[0m04:02:38.053738 [debug] [Thread-1 (]: Began executing node model.snowflake_instabee.monthly_returns_per_category
[0m04:02:38.060925 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.monthly_returns_per_category"
[0m04:02:38.062434 [debug] [Thread-1 (]: On model.snowflake_instabee.monthly_returns_per_category: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.monthly_returns_per_category"} */
select current_warehouse() as warehouse
[0m04:02:38.134232 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.071 seconds
[0m04:02:38.137879 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.monthly_returns_per_category"
[0m04:02:38.139145 [debug] [Thread-1 (]: On model.snowflake_instabee.monthly_returns_per_category: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.monthly_returns_per_category"} */
use warehouse pc_dbt_wh_large
[0m04:02:38.217692 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.076 seconds
[0m04:02:38.224282 [debug] [Thread-1 (]: Writing runtime sql for node "model.snowflake_instabee.monthly_returns_per_category"
[0m04:02:38.230127 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.monthly_returns_per_category"
[0m04:02:38.231132 [debug] [Thread-1 (]: On model.snowflake_instabee.monthly_returns_per_category: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.monthly_returns_per_category"} */
create or replace transient table PC_DBT_DB.DBT_.monthly_returns_per_category
         as
        (select * from (SELECT
    DATE_TRUNC('month', s.order_date) AS order_month,
    p.product_category,P.SUB_CATEGORY,
    COUNT(CASE WHEN s.order_id IS NOT NULL and s.returned = 'Yes' THEN 1 END) AS returned_orders
FROM PC_DBT_DB.DBT_.fact_sales s
JOIN PC_DBT_DB.DBT_.dim_products p
    ON s.product_id = p.product_id
WHERE EXTRACT(YEAR FROM s.order_date) = 2019
GROUP BY 1, 2,3
ORDER BY 4 DESC)
WHERE returned_orders <>0
        );
[0m04:02:39.213611 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.981 seconds
[0m04:02:39.218289 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.monthly_returns_per_category"
[0m04:02:39.218289 [debug] [Thread-1 (]: On model.snowflake_instabee.monthly_returns_per_category: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.monthly_returns_per_category"} */
use warehouse COMPUTE_WH
[0m04:02:39.291720 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.072 seconds
[0m04:02:39.294031 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4003a300-1187-460a-a374-77bfd3f71cb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2B0F72510>]}
[0m04:02:39.295033 [info ] [Thread-1 (]: 12 of 15 OK created sql table model DBT_.monthly_returns_per_category .......... [[32mSUCCESS 1[0m in 1.33s]
[0m04:02:39.296356 [debug] [Thread-1 (]: Finished running node model.snowflake_instabee.monthly_returns_per_category
[0m04:02:39.296356 [debug] [Thread-1 (]: Began running node model.snowflake_instabee.sales_growth_per_category
[0m04:02:39.297932 [info ] [Thread-1 (]: 13 of 15 START sql table model DBT_.sales_growth_per_category .................. [RUN]
[0m04:02:39.299061 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.snowflake_instabee.monthly_returns_per_category, now model.snowflake_instabee.sales_growth_per_category)
[0m04:02:39.300134 [debug] [Thread-1 (]: Began compiling node model.snowflake_instabee.sales_growth_per_category
[0m04:02:39.304875 [debug] [Thread-1 (]: Writing injected SQL for node "model.snowflake_instabee.sales_growth_per_category"
[0m04:02:39.305878 [debug] [Thread-1 (]: Began executing node model.snowflake_instabee.sales_growth_per_category
[0m04:02:39.309684 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.sales_growth_per_category"
[0m04:02:39.309684 [debug] [Thread-1 (]: On model.snowflake_instabee.sales_growth_per_category: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.sales_growth_per_category"} */
select current_warehouse() as warehouse
[0m04:02:39.376538 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.066 seconds
[0m04:02:39.379538 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.sales_growth_per_category"
[0m04:02:39.379538 [debug] [Thread-1 (]: On model.snowflake_instabee.sales_growth_per_category: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.sales_growth_per_category"} */
use warehouse pc_dbt_wh_large
[0m04:02:39.455658 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.075 seconds
[0m04:02:39.459166 [debug] [Thread-1 (]: Writing runtime sql for node "model.snowflake_instabee.sales_growth_per_category"
[0m04:02:39.462196 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.sales_growth_per_category"
[0m04:02:39.463197 [debug] [Thread-1 (]: On model.snowflake_instabee.sales_growth_per_category: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.sales_growth_per_category"} */
create or replace transient table PC_DBT_DB.DBT_.sales_growth_per_category
         as
        (SELECT
    DATE_TRUNC('month', s.order_date) AS order_month,
    p.product_category,
    SUM(s.sales) AS monthly_sales,
    LAG(SUM(s.sales)) OVER (PARTITION BY p.product_category ORDER BY DATE_TRUNC('month', s.order_date)) AS previous_month_sales,
    (SUM(s.sales) - LAG(SUM(s.sales)) OVER (PARTITION BY p.product_category ORDER BY DATE_TRUNC('month', s.order_date))) /
        NULLIF(LAG(SUM(s.sales)) OVER (PARTITION BY p.product_category ORDER BY DATE_TRUNC('month', s.order_date)), 0) AS growth_rate
FROM PC_DBT_DB.DBT_.fact_sales s
JOIN PC_DBT_DB.DBT_.dim_products p
    ON s.product_id = p.product_id
WHERE EXTRACT(YEAR FROM order_date) = 2019
GROUP BY 1, 2
        );
[0m04:02:40.717774 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.252 seconds
[0m04:02:40.742423 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.sales_growth_per_category"
[0m04:02:40.746647 [debug] [Thread-1 (]: On model.snowflake_instabee.sales_growth_per_category: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.sales_growth_per_category"} */
use warehouse COMPUTE_WH
[0m04:02:40.844910 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.094 seconds
[0m04:02:40.855615 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4003a300-1187-460a-a374-77bfd3f71cb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2B0F4EC60>]}
[0m04:02:40.861699 [info ] [Thread-1 (]: 13 of 15 OK created sql table model DBT_.sales_growth_per_category ............. [[32mSUCCESS 1[0m in 1.56s]
[0m04:02:40.866594 [debug] [Thread-1 (]: Finished running node model.snowflake_instabee.sales_growth_per_category
[0m04:02:40.872745 [debug] [Thread-1 (]: Began running node model.snowflake_instabee.sales_overtime
[0m04:02:40.878164 [info ] [Thread-1 (]: 14 of 15 START sql table model DBT_.sales_overtime ............................. [RUN]
[0m04:02:40.883698 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.snowflake_instabee.sales_growth_per_category, now model.snowflake_instabee.sales_overtime)
[0m04:02:40.888798 [debug] [Thread-1 (]: Began compiling node model.snowflake_instabee.sales_overtime
[0m04:02:40.919887 [debug] [Thread-1 (]: Writing injected SQL for node "model.snowflake_instabee.sales_overtime"
[0m04:02:40.926015 [debug] [Thread-1 (]: Began executing node model.snowflake_instabee.sales_overtime
[0m04:02:40.947488 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.sales_overtime"
[0m04:02:40.950898 [debug] [Thread-1 (]: On model.snowflake_instabee.sales_overtime: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.sales_overtime"} */
select current_warehouse() as warehouse
[0m04:02:41.055098 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.099 seconds
[0m04:02:41.060099 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.sales_overtime"
[0m04:02:41.061099 [debug] [Thread-1 (]: On model.snowflake_instabee.sales_overtime: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.sales_overtime"} */
use warehouse pc_dbt_wh_large
[0m04:02:41.147227 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.084 seconds
[0m04:02:41.154515 [debug] [Thread-1 (]: Writing runtime sql for node "model.snowflake_instabee.sales_overtime"
[0m04:02:41.162512 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.sales_overtime"
[0m04:02:41.164064 [debug] [Thread-1 (]: On model.snowflake_instabee.sales_overtime: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.sales_overtime"} */
create or replace transient table PC_DBT_DB.DBT_.sales_overtime
         as
        (WITH monthly_sales AS (
  SELECT
      DATE_TRUNC('month', order_date) AS order_month,
      p.product_category,
      SUM(s.sales) AS category_sales
  FROM PC_DBT_DB.DBT_.fact_sales s
  JOIN PC_DBT_DB.DBT_.dim_products p
      ON s.product_id = p.product_id
  WHERE EXTRACT(YEAR FROM order_date) = 2019
  GROUP BY 1, 2
),

monthly_totals AS (
  SELECT
      order_month,
      SUM(category_sales) AS total_monthly_sales
  FROM monthly_sales
  GROUP BY 1
)

SELECT
    ms.order_month,
    ms.product_category,
    ms.category_sales,
    ROUND(ms.category_sales * 100.0 / mt.total_monthly_sales, 2) AS sales_percentage
FROM monthly_sales ms
JOIN monthly_totals mt
    ON ms.order_month = mt.order_month
ORDER BY 1, 4 DESC
        );
[0m04:02:42.045813 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.880 seconds
[0m04:02:42.052073 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.sales_overtime"
[0m04:02:42.052073 [debug] [Thread-1 (]: On model.snowflake_instabee.sales_overtime: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.sales_overtime"} */
use warehouse COMPUTE_WH
[0m04:02:42.125209 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.072 seconds
[0m04:02:42.127212 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4003a300-1187-460a-a374-77bfd3f71cb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2B0F52120>]}
[0m04:02:42.128213 [info ] [Thread-1 (]: 14 of 15 OK created sql table model DBT_.sales_overtime ........................ [[32mSUCCESS 1[0m in 1.24s]
[0m04:02:42.129216 [debug] [Thread-1 (]: Finished running node model.snowflake_instabee.sales_overtime
[0m04:02:42.129976 [debug] [Thread-1 (]: Began running node model.snowflake_instabee.top_selling_states_and_regions
[0m04:02:42.131106 [info ] [Thread-1 (]: 15 of 15 START sql table model DBT_.top_selling_states_and_regions ............. [RUN]
[0m04:02:42.132106 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.snowflake_instabee.sales_overtime, now model.snowflake_instabee.top_selling_states_and_regions)
[0m04:02:42.133641 [debug] [Thread-1 (]: Began compiling node model.snowflake_instabee.top_selling_states_and_regions
[0m04:02:42.139836 [debug] [Thread-1 (]: Writing injected SQL for node "model.snowflake_instabee.top_selling_states_and_regions"
[0m04:02:42.214224 [debug] [Thread-1 (]: Began executing node model.snowflake_instabee.top_selling_states_and_regions
[0m04:02:42.218065 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.top_selling_states_and_regions"
[0m04:02:42.219200 [debug] [Thread-1 (]: On model.snowflake_instabee.top_selling_states_and_regions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.top_selling_states_and_regions"} */
select current_warehouse() as warehouse
[0m04:02:42.287616 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.068 seconds
[0m04:02:42.290629 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.top_selling_states_and_regions"
[0m04:02:42.290629 [debug] [Thread-1 (]: On model.snowflake_instabee.top_selling_states_and_regions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.top_selling_states_and_regions"} */
use warehouse pc_dbt_wh_large
[0m04:02:42.365039 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.073 seconds
[0m04:02:42.368241 [debug] [Thread-1 (]: Writing runtime sql for node "model.snowflake_instabee.top_selling_states_and_regions"
[0m04:02:42.372859 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.top_selling_states_and_regions"
[0m04:02:42.373861 [debug] [Thread-1 (]: On model.snowflake_instabee.top_selling_states_and_regions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.top_selling_states_and_regions"} */
create or replace transient table PC_DBT_DB.DBT_.top_selling_states_and_regions
         as
        (WITH monthly_region_sales AS(SELECT
DATE_TRUNC('month', order_date) AS order_month,
    s.region,
    s.state,
    d.regional_manager,
    SUM(s.sales) AS region_sales
FROM PC_DBT_DB.DBT_.fact_sales s
LEFT JOIN PC_DBT_DB.DBT_.dim_regions d
    ON s.region = d.region AND s.state = d.state
WHERE EXTRACT(YEAR FROM s.order_date) = 2019
GROUP BY 1, 2, 3,4
ORDER BY region_sales DESC),

monthly_totals AS (
  SELECT
      order_month,
      SUM(region_sales) AS total_monthly_sales
  FROM monthly_region_sales
  GROUP BY 1
),

ranked_regions AS (
  SELECT
      mrs.*,
      mt.total_monthly_sales,
      ROUND(mrs.region_sales * 100.0 / mt.total_monthly_sales, 2) AS sales_percentage,
      ROW_NUMBER() OVER (PARTITION BY mrs.order_month ORDER BY mrs.region_sales DESC) AS region_rank
  FROM monthly_region_sales mrs
  JOIN monthly_totals mt
      ON mrs.order_month = mt.order_month
  WHERE mrs.order_month IS NOT NULL
)

SELECT
    order_month,
    region AS top_region,
    state AS top_state,
    regional_manager,
    region_sales,
    sales_percentage
FROM ranked_regions
WHERE region_rank = 1
ORDER BY order_month DESC
        );
[0m04:02:43.317990 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.944 seconds
[0m04:02:43.320995 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.top_selling_states_and_regions"
[0m04:02:43.322006 [debug] [Thread-1 (]: On model.snowflake_instabee.top_selling_states_and_regions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.top_selling_states_and_regions"} */
use warehouse COMPUTE_WH
[0m04:02:43.402721 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.080 seconds
[0m04:02:43.404721 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4003a300-1187-460a-a374-77bfd3f71cb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2B0F61FA0>]}
[0m04:02:43.405721 [info ] [Thread-1 (]: 15 of 15 OK created sql table model DBT_.top_selling_states_and_regions ........ [[32mSUCCESS 1[0m in 1.27s]
[0m04:02:43.407722 [debug] [Thread-1 (]: Finished running node model.snowflake_instabee.top_selling_states_and_regions
[0m04:02:43.408775 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:02:43.409789 [debug] [MainThread]: Connection 'list_PC_DBT_DB' was left open.
[0m04:02:43.410792 [debug] [MainThread]: On list_PC_DBT_DB: Close
[0m04:02:43.550703 [debug] [MainThread]: Connection 'list_PC_DBT_DB_DBT_' was left open.
[0m04:02:43.550703 [debug] [MainThread]: On list_PC_DBT_DB_DBT_: Close
[0m04:02:43.659442 [debug] [MainThread]: Connection 'model.snowflake_instabee.top_selling_states_and_regions' was left open.
[0m04:02:43.660444 [debug] [MainThread]: On model.snowflake_instabee.top_selling_states_and_regions: Close
[0m04:02:43.771483 [info ] [MainThread]: 
[0m04:02:43.772492 [info ] [MainThread]: Finished running 10 table models, 5 view models in 0 hours 0 minutes and 18.52 seconds (18.52s).
[0m04:02:43.777806 [debug] [MainThread]: Command end result
[0m04:02:43.834032 [debug] [MainThread]: Wrote artifact WritableManifest to E:\desk\onedrive\Desktop\snowflake_instabee\target\manifest.json
[0m04:02:43.837501 [debug] [MainThread]: Wrote artifact SemanticManifest to E:\desk\onedrive\Desktop\snowflake_instabee\target\semantic_manifest.json
[0m04:02:43.848093 [debug] [MainThread]: Wrote artifact RunExecutionResult to E:\desk\onedrive\Desktop\snowflake_instabee\target\run_results.json
[0m04:02:43.848093 [info ] [MainThread]: 
[0m04:02:43.849671 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m04:02:43.850663 [info ] [MainThread]: 
[0m04:02:43.850663 [error] [MainThread]:   Database Error in model generate_surrogate_key (models\macros\generate_surrogate_key.sql)
  001003 (42000): SQL compilation error:
  syntax error line 5 at position 2 unexpected ')'.
  compiled code at target\run\snowflake_instabee\models\macros\generate_surrogate_key.sql
[0m04:02:43.850663 [info ] [MainThread]: 
[0m04:02:43.851720 [info ] [MainThread]: Done. PASS=14 WARN=0 ERROR=1 SKIP=0 TOTAL=15
[0m04:02:43.852772 [debug] [MainThread]: Command `dbt run` failed at 04:02:43.852772 after 24.51 seconds
[0m04:02:43.853789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2B0811C70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2A71DE270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2A71DE720>]}
[0m04:02:43.853789 [debug] [MainThread]: Flushing usage events
[0m04:02:44.408188 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m04:06:36.491038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028A7839C830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028A7AF96AE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028A7A57BF20>]}


============================== 04:06:36.497190 | 1a6632fd-a826-483f-8159-f88f5016fb8d ==============================
[0m04:06:36.497190 [info ] [MainThread]: Running with dbt=1.9.4
[0m04:06:36.498207 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'E:\\desk\\onedrive\\Desktop\\snowflake_instabee\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\Venee\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m04:06:36.705783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1a6632fd-a826-483f-8159-f88f5016fb8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028A7A57BF20>]}
[0m04:06:36.742590 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
        The default package install path has changed from `dbt_modules` to
`dbt_packages`.         Please update `clean-targets` in `dbt_project.yml` and
check `.gitignore` as well.         Or, set `packages-install-path: dbt_modules`
if you'd like to keep the current value.
[0m04:06:36.743374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '1a6632fd-a826-483f-8159-f88f5016fb8d', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028A7C26B380>]}
[0m04:06:36.762974 [debug] [MainThread]: Command `dbt clean` succeeded at 04:06:36.762974 after 0.52 seconds
[0m04:06:36.764074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028A7A9773B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028A7C1107A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028A7AFF8050>]}
[0m04:06:36.765073 [debug] [MainThread]: Flushing usage events
[0m04:06:37.232577 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m04:06:47.927631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016CF782D7F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016CFC613710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016CFC610860>]}


============================== 04:06:47.934715 | ab02621e-529c-4207-b6b5-322527482baa ==============================
[0m04:06:47.934715 [info ] [MainThread]: Running with dbt=1.9.4
[0m04:06:47.935897 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'E:\\desk\\onedrive\\Desktop\\snowflake_instabee\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\Venee\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m04:06:49.218518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ab02621e-529c-4207-b6b5-322527482baa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016CFFAC6090>]}
[0m04:06:49.312863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ab02621e-529c-4207-b6b5-322527482baa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016CFF900860>]}
[0m04:06:49.314906 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m04:06:50.247034 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m04:06:50.249380 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m04:06:50.250282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'ab02621e-529c-4207-b6b5-322527482baa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016CFFDA3DA0>]}
[0m04:06:53.136737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ab02621e-529c-4207-b6b5-322527482baa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D013830E0>]}
[0m04:06:53.276642 [debug] [MainThread]: Wrote artifact WritableManifest to E:\desk\onedrive\Desktop\snowflake_instabee\target\manifest.json
[0m04:06:53.283569 [debug] [MainThread]: Wrote artifact SemanticManifest to E:\desk\onedrive\Desktop\snowflake_instabee\target\semantic_manifest.json
[0m04:06:53.322358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ab02621e-529c-4207-b6b5-322527482baa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D011F8DA0>]}
[0m04:06:53.323362 [info ] [MainThread]: Found 15 models, 17 data tests, 3 sources, 590 macros
[0m04:06:53.323362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ab02621e-529c-4207-b6b5-322527482baa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D014FEB40>]}
[0m04:06:53.327753 [info ] [MainThread]: 
[0m04:06:53.328759 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:06:53.328759 [info ] [MainThread]: 
[0m04:06:53.329765 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m04:06:53.341667 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PC_DBT_DB'
[0m04:06:53.473816 [debug] [ThreadPool]: Using snowflake connection "list_PC_DBT_DB"
[0m04:06:53.474829 [debug] [ThreadPool]: On list_PC_DBT_DB: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "connection_name": "list_PC_DBT_DB"} */
show terse schemas in database PC_DBT_DB
    limit 10000
[0m04:06:53.474829 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:06:54.078375 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.604 seconds
[0m04:06:54.087693 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PC_DBT_DB_DBT_'
[0m04:06:54.105669 [debug] [ThreadPool]: Using snowflake connection "list_PC_DBT_DB_DBT_"
[0m04:06:54.105669 [debug] [ThreadPool]: On list_PC_DBT_DB_DBT_: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "connection_name": "list_PC_DBT_DB_DBT_"} */
show objects in PC_DBT_DB.DBT_ limit 10000;
[0m04:06:54.106674 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:06:54.631327 [debug] [ThreadPool]: SQL status: SUCCESS 15 in 0.524 seconds
[0m04:06:54.641472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ab02621e-529c-4207-b6b5-322527482baa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016CF7A670E0>]}
[0m04:06:54.647621 [debug] [Thread-1 (]: Began running node model.snowflake_instabee.generate_surrogate_key
[0m04:06:54.649274 [info ] [Thread-1 (]: 1 of 15 START sql view model DBT_.generate_surrogate_key ....................... [RUN]
[0m04:06:54.650383 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.snowflake_instabee.generate_surrogate_key'
[0m04:06:54.651392 [debug] [Thread-1 (]: Began compiling node model.snowflake_instabee.generate_surrogate_key
[0m04:06:54.665881 [debug] [Thread-1 (]: Writing injected SQL for node "model.snowflake_instabee.generate_surrogate_key"
[0m04:06:54.665881 [debug] [Thread-1 (]: Began executing node model.snowflake_instabee.generate_surrogate_key
[0m04:06:54.723598 [debug] [Thread-1 (]: Writing runtime sql for node "model.snowflake_instabee.generate_surrogate_key"
[0m04:06:54.727469 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.generate_surrogate_key"
[0m04:06:54.727469 [debug] [Thread-1 (]: On model.snowflake_instabee.generate_surrogate_key: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.generate_surrogate_key"} */
create or replace   view PC_DBT_DB.DBT_.generate_surrogate_key
  
   as (
    
  );
[0m04:06:54.728471 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m04:06:55.228111 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bbd3da-0001-b46b-0002-47d20007b0fa
[0m04:06:55.229113 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 5 at position 2 unexpected ')'.
[0m04:06:55.237410 [debug] [Thread-1 (]: Database Error in model generate_surrogate_key (models\macros\generate_surrogate_key.sql)
  001003 (42000): SQL compilation error:
  syntax error line 5 at position 2 unexpected ')'.
  compiled code at target\run\snowflake_instabee\models\macros\generate_surrogate_key.sql
[0m04:06:55.241455 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ab02621e-529c-4207-b6b5-322527482baa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016CFA9BEB70>]}
[0m04:06:55.242464 [error] [Thread-1 (]: 1 of 15 ERROR creating sql view model DBT_.generate_surrogate_key .............. [[31mERROR[0m in 0.59s]
[0m04:06:55.243474 [debug] [Thread-1 (]: Finished running node model.snowflake_instabee.generate_surrogate_key
[0m04:06:55.244482 [debug] [Thread-1 (]: Began running node model.snowflake_instabee.my_first_dbt_model
[0m04:06:55.245488 [debug] [Thread-4 (]: Marking all children of 'model.snowflake_instabee.generate_surrogate_key' to be skipped because of status 'error'.  Reason: Database Error in model generate_surrogate_key (models\macros\generate_surrogate_key.sql)
  001003 (42000): SQL compilation error:
  syntax error line 5 at position 2 unexpected ')'.
  compiled code at target\run\snowflake_instabee\models\macros\generate_surrogate_key.sql.
[0m04:06:55.245488 [info ] [Thread-1 (]: 2 of 15 START sql table model DBT_.my_first_dbt_model .......................... [RUN]
[0m04:06:55.247971 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.snowflake_instabee.generate_surrogate_key, now model.snowflake_instabee.my_first_dbt_model)
[0m04:06:55.250112 [debug] [Thread-1 (]: Began compiling node model.snowflake_instabee.my_first_dbt_model
[0m04:06:55.256364 [debug] [Thread-1 (]: Writing injected SQL for node "model.snowflake_instabee.my_first_dbt_model"
[0m04:06:55.259624 [debug] [Thread-1 (]: Began executing node model.snowflake_instabee.my_first_dbt_model
[0m04:06:55.301091 [debug] [Thread-1 (]: Writing runtime sql for node "model.snowflake_instabee.my_first_dbt_model"
[0m04:06:55.303602 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.my_first_dbt_model"
[0m04:06:55.304605 [debug] [Thread-1 (]: On model.snowflake_instabee.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.my_first_dbt_model"} */
create or replace transient table PC_DBT_DB.DBT_.my_first_dbt_model
         as
        (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (
    select 1 as id, 'Example record 1' as description
    union all
    select 2 as id, 'Example record 2' as description
)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
        );
[0m04:06:56.033507 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.727 seconds
[0m04:06:56.124802 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ab02621e-529c-4207-b6b5-322527482baa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016CF79E4D10>]}
[0m04:06:56.126807 [info ] [Thread-1 (]: 2 of 15 OK created sql table model DBT_.my_first_dbt_model ..................... [[32mSUCCESS 1[0m in 0.88s]
[0m04:06:56.128946 [debug] [Thread-1 (]: Finished running node model.snowflake_instabee.my_first_dbt_model
[0m04:06:56.129951 [debug] [Thread-1 (]: Began running node model.snowflake_instabee.stg_instabee_orders
[0m04:06:56.132574 [info ] [Thread-1 (]: 3 of 15 START sql view model DBT_.stg_instabee_orders .......................... [RUN]
[0m04:06:56.135880 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.snowflake_instabee.my_first_dbt_model, now model.snowflake_instabee.stg_instabee_orders)
[0m04:06:56.137230 [debug] [Thread-1 (]: Began compiling node model.snowflake_instabee.stg_instabee_orders
[0m04:06:56.151901 [debug] [Thread-1 (]: Writing injected SQL for node "model.snowflake_instabee.stg_instabee_orders"
[0m04:06:56.155949 [debug] [Thread-1 (]: Began executing node model.snowflake_instabee.stg_instabee_orders
[0m04:06:56.163048 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.stg_instabee_orders"
[0m04:06:56.164305 [debug] [Thread-1 (]: On model.snowflake_instabee.stg_instabee_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.stg_instabee_orders"} */
select current_warehouse() as warehouse
[0m04:06:56.249043 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.083 seconds
[0m04:06:56.297586 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.stg_instabee_orders"
[0m04:06:56.298807 [debug] [Thread-1 (]: On model.snowflake_instabee.stg_instabee_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.stg_instabee_orders"} */
use warehouse pc_dbt_wh
[0m04:06:56.388370 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.089 seconds
[0m04:06:56.395373 [debug] [Thread-1 (]: Writing runtime sql for node "model.snowflake_instabee.stg_instabee_orders"
[0m04:06:56.401781 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.stg_instabee_orders"
[0m04:06:56.403780 [debug] [Thread-1 (]: On model.snowflake_instabee.stg_instabee_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.stg_instabee_orders"} */
create or replace   view PC_DBT_DB.DBT_.stg_instabee_orders
  
   as (
    with source as (

    select * from INSTABEE.PUBLIC.ORDERS

),

renamed as (

    select 
md5(cast(coalesce(cast(ORDER_ID as TEXT), '') || '-' || coalesce(cast(PRODUCT_ID as TEXT), '') || '-' || coalesce(cast(ROW_ID as TEXT), '') as TEXT)) as ORDER_LINE_ID,
ROW_ID,
ORDER_ID,	
ORDERDATE AS ORDER_DATE,
SHIPDATE AS SHIP_DATE,	
SHIP_MODE,	
CUSTOMER_ID,	
CUSTOMER_NAME,	
SEGMENT,
COUNTRY,
CITY,
STATE,	
POSTAL_CODE,	
REGION,	
PRODUCT_ID,	
CATEGORY as PRODUCT_CATEGORY,	
SUB_CATEGORY,	
PRODUCT_NAME,	
SALES,	
QUANTITY,	
DISCOUNT,	
PROFIT


    from source

)

select * from renamed
  );
[0m04:06:56.729448 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.324 seconds
[0m04:06:56.734703 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.stg_instabee_orders"
[0m04:06:56.735083 [debug] [Thread-1 (]: On model.snowflake_instabee.stg_instabee_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.stg_instabee_orders"} */
use warehouse COMPUTE_WH
[0m04:06:56.822611 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.086 seconds
[0m04:06:56.825613 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ab02621e-529c-4207-b6b5-322527482baa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D018EFAA0>]}
[0m04:06:56.827616 [info ] [Thread-1 (]: 3 of 15 OK created sql view model DBT_.stg_instabee_orders ..................... [[32mSUCCESS 1[0m in 0.69s]
[0m04:06:56.828613 [debug] [Thread-1 (]: Finished running node model.snowflake_instabee.stg_instabee_orders
[0m04:06:56.830595 [debug] [Thread-1 (]: Began running node model.snowflake_instabee.stg_instabee_people
[0m04:06:56.831529 [info ] [Thread-1 (]: 4 of 15 START sql view model DBT_.stg_instabee_people .......................... [RUN]
[0m04:06:56.833580 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.snowflake_instabee.stg_instabee_orders, now model.snowflake_instabee.stg_instabee_people)
[0m04:06:56.834582 [debug] [Thread-1 (]: Began compiling node model.snowflake_instabee.stg_instabee_people
[0m04:06:56.841236 [debug] [Thread-1 (]: Writing injected SQL for node "model.snowflake_instabee.stg_instabee_people"
[0m04:06:56.843238 [debug] [Thread-1 (]: Began executing node model.snowflake_instabee.stg_instabee_people
[0m04:06:56.849237 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.stg_instabee_people"
[0m04:06:56.850238 [debug] [Thread-1 (]: On model.snowflake_instabee.stg_instabee_people: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.stg_instabee_people"} */
select current_warehouse() as warehouse
[0m04:06:56.933715 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.081 seconds
[0m04:06:56.937447 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.stg_instabee_people"
[0m04:06:56.938445 [debug] [Thread-1 (]: On model.snowflake_instabee.stg_instabee_people: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.stg_instabee_people"} */
use warehouse pc_dbt_wh
[0m04:06:57.023774 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.084 seconds
[0m04:06:57.027780 [debug] [Thread-1 (]: Writing runtime sql for node "model.snowflake_instabee.stg_instabee_people"
[0m04:06:57.030659 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.stg_instabee_people"
[0m04:06:57.031656 [debug] [Thread-1 (]: On model.snowflake_instabee.stg_instabee_people: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.stg_instabee_people"} */
create or replace   view PC_DBT_DB.DBT_.stg_instabee_people
  
   as (
    with source as (

    select * from INSTABEE.PUBLIC.PEOPLE

)

select * from source
  );
[0m04:06:57.240218 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.208 seconds
[0m04:06:57.244223 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.stg_instabee_people"
[0m04:06:57.244223 [debug] [Thread-1 (]: On model.snowflake_instabee.stg_instabee_people: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.stg_instabee_people"} */
use warehouse COMPUTE_WH
[0m04:06:57.333688 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.089 seconds
[0m04:06:57.336311 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ab02621e-529c-4207-b6b5-322527482baa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D01AA2E40>]}
[0m04:06:57.337566 [info ] [Thread-1 (]: 4 of 15 OK created sql view model DBT_.stg_instabee_people ..................... [[32mSUCCESS 1[0m in 0.50s]
[0m04:06:57.339728 [debug] [Thread-1 (]: Finished running node model.snowflake_instabee.stg_instabee_people
[0m04:06:57.339728 [debug] [Thread-1 (]: Began running node model.snowflake_instabee.stg_instabee_returns
[0m04:06:57.340739 [info ] [Thread-1 (]: 5 of 15 START sql view model DBT_.stg_instabee_returns ......................... [RUN]
[0m04:06:57.341842 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.snowflake_instabee.stg_instabee_people, now model.snowflake_instabee.stg_instabee_returns)
[0m04:06:57.341842 [debug] [Thread-1 (]: Began compiling node model.snowflake_instabee.stg_instabee_returns
[0m04:06:57.345850 [debug] [Thread-1 (]: Writing injected SQL for node "model.snowflake_instabee.stg_instabee_returns"
[0m04:06:57.349173 [debug] [Thread-1 (]: Began executing node model.snowflake_instabee.stg_instabee_returns
[0m04:06:57.354029 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.stg_instabee_returns"
[0m04:06:57.355040 [debug] [Thread-1 (]: On model.snowflake_instabee.stg_instabee_returns: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.stg_instabee_returns"} */
select current_warehouse() as warehouse
[0m04:06:57.430374 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.075 seconds
[0m04:06:57.433940 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.stg_instabee_returns"
[0m04:06:57.434484 [debug] [Thread-1 (]: On model.snowflake_instabee.stg_instabee_returns: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.stg_instabee_returns"} */
use warehouse pc_dbt_wh
[0m04:06:57.512830 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.077 seconds
[0m04:06:57.517062 [debug] [Thread-1 (]: Writing runtime sql for node "model.snowflake_instabee.stg_instabee_returns"
[0m04:06:57.519353 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.stg_instabee_returns"
[0m04:06:57.520367 [debug] [Thread-1 (]: On model.snowflake_instabee.stg_instabee_returns: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.stg_instabee_returns"} */
create or replace   view PC_DBT_DB.DBT_.stg_instabee_returns
  
   as (
    WITH source AS (
    SELECT * FROM INSTABEE.PUBLIC.RETURNS
),

deduplicated AS (
    SELECT order_id, MAX(returned) AS returned
    FROM source
    GROUP BY order_id
)

SELECT * FROM deduplicated
  );
[0m04:06:57.752696 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.231 seconds
[0m04:06:57.755696 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.stg_instabee_returns"
[0m04:06:57.756696 [debug] [Thread-1 (]: On model.snowflake_instabee.stg_instabee_returns: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.stg_instabee_returns"} */
use warehouse COMPUTE_WH
[0m04:06:57.831416 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.075 seconds
[0m04:06:57.834881 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ab02621e-529c-4207-b6b5-322527482baa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D01AE3230>]}
[0m04:06:57.835891 [info ] [Thread-1 (]: 5 of 15 OK created sql view model DBT_.stg_instabee_returns .................... [[32mSUCCESS 1[0m in 0.49s]
[0m04:06:57.836912 [debug] [Thread-1 (]: Finished running node model.snowflake_instabee.stg_instabee_returns
[0m04:06:57.837919 [debug] [Thread-1 (]: Began running node model.snowflake_instabee.my_second_dbt_model
[0m04:06:57.837919 [info ] [Thread-1 (]: 6 of 15 START sql view model DBT_.my_second_dbt_model .......................... [RUN]
[0m04:06:57.838926 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.snowflake_instabee.stg_instabee_returns, now model.snowflake_instabee.my_second_dbt_model)
[0m04:06:57.839934 [debug] [Thread-1 (]: Began compiling node model.snowflake_instabee.my_second_dbt_model
[0m04:06:57.845014 [debug] [Thread-1 (]: Writing injected SQL for node "model.snowflake_instabee.my_second_dbt_model"
[0m04:06:57.846816 [debug] [Thread-1 (]: Began executing node model.snowflake_instabee.my_second_dbt_model
[0m04:06:57.855182 [debug] [Thread-1 (]: Writing runtime sql for node "model.snowflake_instabee.my_second_dbt_model"
[0m04:06:57.857222 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.my_second_dbt_model"
[0m04:06:57.857222 [debug] [Thread-1 (]: On model.snowflake_instabee.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.my_second_dbt_model"} */
create or replace   view PC_DBT_DB.DBT_.my_second_dbt_model
  
   as (
    -- Use the `ref` function to select from other models

select *
from PC_DBT_DB.DBT_.my_first_dbt_model
where id = 1
  );
[0m04:06:58.009295 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.151 seconds
[0m04:06:58.013410 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ab02621e-529c-4207-b6b5-322527482baa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D0195B6B0>]}
[0m04:06:58.014584 [info ] [Thread-1 (]: 6 of 15 OK created sql view model DBT_.my_second_dbt_model ..................... [[32mSUCCESS 1[0m in 0.17s]
[0m04:06:58.016611 [debug] [Thread-1 (]: Finished running node model.snowflake_instabee.my_second_dbt_model
[0m04:06:58.016990 [debug] [Thread-1 (]: Began running node model.snowflake_instabee.dim_customers
[0m04:06:58.018063 [info ] [Thread-1 (]: 7 of 15 START sql table model DBT_.dim_customers ............................... [RUN]
[0m04:06:58.019132 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.snowflake_instabee.my_second_dbt_model, now model.snowflake_instabee.dim_customers)
[0m04:06:58.019132 [debug] [Thread-1 (]: Began compiling node model.snowflake_instabee.dim_customers
[0m04:06:58.023140 [debug] [Thread-1 (]: Writing injected SQL for node "model.snowflake_instabee.dim_customers"
[0m04:06:58.024142 [debug] [Thread-1 (]: Began executing node model.snowflake_instabee.dim_customers
[0m04:06:58.028521 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.dim_customers"
[0m04:06:58.028521 [debug] [Thread-1 (]: On model.snowflake_instabee.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.dim_customers"} */
select current_warehouse() as warehouse
[0m04:06:58.103009 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.074 seconds
[0m04:06:58.105033 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.dim_customers"
[0m04:06:58.106037 [debug] [Thread-1 (]: On model.snowflake_instabee.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.dim_customers"} */
use warehouse pc_dbt_wh_large
[0m04:06:58.183625 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.077 seconds
[0m04:06:58.186722 [debug] [Thread-1 (]: Writing runtime sql for node "model.snowflake_instabee.dim_customers"
[0m04:06:58.189852 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.dim_customers"
[0m04:06:58.191035 [debug] [Thread-1 (]: On model.snowflake_instabee.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.dim_customers"} */
create or replace transient table PC_DBT_DB.DBT_.dim_customers
         as
        (SELECT DISTINCT
    customer_id,
    customer_name,
    segment
FROM PC_DBT_DB.DBT_.stg_instabee_orders
        );
[0m04:06:58.868172 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.677 seconds
[0m04:06:58.872173 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.dim_customers"
[0m04:06:58.872173 [debug] [Thread-1 (]: On model.snowflake_instabee.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.dim_customers"} */
use warehouse COMPUTE_WH
[0m04:06:58.956609 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.084 seconds
[0m04:06:58.958611 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ab02621e-529c-4207-b6b5-322527482baa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D01AE2B40>]}
[0m04:06:58.960614 [info ] [Thread-1 (]: 7 of 15 OK created sql table model DBT_.dim_customers .......................... [[32mSUCCESS 1[0m in 0.94s]
[0m04:06:58.960614 [debug] [Thread-1 (]: Finished running node model.snowflake_instabee.dim_customers
[0m04:06:58.961963 [debug] [Thread-1 (]: Began running node model.snowflake_instabee.dim_products
[0m04:06:58.962963 [info ] [Thread-1 (]: 8 of 15 START sql table model DBT_.dim_products ................................ [RUN]
[0m04:06:58.965272 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.snowflake_instabee.dim_customers, now model.snowflake_instabee.dim_products)
[0m04:06:58.967080 [debug] [Thread-1 (]: Began compiling node model.snowflake_instabee.dim_products
[0m04:06:58.971411 [debug] [Thread-1 (]: Writing injected SQL for node "model.snowflake_instabee.dim_products"
[0m04:06:58.972754 [debug] [Thread-1 (]: Began executing node model.snowflake_instabee.dim_products
[0m04:06:58.976005 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.dim_products"
[0m04:06:58.977008 [debug] [Thread-1 (]: On model.snowflake_instabee.dim_products: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.dim_products"} */
select current_warehouse() as warehouse
[0m04:06:59.101631 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.125 seconds
[0m04:06:59.105670 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.dim_products"
[0m04:06:59.105670 [debug] [Thread-1 (]: On model.snowflake_instabee.dim_products: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.dim_products"} */
use warehouse pc_dbt_wh_large
[0m04:06:59.185240 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.079 seconds
[0m04:06:59.188262 [debug] [Thread-1 (]: Writing runtime sql for node "model.snowflake_instabee.dim_products"
[0m04:06:59.191636 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.dim_products"
[0m04:06:59.191636 [debug] [Thread-1 (]: On model.snowflake_instabee.dim_products: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.dim_products"} */
create or replace transient table PC_DBT_DB.DBT_.dim_products
         as
        (WITH ranked_products AS (
  SELECT
    product_id,
    product_name,
    product_category,
    sub_category,
    ROW_NUMBER() OVER (
      PARTITION BY product_id 
      ORDER BY product_category NULLS LAST, sub_category NULLS LAST, product_name NULLS LAST
    ) as rn
  FROM PC_DBT_DB.DBT_.stg_instabee_orders
  WHERE product_id IS NOT NULL
  GROUP BY product_id, product_name, product_category, sub_category
)

SELECT
  product_id,
  product_name,
  product_category,
  sub_category
FROM ranked_products
WHERE rn = 1
        );
[0m04:06:59.815862 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.623 seconds
[0m04:06:59.818910 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.dim_products"
[0m04:06:59.819911 [debug] [Thread-1 (]: On model.snowflake_instabee.dim_products: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.dim_products"} */
use warehouse COMPUTE_WH
[0m04:06:59.893883 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.073 seconds
[0m04:06:59.898090 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ab02621e-529c-4207-b6b5-322527482baa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D01AD5400>]}
[0m04:06:59.900094 [info ] [Thread-1 (]: 8 of 15 OK created sql table model DBT_.dim_products ........................... [[32mSUCCESS 1[0m in 0.93s]
[0m04:06:59.901297 [debug] [Thread-1 (]: Finished running node model.snowflake_instabee.dim_products
[0m04:06:59.902305 [debug] [Thread-1 (]: Began running node model.snowflake_instabee.dim_regions
[0m04:06:59.903309 [info ] [Thread-1 (]: 9 of 15 START sql table model DBT_.dim_regions ................................. [RUN]
[0m04:06:59.904309 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.snowflake_instabee.dim_products, now model.snowflake_instabee.dim_regions)
[0m04:06:59.904309 [debug] [Thread-1 (]: Began compiling node model.snowflake_instabee.dim_regions
[0m04:06:59.910309 [debug] [Thread-1 (]: Writing injected SQL for node "model.snowflake_instabee.dim_regions"
[0m04:06:59.911309 [debug] [Thread-1 (]: Began executing node model.snowflake_instabee.dim_regions
[0m04:06:59.915692 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.dim_regions"
[0m04:06:59.917013 [debug] [Thread-1 (]: On model.snowflake_instabee.dim_regions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.dim_regions"} */
select current_warehouse() as warehouse
[0m04:06:59.992568 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.075 seconds
[0m04:06:59.994595 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.dim_regions"
[0m04:06:59.995961 [debug] [Thread-1 (]: On model.snowflake_instabee.dim_regions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.dim_regions"} */
use warehouse pc_dbt_wh_large
[0m04:07:00.083183 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.087 seconds
[0m04:07:00.086342 [debug] [Thread-1 (]: Writing runtime sql for node "model.snowflake_instabee.dim_regions"
[0m04:07:00.088369 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.dim_regions"
[0m04:07:00.089373 [debug] [Thread-1 (]: On model.snowflake_instabee.dim_regions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.dim_regions"} */
create or replace transient table PC_DBT_DB.DBT_.dim_regions
         as
        (SELECT DISTINCT
    r.region,
    r.state,
    p.regional_manager
FROM PC_DBT_DB.DBT_.stg_instabee_orders r
LEFT JOIN PC_DBT_DB.DBT_.stg_instabee_people p
    ON r.region = p.region
        );
[0m04:07:01.072451 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.982 seconds
[0m04:07:01.075450 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.dim_regions"
[0m04:07:01.076451 [debug] [Thread-1 (]: On model.snowflake_instabee.dim_regions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.dim_regions"} */
use warehouse COMPUTE_WH
[0m04:07:01.148642 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.072 seconds
[0m04:07:01.151744 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ab02621e-529c-4207-b6b5-322527482baa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016CF750EF90>]}
[0m04:07:01.152745 [info ] [Thread-1 (]: 9 of 15 OK created sql table model DBT_.dim_regions ............................ [[32mSUCCESS 1[0m in 1.25s]
[0m04:07:01.153860 [debug] [Thread-1 (]: Finished running node model.snowflake_instabee.dim_regions
[0m04:07:01.153860 [debug] [Thread-1 (]: Began running node model.snowflake_instabee.fact_sales
[0m04:07:01.154875 [info ] [Thread-1 (]: 10 of 15 START sql table model DBT_.fact_sales ................................. [RUN]
[0m04:07:01.155877 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.snowflake_instabee.dim_regions, now model.snowflake_instabee.fact_sales)
[0m04:07:01.156958 [debug] [Thread-1 (]: Began compiling node model.snowflake_instabee.fact_sales
[0m04:07:01.163437 [debug] [Thread-1 (]: Writing injected SQL for node "model.snowflake_instabee.fact_sales"
[0m04:07:01.165392 [debug] [Thread-1 (]: Began executing node model.snowflake_instabee.fact_sales
[0m04:07:01.171558 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.fact_sales"
[0m04:07:01.171558 [debug] [Thread-1 (]: On model.snowflake_instabee.fact_sales: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.fact_sales"} */
select current_warehouse() as warehouse
[0m04:07:01.240691 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.068 seconds
[0m04:07:01.242695 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.fact_sales"
[0m04:07:01.243705 [debug] [Thread-1 (]: On model.snowflake_instabee.fact_sales: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.fact_sales"} */
use warehouse pc_dbt_wh_large
[0m04:07:01.323519 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.079 seconds
[0m04:07:01.326541 [debug] [Thread-1 (]: Writing runtime sql for node "model.snowflake_instabee.fact_sales"
[0m04:07:01.329839 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.fact_sales"
[0m04:07:01.330849 [debug] [Thread-1 (]: On model.snowflake_instabee.fact_sales: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.fact_sales"} */
create or replace transient table PC_DBT_DB.DBT_.fact_sales
         as
        (WITH base AS (
    SELECT
        o.order_line_id,
        o.order_id,
        o.order_date,
        o.ship_date,
        o.ship_mode,
        o.customer_id,
        o.product_id,
        o.country,
        o.region,
        o.state,
        o.sales,
        o.quantity,
        o.discount,
        o.profit,
        r.returned
    FROM PC_DBT_DB.DBT_.stg_instabee_orders o
    LEFT JOIN PC_DBT_DB.DBT_.stg_instabee_returns r
        ON o.order_id = r.order_id
)

SELECT *
FROM base
        );
[0m04:07:02.330984 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.999 seconds
[0m04:07:02.334993 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.fact_sales"
[0m04:07:02.334993 [debug] [Thread-1 (]: On model.snowflake_instabee.fact_sales: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.fact_sales"} */
use warehouse COMPUTE_WH
[0m04:07:02.455028 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.119 seconds
[0m04:07:02.457504 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ab02621e-529c-4207-b6b5-322527482baa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D01B1BD40>]}
[0m04:07:02.458506 [info ] [Thread-1 (]: 10 of 15 OK created sql table model DBT_.fact_sales ............................ [[32mSUCCESS 1[0m in 1.30s]
[0m04:07:02.459507 [debug] [Thread-1 (]: Finished running node model.snowflake_instabee.fact_sales
[0m04:07:02.461347 [debug] [Thread-1 (]: Began running node model.snowflake_instabee.month_on_month_change
[0m04:07:02.462546 [info ] [Thread-1 (]: 11 of 15 START sql table model DBT_.month_on_month_change ...................... [RUN]
[0m04:07:02.463642 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.snowflake_instabee.fact_sales, now model.snowflake_instabee.month_on_month_change)
[0m04:07:02.464658 [debug] [Thread-1 (]: Began compiling node model.snowflake_instabee.month_on_month_change
[0m04:07:02.468665 [debug] [Thread-1 (]: Writing injected SQL for node "model.snowflake_instabee.month_on_month_change"
[0m04:07:02.469995 [debug] [Thread-1 (]: Began executing node model.snowflake_instabee.month_on_month_change
[0m04:07:02.473023 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.month_on_month_change"
[0m04:07:02.473023 [debug] [Thread-1 (]: On model.snowflake_instabee.month_on_month_change: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.month_on_month_change"} */
select current_warehouse() as warehouse
[0m04:07:02.543689 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.070 seconds
[0m04:07:02.547009 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.month_on_month_change"
[0m04:07:02.547009 [debug] [Thread-1 (]: On model.snowflake_instabee.month_on_month_change: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.month_on_month_change"} */
use warehouse pc_dbt_wh_large
[0m04:07:02.617548 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.069 seconds
[0m04:07:02.621546 [debug] [Thread-1 (]: Writing runtime sql for node "model.snowflake_instabee.month_on_month_change"
[0m04:07:02.624547 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.month_on_month_change"
[0m04:07:02.624547 [debug] [Thread-1 (]: On model.snowflake_instabee.month_on_month_change: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.month_on_month_change"} */
create or replace transient table PC_DBT_DB.DBT_.month_on_month_change
         as
        (SELECT
    DATE_TRUNC('month', order_date) AS order_month,
    SUM(sales) AS total_sales,
    LAG(SUM(sales)) OVER (ORDER BY DATE_TRUNC('month', order_date)) AS previous_month_sales,
    SUM(sales) - LAG(SUM(sales)) OVER (ORDER BY DATE_TRUNC('month', order_date)) AS change_in_sales
FROM PC_DBT_DB.DBT_.fact_sales
WHERE EXTRACT(YEAR FROM order_date) = 2019
GROUP BY 1
        );
[0m04:07:03.362320 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.737 seconds
[0m04:07:03.365845 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.month_on_month_change"
[0m04:07:03.366896 [debug] [Thread-1 (]: On model.snowflake_instabee.month_on_month_change: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.month_on_month_change"} */
use warehouse COMPUTE_WH
[0m04:07:03.485483 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.118 seconds
[0m04:07:03.488482 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ab02621e-529c-4207-b6b5-322527482baa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D019B61B0>]}
[0m04:07:03.489482 [info ] [Thread-1 (]: 11 of 15 OK created sql table model DBT_.month_on_month_change ................. [[32mSUCCESS 1[0m in 1.02s]
[0m04:07:03.490482 [debug] [Thread-1 (]: Finished running node model.snowflake_instabee.month_on_month_change
[0m04:07:03.490482 [debug] [Thread-1 (]: Began running node model.snowflake_instabee.monthly_returns_per_category
[0m04:07:03.491483 [info ] [Thread-1 (]: 12 of 15 START sql table model DBT_.monthly_returns_per_category ............... [RUN]
[0m04:07:03.492750 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.snowflake_instabee.month_on_month_change, now model.snowflake_instabee.monthly_returns_per_category)
[0m04:07:03.492750 [debug] [Thread-1 (]: Began compiling node model.snowflake_instabee.monthly_returns_per_category
[0m04:07:03.499440 [debug] [Thread-1 (]: Writing injected SQL for node "model.snowflake_instabee.monthly_returns_per_category"
[0m04:07:03.501746 [debug] [Thread-1 (]: Began executing node model.snowflake_instabee.monthly_returns_per_category
[0m04:07:03.505160 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.monthly_returns_per_category"
[0m04:07:03.506160 [debug] [Thread-1 (]: On model.snowflake_instabee.monthly_returns_per_category: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.monthly_returns_per_category"} */
select current_warehouse() as warehouse
[0m04:07:03.568894 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.062 seconds
[0m04:07:03.570959 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.monthly_returns_per_category"
[0m04:07:03.571960 [debug] [Thread-1 (]: On model.snowflake_instabee.monthly_returns_per_category: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.monthly_returns_per_category"} */
use warehouse pc_dbt_wh_large
[0m04:07:03.666213 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.093 seconds
[0m04:07:03.669219 [debug] [Thread-1 (]: Writing runtime sql for node "model.snowflake_instabee.monthly_returns_per_category"
[0m04:07:03.671388 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.monthly_returns_per_category"
[0m04:07:03.672542 [debug] [Thread-1 (]: On model.snowflake_instabee.monthly_returns_per_category: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.monthly_returns_per_category"} */
create or replace transient table PC_DBT_DB.DBT_.monthly_returns_per_category
         as
        (select * from (SELECT
    DATE_TRUNC('month', s.order_date) AS order_month,
    p.product_category,P.SUB_CATEGORY,
    COUNT(CASE WHEN s.order_id IS NOT NULL and s.returned = 'Yes' THEN 1 END) AS returned_orders
FROM PC_DBT_DB.DBT_.fact_sales s
JOIN PC_DBT_DB.DBT_.dim_products p
    ON s.product_id = p.product_id
WHERE EXTRACT(YEAR FROM s.order_date) = 2019
GROUP BY 1, 2,3
ORDER BY 4 DESC)
WHERE returned_orders <>0
        );
[0m04:07:04.587484 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.914 seconds
[0m04:07:04.590483 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.monthly_returns_per_category"
[0m04:07:04.591483 [debug] [Thread-1 (]: On model.snowflake_instabee.monthly_returns_per_category: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.monthly_returns_per_category"} */
use warehouse COMPUTE_WH
[0m04:07:04.663864 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.071 seconds
[0m04:07:04.666871 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ab02621e-529c-4207-b6b5-322527482baa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016CF6AA5070>]}
[0m04:07:04.668875 [info ] [Thread-1 (]: 12 of 15 OK created sql table model DBT_.monthly_returns_per_category .......... [[32mSUCCESS 1[0m in 1.18s]
[0m04:07:04.669893 [debug] [Thread-1 (]: Finished running node model.snowflake_instabee.monthly_returns_per_category
[0m04:07:04.670896 [debug] [Thread-1 (]: Began running node model.snowflake_instabee.sales_growth_per_category
[0m04:07:04.670896 [info ] [Thread-1 (]: 13 of 15 START sql table model DBT_.sales_growth_per_category .................. [RUN]
[0m04:07:04.671908 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.snowflake_instabee.monthly_returns_per_category, now model.snowflake_instabee.sales_growth_per_category)
[0m04:07:04.672910 [debug] [Thread-1 (]: Began compiling node model.snowflake_instabee.sales_growth_per_category
[0m04:07:04.678245 [debug] [Thread-1 (]: Writing injected SQL for node "model.snowflake_instabee.sales_growth_per_category"
[0m04:07:04.679530 [debug] [Thread-1 (]: Began executing node model.snowflake_instabee.sales_growth_per_category
[0m04:07:04.682572 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.sales_growth_per_category"
[0m04:07:04.683575 [debug] [Thread-1 (]: On model.snowflake_instabee.sales_growth_per_category: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.sales_growth_per_category"} */
select current_warehouse() as warehouse
[0m04:07:04.751036 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.068 seconds
[0m04:07:04.754036 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.sales_growth_per_category"
[0m04:07:04.754036 [debug] [Thread-1 (]: On model.snowflake_instabee.sales_growth_per_category: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.sales_growth_per_category"} */
use warehouse pc_dbt_wh_large
[0m04:07:04.859478 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.104 seconds
[0m04:07:04.862299 [debug] [Thread-1 (]: Writing runtime sql for node "model.snowflake_instabee.sales_growth_per_category"
[0m04:07:04.866202 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.sales_growth_per_category"
[0m04:07:04.866202 [debug] [Thread-1 (]: On model.snowflake_instabee.sales_growth_per_category: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.sales_growth_per_category"} */
create or replace transient table PC_DBT_DB.DBT_.sales_growth_per_category
         as
        (SELECT
    DATE_TRUNC('month', s.order_date) AS order_month,
    p.product_category,
    SUM(s.sales) AS monthly_sales,
    LAG(SUM(s.sales)) OVER (PARTITION BY p.product_category ORDER BY DATE_TRUNC('month', s.order_date)) AS previous_month_sales,
    (SUM(s.sales) - LAG(SUM(s.sales)) OVER (PARTITION BY p.product_category ORDER BY DATE_TRUNC('month', s.order_date))) /
        NULLIF(LAG(SUM(s.sales)) OVER (PARTITION BY p.product_category ORDER BY DATE_TRUNC('month', s.order_date)), 0) AS growth_rate
FROM PC_DBT_DB.DBT_.fact_sales s
JOIN PC_DBT_DB.DBT_.dim_products p
    ON s.product_id = p.product_id
WHERE EXTRACT(YEAR FROM order_date) = 2019
GROUP BY 1, 2
        );
[0m04:07:05.789845 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.922 seconds
[0m04:07:05.838763 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.sales_growth_per_category"
[0m04:07:05.839770 [debug] [Thread-1 (]: On model.snowflake_instabee.sales_growth_per_category: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.sales_growth_per_category"} */
use warehouse COMPUTE_WH
[0m04:07:05.929148 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.088 seconds
[0m04:07:05.932585 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ab02621e-529c-4207-b6b5-322527482baa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D01B1EFC0>]}
[0m04:07:05.933585 [info ] [Thread-1 (]: 13 of 15 OK created sql table model DBT_.sales_growth_per_category ............. [[32mSUCCESS 1[0m in 1.26s]
[0m04:07:05.934585 [debug] [Thread-1 (]: Finished running node model.snowflake_instabee.sales_growth_per_category
[0m04:07:05.935585 [debug] [Thread-1 (]: Began running node model.snowflake_instabee.sales_over_time
[0m04:07:05.935585 [info ] [Thread-1 (]: 14 of 15 START sql table model DBT_.sales_over_time ............................ [RUN]
[0m04:07:05.936895 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.snowflake_instabee.sales_growth_per_category, now model.snowflake_instabee.sales_over_time)
[0m04:07:05.937903 [debug] [Thread-1 (]: Began compiling node model.snowflake_instabee.sales_over_time
[0m04:07:05.942947 [debug] [Thread-1 (]: Writing injected SQL for node "model.snowflake_instabee.sales_over_time"
[0m04:07:05.945249 [debug] [Thread-1 (]: Began executing node model.snowflake_instabee.sales_over_time
[0m04:07:05.950331 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.sales_over_time"
[0m04:07:05.951336 [debug] [Thread-1 (]: On model.snowflake_instabee.sales_over_time: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.sales_over_time"} */
select current_warehouse() as warehouse
[0m04:07:06.026569 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.075 seconds
[0m04:07:06.028586 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.sales_over_time"
[0m04:07:06.030046 [debug] [Thread-1 (]: On model.snowflake_instabee.sales_over_time: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.sales_over_time"} */
use warehouse pc_dbt_wh_large
[0m04:07:06.097233 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.067 seconds
[0m04:07:06.101384 [debug] [Thread-1 (]: Writing runtime sql for node "model.snowflake_instabee.sales_over_time"
[0m04:07:06.104384 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.sales_over_time"
[0m04:07:06.105384 [debug] [Thread-1 (]: On model.snowflake_instabee.sales_over_time: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.sales_over_time"} */
create or replace transient table PC_DBT_DB.DBT_.sales_over_time
         as
        (WITH monthly_sales AS (
  SELECT
      DATE_TRUNC('month', order_date) AS order_month,
      p.product_category,
      SUM(s.sales) AS category_sales
  FROM PC_DBT_DB.DBT_.fact_sales s
  JOIN PC_DBT_DB.DBT_.dim_products p
      ON s.product_id = p.product_id
  WHERE EXTRACT(YEAR FROM order_date) = 2019
  GROUP BY 1, 2
),

monthly_totals AS (
  SELECT
      order_month,
      SUM(category_sales) AS total_monthly_sales
  FROM monthly_sales
  GROUP BY 1
)

SELECT
    ms.order_month,
    ms.product_category,
    ms.category_sales,
    ROUND(ms.category_sales * 100.0 / mt.total_monthly_sales, 2) AS sales_percentage
FROM monthly_sales ms
JOIN monthly_totals mt
    ON ms.order_month = mt.order_month
ORDER BY 1, 4 DESC
        );
[0m04:07:06.795256 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.689 seconds
[0m04:07:06.798188 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.sales_over_time"
[0m04:07:06.799191 [debug] [Thread-1 (]: On model.snowflake_instabee.sales_over_time: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.sales_over_time"} */
use warehouse COMPUTE_WH
[0m04:07:06.875264 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.076 seconds
[0m04:07:06.877795 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ab02621e-529c-4207-b6b5-322527482baa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D01959910>]}
[0m04:07:06.878814 [info ] [Thread-1 (]: 14 of 15 OK created sql table model DBT_.sales_over_time ....................... [[32mSUCCESS 1[0m in 0.94s]
[0m04:07:06.880734 [debug] [Thread-1 (]: Finished running node model.snowflake_instabee.sales_over_time
[0m04:07:06.880734 [debug] [Thread-1 (]: Began running node model.snowflake_instabee.top_selling_states_and_regions
[0m04:07:06.881737 [info ] [Thread-1 (]: 15 of 15 START sql table model DBT_.top_selling_states_and_regions ............. [RUN]
[0m04:07:06.881737 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.snowflake_instabee.sales_over_time, now model.snowflake_instabee.top_selling_states_and_regions)
[0m04:07:06.883212 [debug] [Thread-1 (]: Began compiling node model.snowflake_instabee.top_selling_states_and_regions
[0m04:07:06.888222 [debug] [Thread-1 (]: Writing injected SQL for node "model.snowflake_instabee.top_selling_states_and_regions"
[0m04:07:06.902955 [debug] [Thread-1 (]: Began executing node model.snowflake_instabee.top_selling_states_and_regions
[0m04:07:06.907001 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.top_selling_states_and_regions"
[0m04:07:06.908009 [debug] [Thread-1 (]: On model.snowflake_instabee.top_selling_states_and_regions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.top_selling_states_and_regions"} */
select current_warehouse() as warehouse
[0m04:07:06.987334 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.078 seconds
[0m04:07:06.989338 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.top_selling_states_and_regions"
[0m04:07:06.990339 [debug] [Thread-1 (]: On model.snowflake_instabee.top_selling_states_and_regions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.top_selling_states_and_regions"} */
use warehouse pc_dbt_wh_large
[0m04:07:07.070963 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.080 seconds
[0m04:07:07.073967 [debug] [Thread-1 (]: Writing runtime sql for node "model.snowflake_instabee.top_selling_states_and_regions"
[0m04:07:07.081252 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.top_selling_states_and_regions"
[0m04:07:07.082254 [debug] [Thread-1 (]: On model.snowflake_instabee.top_selling_states_and_regions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.top_selling_states_and_regions"} */
create or replace transient table PC_DBT_DB.DBT_.top_selling_states_and_regions
         as
        (WITH monthly_region_sales AS(SELECT
DATE_TRUNC('month', order_date) AS order_month,
    s.region,
    s.state,
    d.regional_manager,
    SUM(s.sales) AS region_sales
FROM PC_DBT_DB.DBT_.fact_sales s
LEFT JOIN PC_DBT_DB.DBT_.dim_regions d
    ON s.region = d.region AND s.state = d.state
WHERE EXTRACT(YEAR FROM s.order_date) = 2019
GROUP BY 1, 2, 3,4
ORDER BY region_sales DESC),

monthly_totals AS (
  SELECT
      order_month,
      SUM(region_sales) AS total_monthly_sales
  FROM monthly_region_sales
  GROUP BY 1
),

ranked_regions AS (
  SELECT
      mrs.*,
      mt.total_monthly_sales,
      ROUND(mrs.region_sales * 100.0 / mt.total_monthly_sales, 2) AS sales_percentage,
      ROW_NUMBER() OVER (PARTITION BY mrs.order_month ORDER BY mrs.region_sales DESC) AS region_rank
  FROM monthly_region_sales mrs
  JOIN monthly_totals mt
      ON mrs.order_month = mt.order_month
  WHERE mrs.order_month IS NOT NULL
)

SELECT
    order_month,
    region AS top_region,
    state AS top_state,
    regional_manager,
    region_sales,
    sales_percentage
FROM ranked_regions
WHERE region_rank = 1
ORDER BY order_month DESC
        );
[0m04:07:08.000115 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.917 seconds
[0m04:07:08.003148 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.top_selling_states_and_regions"
[0m04:07:08.004155 [debug] [Thread-1 (]: On model.snowflake_instabee.top_selling_states_and_regions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.top_selling_states_and_regions"} */
use warehouse COMPUTE_WH
[0m04:07:08.087935 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.083 seconds
[0m04:07:08.089935 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ab02621e-529c-4207-b6b5-322527482baa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D011906B0>]}
[0m04:07:08.090935 [info ] [Thread-1 (]: 15 of 15 OK created sql table model DBT_.top_selling_states_and_regions ........ [[32mSUCCESS 1[0m in 1.21s]
[0m04:07:08.093282 [debug] [Thread-1 (]: Finished running node model.snowflake_instabee.top_selling_states_and_regions
[0m04:07:08.096299 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:07:08.097479 [debug] [MainThread]: Connection 'list_PC_DBT_DB' was left open.
[0m04:07:08.097479 [debug] [MainThread]: On list_PC_DBT_DB: Close
[0m04:07:08.207376 [debug] [MainThread]: Connection 'list_PC_DBT_DB_DBT_' was left open.
[0m04:07:08.208759 [debug] [MainThread]: On list_PC_DBT_DB_DBT_: Close
[0m04:07:08.328012 [debug] [MainThread]: Connection 'model.snowflake_instabee.top_selling_states_and_regions' was left open.
[0m04:07:08.329015 [debug] [MainThread]: On model.snowflake_instabee.top_selling_states_and_regions: Close
[0m04:07:08.437524 [info ] [MainThread]: 
[0m04:07:08.437524 [info ] [MainThread]: Finished running 10 table models, 5 view models in 0 hours 0 minutes and 15.11 seconds (15.11s).
[0m04:07:08.443183 [debug] [MainThread]: Command end result
[0m04:07:08.489390 [debug] [MainThread]: Wrote artifact WritableManifest to E:\desk\onedrive\Desktop\snowflake_instabee\target\manifest.json
[0m04:07:08.494846 [debug] [MainThread]: Wrote artifact SemanticManifest to E:\desk\onedrive\Desktop\snowflake_instabee\target\semantic_manifest.json
[0m04:07:08.579687 [debug] [MainThread]: Wrote artifact RunExecutionResult to E:\desk\onedrive\Desktop\snowflake_instabee\target\run_results.json
[0m04:07:08.580700 [info ] [MainThread]: 
[0m04:07:08.580700 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m04:07:08.581901 [info ] [MainThread]: 
[0m04:07:08.582905 [error] [MainThread]:   Database Error in model generate_surrogate_key (models\macros\generate_surrogate_key.sql)
  001003 (42000): SQL compilation error:
  syntax error line 5 at position 2 unexpected ')'.
  compiled code at target\run\snowflake_instabee\models\macros\generate_surrogate_key.sql
[0m04:07:08.582905 [info ] [MainThread]: 
[0m04:07:08.583908 [info ] [MainThread]: Done. PASS=14 WARN=0 ERROR=1 SKIP=0 TOTAL=15
[0m04:07:08.584912 [debug] [MainThread]: Command `dbt run` failed at 04:07:08.584912 after 20.81 seconds
[0m04:07:08.585914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D01B1F770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016CFC162E40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016CFC162AE0>]}
[0m04:07:08.585914 [debug] [MainThread]: Flushing usage events
[0m04:07:09.196544 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m04:10:34.700052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D51F138B90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D521838560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D52183BF80>]}


============================== 04:10:34.708919 | 2f399339-421f-4d4b-b1b9-9244b4a9ce09 ==============================
[0m04:10:34.708919 [info ] [MainThread]: Running with dbt=1.9.4
[0m04:10:34.708919 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Venee\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'E:\\desk\\onedrive\\Desktop\\snowflake_instabee\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt deps', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m04:10:34.924176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2f399339-421f-4d4b-b1b9-9244b4a9ce09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D521D6E150>]}
[0m04:10:35.119250 [debug] [MainThread]: Set downloads directory='C:\Users\Venee\AppData\Local\Temp\dbt-downloads-5pub_90y'
[0m04:10:35.120246 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m04:10:35.206288 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m04:10:35.207287 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m04:10:35.254404 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m04:10:35.261538 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m04:10:35.756674 [info ] [MainThread]: Installed from version 1.3.0
[0m04:10:35.756674 [info ] [MainThread]: Up to date!
[0m04:10:35.757681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '2f399339-421f-4d4b-b1b9-9244b4a9ce09', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D521D11550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D521D13E00>]}
[0m04:10:35.759692 [debug] [MainThread]: Command `dbt deps` succeeded at 04:10:35.759692 after 1.30 seconds
[0m04:10:35.760813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D51F681FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D521B67320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D5218F9A30>]}
[0m04:10:35.760813 [debug] [MainThread]: Flushing usage events
[0m04:10:36.202812 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m04:11:37.839087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012A265395B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012A26538740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012A23CCF3B0>]}


============================== 04:11:37.845549 | 82f44e9f-0228-460c-81e9-51497a3d5a2a ==============================
[0m04:11:37.845549 [info ] [MainThread]: Running with dbt=1.9.4
[0m04:11:37.846552 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Venee\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'E:\\desk\\onedrive\\Desktop\\snowflake_instabee\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt compile --select generate_surrogate_key', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m04:11:39.245206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '82f44e9f-0228-460c-81e9-51497a3d5a2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012A2F20DE50>]}
[0m04:11:39.344291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '82f44e9f-0228-460c-81e9-51497a3d5a2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012A2F271790>]}
[0m04:11:39.345294 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m04:11:40.194082 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m04:11:40.647502 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m04:11:40.647502 [debug] [MainThread]: Partial parsing: updated file: snowflake_instabee://models\macros\generate_surrogate_key.sql
[0m04:11:40.649008 [debug] [MainThread]: Partial parsing: updated file: snowflake_instabee://models\staging\instabee\stg_instabee_orders.sql
[0m04:11:41.105815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '82f44e9f-0228-460c-81e9-51497a3d5a2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012A2F3A9D90>]}
[0m04:11:41.245720 [debug] [MainThread]: Wrote artifact WritableManifest to E:\desk\onedrive\Desktop\snowflake_instabee\target\manifest.json
[0m04:11:41.252228 [debug] [MainThread]: Wrote artifact SemanticManifest to E:\desk\onedrive\Desktop\snowflake_instabee\target\semantic_manifest.json
[0m04:11:41.285707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '82f44e9f-0228-460c-81e9-51497a3d5a2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012A2F63AB40>]}
[0m04:11:41.287707 [info ] [MainThread]: Found 15 models, 17 data tests, 3 sources, 590 macros
[0m04:11:41.289320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '82f44e9f-0228-460c-81e9-51497a3d5a2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012A2F899FA0>]}
[0m04:11:41.292974 [info ] [MainThread]: 
[0m04:11:41.293978 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:11:41.294979 [info ] [MainThread]: 
[0m04:11:41.295489 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m04:11:41.303169 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PC_DBT_DB_DBT_'
[0m04:11:41.472678 [debug] [ThreadPool]: Using snowflake connection "list_PC_DBT_DB_DBT_"
[0m04:11:41.472678 [debug] [ThreadPool]: On list_PC_DBT_DB_DBT_: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "connection_name": "list_PC_DBT_DB_DBT_"} */
show objects in PC_DBT_DB.DBT_ limit 10000;
[0m04:11:41.473825 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:11:42.161289 [debug] [ThreadPool]: SQL status: SUCCESS 16 in 0.687 seconds
[0m04:11:42.171408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '82f44e9f-0228-460c-81e9-51497a3d5a2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012A2F30BE90>]}
[0m04:11:42.176365 [debug] [Thread-1 (]: Began running node model.snowflake_instabee.generate_surrogate_key
[0m04:11:42.177514 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.snowflake_instabee.generate_surrogate_key'
[0m04:11:42.177514 [debug] [Thread-1 (]: Began compiling node model.snowflake_instabee.generate_surrogate_key
[0m04:11:42.191253 [debug] [Thread-1 (]: Writing injected SQL for node "model.snowflake_instabee.generate_surrogate_key"
[0m04:11:42.192268 [debug] [Thread-1 (]: Began executing node model.snowflake_instabee.generate_surrogate_key
[0m04:11:42.193273 [debug] [Thread-1 (]: Finished running node model.snowflake_instabee.generate_surrogate_key
[0m04:11:42.194343 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:11:42.194343 [debug] [MainThread]: Connection 'list_PC_DBT_DB_DBT_' was left open.
[0m04:11:42.195350 [debug] [MainThread]: On list_PC_DBT_DB_DBT_: Close
[0m04:11:42.303298 [debug] [MainThread]: Connection 'model.snowflake_instabee.generate_surrogate_key' was properly closed.
[0m04:11:42.305643 [debug] [MainThread]: Command end result
[0m04:11:42.357479 [debug] [MainThread]: Wrote artifact WritableManifest to E:\desk\onedrive\Desktop\snowflake_instabee\target\manifest.json
[0m04:11:42.359496 [debug] [MainThread]: Wrote artifact SemanticManifest to E:\desk\onedrive\Desktop\snowflake_instabee\target\semantic_manifest.json
[0m04:11:42.371632 [debug] [MainThread]: Wrote artifact RunExecutionResult to E:\desk\onedrive\Desktop\snowflake_instabee\target\run_results.json
[0m04:11:42.372740 [info ] [MainThread]: Compiled node 'generate_surrogate_key' is:

[0m04:11:42.373740 [debug] [MainThread]: Command `dbt compile` succeeded at 04:11:42.373740 after 4.72 seconds
[0m04:11:42.373740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012A269F3080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012A23E7B560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012A21C91880>]}
[0m04:11:42.374739 [debug] [MainThread]: Flushing usage events
[0m04:11:42.808762 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m04:12:43.052711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D514271130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D5148388F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D512138A70>]}


============================== 04:12:43.062705 | ade4bf3b-1381-44d5-986f-322e5f51b3df ==============================
[0m04:12:43.062705 [info ] [MainThread]: Running with dbt=1.9.4
[0m04:12:43.063714 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Venee\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'E:\\desk\\onedrive\\Desktop\\snowflake_instabee\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m04:12:44.609764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ade4bf3b-1381-44d5-986f-322e5f51b3df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D51E100C80>]}
[0m04:12:44.706213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ade4bf3b-1381-44d5-986f-322e5f51b3df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D514BC1970>]}
[0m04:12:44.707271 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m04:12:45.502985 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m04:12:45.929993 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:12:45.930994 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:12:46.043730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ade4bf3b-1381-44d5-986f-322e5f51b3df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D514D12660>]}
[0m04:12:46.255903 [debug] [MainThread]: Wrote artifact WritableManifest to E:\desk\onedrive\Desktop\snowflake_instabee\target\manifest.json
[0m04:12:46.265000 [debug] [MainThread]: Wrote artifact SemanticManifest to E:\desk\onedrive\Desktop\snowflake_instabee\target\semantic_manifest.json
[0m04:12:46.315209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ade4bf3b-1381-44d5-986f-322e5f51b3df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D51EB03EC0>]}
[0m04:12:46.316209 [info ] [MainThread]: Found 15 models, 17 data tests, 3 sources, 590 macros
[0m04:12:46.317209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ade4bf3b-1381-44d5-986f-322e5f51b3df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D514E442F0>]}
[0m04:12:46.324900 [info ] [MainThread]: 
[0m04:12:46.325901 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:12:46.325901 [info ] [MainThread]: 
[0m04:12:46.326903 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m04:12:46.339193 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PC_DBT_DB'
[0m04:12:46.525596 [debug] [ThreadPool]: Using snowflake connection "list_PC_DBT_DB"
[0m04:12:46.526596 [debug] [ThreadPool]: On list_PC_DBT_DB: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "connection_name": "list_PC_DBT_DB"} */
show terse schemas in database PC_DBT_DB
    limit 10000
[0m04:12:46.526596 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:12:47.161982 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.635 seconds
[0m04:12:47.167028 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PC_DBT_DB_DBT_'
[0m04:12:47.184714 [debug] [ThreadPool]: Using snowflake connection "list_PC_DBT_DB_DBT_"
[0m04:12:47.184714 [debug] [ThreadPool]: On list_PC_DBT_DB_DBT_: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "connection_name": "list_PC_DBT_DB_DBT_"} */
show objects in PC_DBT_DB.DBT_ limit 10000;
[0m04:12:47.185715 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:12:47.675671 [debug] [ThreadPool]: SQL status: SUCCESS 16 in 0.491 seconds
[0m04:12:47.685031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ade4bf3b-1381-44d5-986f-322e5f51b3df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D51E578980>]}
[0m04:12:47.691613 [debug] [Thread-1 (]: Began running node model.snowflake_instabee.generate_surrogate_key
[0m04:12:47.692960 [info ] [Thread-1 (]: 1 of 15 START sql view model DBT_.generate_surrogate_key ....................... [RUN]
[0m04:12:47.693967 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.snowflake_instabee.generate_surrogate_key'
[0m04:12:47.694974 [debug] [Thread-1 (]: Began compiling node model.snowflake_instabee.generate_surrogate_key
[0m04:12:47.710541 [debug] [Thread-1 (]: Writing injected SQL for node "model.snowflake_instabee.generate_surrogate_key"
[0m04:12:47.711541 [debug] [Thread-1 (]: Began executing node model.snowflake_instabee.generate_surrogate_key
[0m04:12:47.763144 [debug] [Thread-1 (]: Writing runtime sql for node "model.snowflake_instabee.generate_surrogate_key"
[0m04:12:47.765150 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.generate_surrogate_key"
[0m04:12:47.766184 [debug] [Thread-1 (]: On model.snowflake_instabee.generate_surrogate_key: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.generate_surrogate_key"} */
create or replace   view PC_DBT_DB.DBT_.generate_surrogate_key
  
   as (
    
  );
[0m04:12:47.766184 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m04:12:48.232342 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bbd3e0-0001-b42c-0002-47d20006f73e
[0m04:12:48.233346 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 5 at position 2 unexpected ')'.
[0m04:12:48.241469 [debug] [Thread-1 (]: Database Error in model generate_surrogate_key (models\macros\generate_surrogate_key.sql)
  001003 (42000): SQL compilation error:
  syntax error line 5 at position 2 unexpected ')'.
  compiled code at target\run\snowflake_instabee\models\macros\generate_surrogate_key.sql
[0m04:12:48.244675 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ade4bf3b-1381-44d5-986f-322e5f51b3df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D51EF5B6E0>]}
[0m04:12:48.245685 [error] [Thread-1 (]: 1 of 15 ERROR creating sql view model DBT_.generate_surrogate_key .............. [[31mERROR[0m in 0.55s]
[0m04:12:48.247717 [debug] [Thread-1 (]: Finished running node model.snowflake_instabee.generate_surrogate_key
[0m04:12:48.247717 [debug] [Thread-1 (]: Began running node model.snowflake_instabee.my_first_dbt_model
[0m04:12:48.248724 [debug] [Thread-4 (]: Marking all children of 'model.snowflake_instabee.generate_surrogate_key' to be skipped because of status 'error'.  Reason: Database Error in model generate_surrogate_key (models\macros\generate_surrogate_key.sql)
  001003 (42000): SQL compilation error:
  syntax error line 5 at position 2 unexpected ')'.
  compiled code at target\run\snowflake_instabee\models\macros\generate_surrogate_key.sql.
[0m04:12:48.249731 [info ] [Thread-1 (]: 2 of 15 START sql table model DBT_.my_first_dbt_model .......................... [RUN]
[0m04:12:48.251036 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.snowflake_instabee.generate_surrogate_key, now model.snowflake_instabee.my_first_dbt_model)
[0m04:12:48.252283 [debug] [Thread-1 (]: Began compiling node model.snowflake_instabee.my_first_dbt_model
[0m04:12:48.260527 [debug] [Thread-1 (]: Writing injected SQL for node "model.snowflake_instabee.my_first_dbt_model"
[0m04:12:48.262527 [debug] [Thread-1 (]: Began executing node model.snowflake_instabee.my_first_dbt_model
[0m04:12:48.299646 [debug] [Thread-1 (]: Writing runtime sql for node "model.snowflake_instabee.my_first_dbt_model"
[0m04:12:48.301974 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.my_first_dbt_model"
[0m04:12:48.303075 [debug] [Thread-1 (]: On model.snowflake_instabee.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.my_first_dbt_model"} */
create or replace transient table PC_DBT_DB.DBT_.my_first_dbt_model
         as
        (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (
    select 1 as id, 'Example record 1' as description
    union all
    select 2 as id, 'Example record 2' as description
)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
        );
[0m04:12:49.086712 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.783 seconds
[0m04:12:49.125534 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ade4bf3b-1381-44d5-986f-322e5f51b3df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D512220D40>]}
[0m04:12:49.126534 [info ] [Thread-1 (]: 2 of 15 OK created sql table model DBT_.my_first_dbt_model ..................... [[32mSUCCESS 1[0m in 0.87s]
[0m04:12:49.127535 [debug] [Thread-1 (]: Finished running node model.snowflake_instabee.my_first_dbt_model
[0m04:12:49.128679 [debug] [Thread-1 (]: Began running node model.snowflake_instabee.stg_instabee_orders
[0m04:12:49.129682 [info ] [Thread-1 (]: 3 of 15 START sql view model DBT_.stg_instabee_orders .......................... [RUN]
[0m04:12:49.129682 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.snowflake_instabee.my_first_dbt_model, now model.snowflake_instabee.stg_instabee_orders)
[0m04:12:49.130747 [debug] [Thread-1 (]: Began compiling node model.snowflake_instabee.stg_instabee_orders
[0m04:12:49.143456 [debug] [Thread-1 (]: Compilation Error in model stg_instabee_orders (models\staging\instabee\stg_instabee_orders.sql)
  'generate_surrogate_key' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m04:12:49.144546 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ade4bf3b-1381-44d5-986f-322e5f51b3df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D51F1217C0>]}
[0m04:12:49.145668 [error] [Thread-1 (]: 3 of 15 ERROR creating sql view model DBT_.stg_instabee_orders ................. [[31mERROR[0m in 0.01s]
[0m04:12:49.146681 [debug] [Thread-1 (]: Finished running node model.snowflake_instabee.stg_instabee_orders
[0m04:12:49.146681 [debug] [Thread-1 (]: Began running node model.snowflake_instabee.stg_instabee_people
[0m04:12:49.147702 [debug] [Thread-4 (]: Marking all children of 'model.snowflake_instabee.stg_instabee_orders' to be skipped because of status 'error'.  Reason: Compilation Error in model stg_instabee_orders (models\staging\instabee\stg_instabee_orders.sql)
  'generate_surrogate_key' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m04:12:49.148799 [info ] [Thread-1 (]: 4 of 15 START sql view model DBT_.stg_instabee_people .......................... [RUN]
[0m04:12:49.149929 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.snowflake_instabee.stg_instabee_orders, now model.snowflake_instabee.stg_instabee_people)
[0m04:12:49.149929 [debug] [Thread-1 (]: Began compiling node model.snowflake_instabee.stg_instabee_people
[0m04:12:49.157385 [debug] [Thread-1 (]: Writing injected SQL for node "model.snowflake_instabee.stg_instabee_people"
[0m04:12:49.158526 [debug] [Thread-1 (]: Began executing node model.snowflake_instabee.stg_instabee_people
[0m04:12:49.161656 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.stg_instabee_people"
[0m04:12:49.162657 [debug] [Thread-1 (]: On model.snowflake_instabee.stg_instabee_people: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.stg_instabee_people"} */
select current_warehouse() as warehouse
[0m04:12:49.250825 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.087 seconds
[0m04:12:49.253397 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.stg_instabee_people"
[0m04:12:49.254543 [debug] [Thread-1 (]: On model.snowflake_instabee.stg_instabee_people: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.stg_instabee_people"} */
use warehouse pc_dbt_wh
[0m04:12:49.474529 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.219 seconds
[0m04:12:49.480645 [debug] [Thread-1 (]: Writing runtime sql for node "model.snowflake_instabee.stg_instabee_people"
[0m04:12:49.483644 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.stg_instabee_people"
[0m04:12:49.484643 [debug] [Thread-1 (]: On model.snowflake_instabee.stg_instabee_people: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.stg_instabee_people"} */
create or replace   view PC_DBT_DB.DBT_.stg_instabee_people
  
   as (
    with source as (

    select * from INSTABEE.PUBLIC.PEOPLE

)

select * from source
  );
[0m04:12:49.686486 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.200 seconds
[0m04:12:49.693559 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.stg_instabee_people"
[0m04:12:49.694573 [debug] [Thread-1 (]: On model.snowflake_instabee.stg_instabee_people: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.stg_instabee_people"} */
use warehouse COMPUTE_WH
[0m04:12:49.774212 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.078 seconds
[0m04:12:49.777275 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ade4bf3b-1381-44d5-986f-322e5f51b3df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D51EFCF1D0>]}
[0m04:12:49.779304 [info ] [Thread-1 (]: 4 of 15 OK created sql view model DBT_.stg_instabee_people ..................... [[32mSUCCESS 1[0m in 0.63s]
[0m04:12:49.781332 [debug] [Thread-1 (]: Finished running node model.snowflake_instabee.stg_instabee_people
[0m04:12:49.782346 [debug] [Thread-1 (]: Began running node model.snowflake_instabee.stg_instabee_returns
[0m04:12:49.783378 [info ] [Thread-1 (]: 5 of 15 START sql view model DBT_.stg_instabee_returns ......................... [RUN]
[0m04:12:49.784387 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.snowflake_instabee.stg_instabee_people, now model.snowflake_instabee.stg_instabee_returns)
[0m04:12:49.786888 [debug] [Thread-1 (]: Began compiling node model.snowflake_instabee.stg_instabee_returns
[0m04:12:49.799989 [debug] [Thread-1 (]: Writing injected SQL for node "model.snowflake_instabee.stg_instabee_returns"
[0m04:12:49.801992 [debug] [Thread-1 (]: Began executing node model.snowflake_instabee.stg_instabee_returns
[0m04:12:49.811483 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.stg_instabee_returns"
[0m04:12:49.813484 [debug] [Thread-1 (]: On model.snowflake_instabee.stg_instabee_returns: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.stg_instabee_returns"} */
select current_warehouse() as warehouse
[0m04:12:49.915694 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.100 seconds
[0m04:12:49.920061 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.stg_instabee_returns"
[0m04:12:49.921064 [debug] [Thread-1 (]: On model.snowflake_instabee.stg_instabee_returns: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.stg_instabee_returns"} */
use warehouse pc_dbt_wh
[0m04:12:50.013510 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.091 seconds
[0m04:12:50.030836 [debug] [Thread-1 (]: Writing runtime sql for node "model.snowflake_instabee.stg_instabee_returns"
[0m04:12:50.033845 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.stg_instabee_returns"
[0m04:12:50.036258 [debug] [Thread-1 (]: On model.snowflake_instabee.stg_instabee_returns: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.stg_instabee_returns"} */
create or replace   view PC_DBT_DB.DBT_.stg_instabee_returns
  
   as (
    WITH source AS (
    SELECT * FROM INSTABEE.PUBLIC.RETURNS
),

deduplicated AS (
    SELECT order_id, MAX(returned) AS returned
    FROM source
    GROUP BY order_id
)

SELECT * FROM deduplicated
  );
[0m04:12:50.380583 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.344 seconds
[0m04:12:50.384859 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.stg_instabee_returns"
[0m04:12:50.385869 [debug] [Thread-1 (]: On model.snowflake_instabee.stg_instabee_returns: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.stg_instabee_returns"} */
use warehouse COMPUTE_WH
[0m04:12:50.458719 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.072 seconds
[0m04:12:50.462310 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ade4bf3b-1381-44d5-986f-322e5f51b3df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D51F121B80>]}
[0m04:12:50.463312 [info ] [Thread-1 (]: 5 of 15 OK created sql view model DBT_.stg_instabee_returns .................... [[32mSUCCESS 1[0m in 0.68s]
[0m04:12:50.464428 [debug] [Thread-1 (]: Finished running node model.snowflake_instabee.stg_instabee_returns
[0m04:12:50.464428 [debug] [Thread-1 (]: Began running node model.snowflake_instabee.my_second_dbt_model
[0m04:12:50.465432 [info ] [Thread-1 (]: 6 of 15 START sql view model DBT_.my_second_dbt_model .......................... [RUN]
[0m04:12:50.466436 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.snowflake_instabee.stg_instabee_returns, now model.snowflake_instabee.my_second_dbt_model)
[0m04:12:50.467478 [debug] [Thread-1 (]: Began compiling node model.snowflake_instabee.my_second_dbt_model
[0m04:12:50.471071 [debug] [Thread-1 (]: Writing injected SQL for node "model.snowflake_instabee.my_second_dbt_model"
[0m04:12:50.472161 [debug] [Thread-1 (]: Began executing node model.snowflake_instabee.my_second_dbt_model
[0m04:12:50.477544 [debug] [Thread-1 (]: Writing runtime sql for node "model.snowflake_instabee.my_second_dbt_model"
[0m04:12:50.478546 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.my_second_dbt_model"
[0m04:12:50.479647 [debug] [Thread-1 (]: On model.snowflake_instabee.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.my_second_dbt_model"} */
create or replace   view PC_DBT_DB.DBT_.my_second_dbt_model
  
   as (
    -- Use the `ref` function to select from other models

select *
from PC_DBT_DB.DBT_.my_first_dbt_model
where id = 1
  );
[0m04:12:50.672524 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.192 seconds
[0m04:12:50.677551 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ade4bf3b-1381-44d5-986f-322e5f51b3df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D51F103EF0>]}
[0m04:12:50.678553 [info ] [Thread-1 (]: 6 of 15 OK created sql view model DBT_.my_second_dbt_model ..................... [[32mSUCCESS 1[0m in 0.21s]
[0m04:12:50.679734 [debug] [Thread-1 (]: Finished running node model.snowflake_instabee.my_second_dbt_model
[0m04:12:50.679734 [debug] [Thread-1 (]: Began running node model.snowflake_instabee.dim_customers
[0m04:12:50.680738 [info ] [Thread-1 (]: 7 of 15 SKIP relation DBT_.dim_customers ....................................... [[33mSKIP[0m]
[0m04:12:50.680738 [debug] [Thread-1 (]: Finished running node model.snowflake_instabee.dim_customers
[0m04:12:50.681830 [debug] [Thread-1 (]: Began running node model.snowflake_instabee.dim_products
[0m04:12:50.681830 [info ] [Thread-1 (]: 8 of 15 SKIP relation DBT_.dim_products ........................................ [[33mSKIP[0m]
[0m04:12:50.682832 [debug] [Thread-1 (]: Finished running node model.snowflake_instabee.dim_products
[0m04:12:50.682832 [debug] [Thread-1 (]: Began running node model.snowflake_instabee.dim_regions
[0m04:12:50.683933 [info ] [Thread-1 (]: 9 of 15 SKIP relation DBT_.dim_regions ......................................... [[33mSKIP[0m]
[0m04:12:50.683933 [debug] [Thread-1 (]: Finished running node model.snowflake_instabee.dim_regions
[0m04:12:50.685012 [debug] [Thread-1 (]: Began running node model.snowflake_instabee.fact_sales
[0m04:12:50.685012 [info ] [Thread-1 (]: 10 of 15 SKIP relation DBT_.fact_sales ......................................... [[33mSKIP[0m]
[0m04:12:50.686024 [debug] [Thread-1 (]: Finished running node model.snowflake_instabee.fact_sales
[0m04:12:50.687163 [debug] [Thread-1 (]: Began running node model.snowflake_instabee.month_on_month_change
[0m04:12:50.688328 [info ] [Thread-1 (]: 11 of 15 SKIP relation DBT_.month_on_month_change .............................. [[33mSKIP[0m]
[0m04:12:50.689502 [debug] [Thread-1 (]: Finished running node model.snowflake_instabee.month_on_month_change
[0m04:12:50.690511 [debug] [Thread-1 (]: Began running node model.snowflake_instabee.monthly_returns_per_category
[0m04:12:50.691594 [info ] [Thread-1 (]: 12 of 15 SKIP relation DBT_.monthly_returns_per_category ....................... [[33mSKIP[0m]
[0m04:12:50.691594 [debug] [Thread-1 (]: Finished running node model.snowflake_instabee.monthly_returns_per_category
[0m04:12:50.692594 [debug] [Thread-1 (]: Began running node model.snowflake_instabee.sales_growth_per_category
[0m04:12:50.693594 [info ] [Thread-1 (]: 13 of 15 SKIP relation DBT_.sales_growth_per_category .......................... [[33mSKIP[0m]
[0m04:12:50.694783 [debug] [Thread-1 (]: Finished running node model.snowflake_instabee.sales_growth_per_category
[0m04:12:50.694783 [debug] [Thread-1 (]: Began running node model.snowflake_instabee.sales_over_time
[0m04:12:50.695783 [info ] [Thread-1 (]: 14 of 15 SKIP relation DBT_.sales_over_time .................................... [[33mSKIP[0m]
[0m04:12:50.695783 [debug] [Thread-1 (]: Finished running node model.snowflake_instabee.sales_over_time
[0m04:12:50.697087 [debug] [Thread-1 (]: Began running node model.snowflake_instabee.top_selling_states_and_regions
[0m04:12:50.698086 [info ] [Thread-1 (]: 15 of 15 SKIP relation DBT_.top_selling_states_and_regions ..................... [[33mSKIP[0m]
[0m04:12:50.698086 [debug] [Thread-1 (]: Finished running node model.snowflake_instabee.top_selling_states_and_regions
[0m04:12:50.700246 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:12:50.700246 [debug] [MainThread]: Connection 'list_PC_DBT_DB' was left open.
[0m04:12:50.701255 [debug] [MainThread]: On list_PC_DBT_DB: Close
[0m04:12:50.808952 [debug] [MainThread]: Connection 'list_PC_DBT_DB_DBT_' was left open.
[0m04:12:50.809954 [debug] [MainThread]: On list_PC_DBT_DB_DBT_: Close
[0m04:12:50.917221 [debug] [MainThread]: Connection 'model.snowflake_instabee.my_second_dbt_model' was left open.
[0m04:12:50.918222 [debug] [MainThread]: On model.snowflake_instabee.my_second_dbt_model: Close
[0m04:12:51.025675 [info ] [MainThread]: 
[0m04:12:51.026676 [info ] [MainThread]: Finished running 10 table models, 5 view models in 0 hours 0 minutes and 4.70 seconds (4.70s).
[0m04:12:51.029676 [debug] [MainThread]: Command end result
[0m04:12:51.089080 [debug] [MainThread]: Wrote artifact WritableManifest to E:\desk\onedrive\Desktop\snowflake_instabee\target\manifest.json
[0m04:12:51.092421 [debug] [MainThread]: Wrote artifact SemanticManifest to E:\desk\onedrive\Desktop\snowflake_instabee\target\semantic_manifest.json
[0m04:12:51.100690 [debug] [MainThread]: Wrote artifact RunExecutionResult to E:\desk\onedrive\Desktop\snowflake_instabee\target\run_results.json
[0m04:12:51.101931 [info ] [MainThread]: 
[0m04:12:51.103236 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m04:12:51.104256 [info ] [MainThread]: 
[0m04:12:51.107116 [error] [MainThread]:   Database Error in model generate_surrogate_key (models\macros\generate_surrogate_key.sql)
  001003 (42000): SQL compilation error:
  syntax error line 5 at position 2 unexpected ')'.
  compiled code at target\run\snowflake_instabee\models\macros\generate_surrogate_key.sql
[0m04:12:51.107116 [info ] [MainThread]: 
[0m04:12:51.108251 [error] [MainThread]:   Compilation Error in model stg_instabee_orders (models\staging\instabee\stg_instabee_orders.sql)
  'generate_surrogate_key' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m04:12:51.108251 [info ] [MainThread]: 
[0m04:12:51.109251 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=2 SKIP=9 TOTAL=15
[0m04:12:51.110252 [debug] [MainThread]: Command `dbt run` failed at 04:12:51.110252 after 8.24 seconds
[0m04:12:51.110252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D514ACD970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D51E5CCA40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D5144A9760>]}
[0m04:12:51.111252 [debug] [MainThread]: Flushing usage events
[0m04:12:51.660108 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m04:14:20.250473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001892B0E2CF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018927E2D0D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018927E51850>]}


============================== 04:14:20.256528 | d1b7b4f1-993b-48df-a2a6-cbbbfe5cbfa8 ==============================
[0m04:14:20.256528 [info ] [MainThread]: Running with dbt=1.9.4
[0m04:14:20.257535 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Venee\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'E:\\desk\\onedrive\\Desktop\\snowflake_instabee\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --select stg_instabee_orders', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m04:14:21.514959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd1b7b4f1-993b-48df-a2a6-cbbbfe5cbfa8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018935229580>]}
[0m04:14:21.605267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd1b7b4f1-993b-48df-a2a6-cbbbfe5cbfa8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000189353131A0>]}
[0m04:14:21.606274 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m04:14:22.422010 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m04:14:22.726629 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m04:14:22.727485 [debug] [MainThread]: Partial parsing: updated file: snowflake_instabee://models\staging\instabee\stg_instabee_orders.sql
[0m04:14:23.180810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd1b7b4f1-993b-48df-a2a6-cbbbfe5cbfa8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018935A0A060>]}
[0m04:14:23.327143 [debug] [MainThread]: Wrote artifact WritableManifest to E:\desk\onedrive\Desktop\snowflake_instabee\target\manifest.json
[0m04:14:23.334961 [debug] [MainThread]: Wrote artifact SemanticManifest to E:\desk\onedrive\Desktop\snowflake_instabee\target\semantic_manifest.json
[0m04:14:23.368602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd1b7b4f1-993b-48df-a2a6-cbbbfe5cbfa8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018935AFBAD0>]}
[0m04:14:23.370103 [info ] [MainThread]: Found 15 models, 17 data tests, 3 sources, 590 macros
[0m04:14:23.370103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd1b7b4f1-993b-48df-a2a6-cbbbfe5cbfa8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001893599F2C0>]}
[0m04:14:23.372131 [info ] [MainThread]: 
[0m04:14:23.373291 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:14:23.373291 [info ] [MainThread]: 
[0m04:14:23.374294 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m04:14:23.376301 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PC_DBT_DB'
[0m04:14:23.527118 [debug] [ThreadPool]: Using snowflake connection "list_PC_DBT_DB"
[0m04:14:23.529283 [debug] [ThreadPool]: On list_PC_DBT_DB: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "connection_name": "list_PC_DBT_DB"} */
show terse schemas in database PC_DBT_DB
    limit 10000
[0m04:14:23.530286 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:14:24.143421 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.612 seconds
[0m04:14:24.153476 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PC_DBT_DB_DBT_'
[0m04:14:24.171004 [debug] [ThreadPool]: Using snowflake connection "list_PC_DBT_DB_DBT_"
[0m04:14:24.172009 [debug] [ThreadPool]: On list_PC_DBT_DB_DBT_: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "connection_name": "list_PC_DBT_DB_DBT_"} */
show objects in PC_DBT_DB.DBT_ limit 10000;
[0m04:14:24.172009 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:14:24.652311 [debug] [ThreadPool]: SQL status: SUCCESS 16 in 0.480 seconds
[0m04:14:24.660992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd1b7b4f1-993b-48df-a2a6-cbbbfe5cbfa8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018935E26000>]}
[0m04:14:24.666116 [debug] [Thread-1 (]: Began running node model.snowflake_instabee.stg_instabee_orders
[0m04:14:24.668407 [info ] [Thread-1 (]: 1 of 1 START sql view model DBT_.stg_instabee_orders ........................... [RUN]
[0m04:14:24.669416 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.snowflake_instabee.stg_instabee_orders'
[0m04:14:24.669416 [debug] [Thread-1 (]: Began compiling node model.snowflake_instabee.stg_instabee_orders
[0m04:14:24.685565 [debug] [Thread-1 (]: Writing injected SQL for node "model.snowflake_instabee.stg_instabee_orders"
[0m04:14:24.686567 [debug] [Thread-1 (]: Began executing node model.snowflake_instabee.stg_instabee_orders
[0m04:14:24.691015 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.stg_instabee_orders"
[0m04:14:24.692019 [debug] [Thread-1 (]: On model.snowflake_instabee.stg_instabee_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.stg_instabee_orders"} */
select current_warehouse() as warehouse
[0m04:14:24.692019 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m04:14:25.155037 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.463 seconds
[0m04:14:25.158141 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.stg_instabee_orders"
[0m04:14:25.159141 [debug] [Thread-1 (]: On model.snowflake_instabee.stg_instabee_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.stg_instabee_orders"} */
use warehouse pc_dbt_wh
[0m04:14:25.245652 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.086 seconds
[0m04:14:25.295435 [debug] [Thread-1 (]: Writing runtime sql for node "model.snowflake_instabee.stg_instabee_orders"
[0m04:14:25.298083 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.stg_instabee_orders"
[0m04:14:25.299295 [debug] [Thread-1 (]: On model.snowflake_instabee.stg_instabee_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.stg_instabee_orders"} */
create or replace   view PC_DBT_DB.DBT_.stg_instabee_orders
  
   as (
    with source as (

    select * from INSTABEE.PUBLIC.ORDERS

),

renamed as (

    select 
md5(cast(coalesce(cast(ORDER_ID as TEXT), '') || '-' || coalesce(cast(PRODUCT_ID as TEXT), '') || '-' || coalesce(cast(ROW_ID as TEXT), '') as TEXT)) as ORDER_LINE_ID,
ROW_ID,
ORDER_ID,	
ORDERDATE AS ORDER_DATE,
SHIPDATE AS SHIP_DATE,	
SHIP_MODE,	
CUSTOMER_ID,	
CUSTOMER_NAME,	
SEGMENT,
COUNTRY,
CITY,
STATE,	
POSTAL_CODE,	
REGION,	
PRODUCT_ID,	
CATEGORY as PRODUCT_CATEGORY,	
SUB_CATEGORY,	
PRODUCT_NAME,	
SALES,	
QUANTITY,	
DISCOUNT,	
PROFIT


    from source

)

select * from renamed
  );
[0m04:14:25.688278 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.388 seconds
[0m04:14:25.721174 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.stg_instabee_orders"
[0m04:14:25.722179 [debug] [Thread-1 (]: On model.snowflake_instabee.stg_instabee_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.stg_instabee_orders"} */
use warehouse COMPUTE_WH
[0m04:14:25.807318 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.084 seconds
[0m04:14:25.814057 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1b7b4f1-993b-48df-a2a6-cbbbfe5cbfa8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001892B0AADB0>]}
[0m04:14:25.815117 [info ] [Thread-1 (]: 1 of 1 OK created sql view model DBT_.stg_instabee_orders ...................... [[32mSUCCESS 1[0m in 1.14s]
[0m04:14:25.816261 [debug] [Thread-1 (]: Finished running node model.snowflake_instabee.stg_instabee_orders
[0m04:14:25.817588 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:14:25.818674 [debug] [MainThread]: Connection 'list_PC_DBT_DB' was left open.
[0m04:14:25.818674 [debug] [MainThread]: On list_PC_DBT_DB: Close
[0m04:14:25.932068 [debug] [MainThread]: Connection 'list_PC_DBT_DB_DBT_' was left open.
[0m04:14:25.933075 [debug] [MainThread]: On list_PC_DBT_DB_DBT_: Close
[0m04:14:26.039502 [debug] [MainThread]: Connection 'model.snowflake_instabee.stg_instabee_orders' was left open.
[0m04:14:26.039502 [debug] [MainThread]: On model.snowflake_instabee.stg_instabee_orders: Close
[0m04:14:26.153429 [info ] [MainThread]: 
[0m04:14:26.154432 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.78 seconds (2.78s).
[0m04:14:26.155429 [debug] [MainThread]: Command end result
[0m04:14:26.213652 [debug] [MainThread]: Wrote artifact WritableManifest to E:\desk\onedrive\Desktop\snowflake_instabee\target\manifest.json
[0m04:14:26.217178 [debug] [MainThread]: Wrote artifact SemanticManifest to E:\desk\onedrive\Desktop\snowflake_instabee\target\semantic_manifest.json
[0m04:14:26.224517 [debug] [MainThread]: Wrote artifact RunExecutionResult to E:\desk\onedrive\Desktop\snowflake_instabee\target\run_results.json
[0m04:14:26.225925 [info ] [MainThread]: 
[0m04:14:26.225925 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:14:26.228434 [info ] [MainThread]: 
[0m04:14:26.229459 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m04:14:26.231406 [debug] [MainThread]: Command `dbt run` succeeded at 04:14:26.230214 after 6.30 seconds
[0m04:14:26.231406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001892B9CD310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001892B5EE780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018935750710>]}
[0m04:14:26.232407 [debug] [MainThread]: Flushing usage events
[0m04:14:26.705884 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m04:15:11.380169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021155694AD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002115A6A6600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002115A0F73B0>]}


============================== 04:15:11.386682 | 95e16ac4-558a-492c-a852-235f616699af ==============================
[0m04:15:11.386682 [info ] [MainThread]: Running with dbt=1.9.4
[0m04:15:11.387725 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\Venee\\.dbt', 'log_path': 'E:\\desk\\onedrive\\Desktop\\snowflake_instabee\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --select generate_surrogate_key', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m04:15:12.668887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '95e16ac4-558a-492c-a852-235f616699af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002115A944410>]}
[0m04:15:12.763850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '95e16ac4-558a-492c-a852-235f616699af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021161201D60>]}
[0m04:15:12.764857 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m04:15:13.558431 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m04:15:13.880796 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:15:13.881803 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:15:13.957270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '95e16ac4-558a-492c-a852-235f616699af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211632AB350>]}
[0m04:15:14.109521 [debug] [MainThread]: Wrote artifact WritableManifest to E:\desk\onedrive\Desktop\snowflake_instabee\target\manifest.json
[0m04:15:14.115774 [debug] [MainThread]: Wrote artifact SemanticManifest to E:\desk\onedrive\Desktop\snowflake_instabee\target\semantic_manifest.json
[0m04:15:14.153224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '95e16ac4-558a-492c-a852-235f616699af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021163705E20>]}
[0m04:15:14.154036 [info ] [MainThread]: Found 15 models, 17 data tests, 3 sources, 590 macros
[0m04:15:14.155387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '95e16ac4-558a-492c-a852-235f616699af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002116353C590>]}
[0m04:15:14.158721 [info ] [MainThread]: 
[0m04:15:14.158721 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:15:14.160057 [info ] [MainThread]: 
[0m04:15:14.160057 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m04:15:14.162166 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PC_DBT_DB'
[0m04:15:14.306406 [debug] [ThreadPool]: Using snowflake connection "list_PC_DBT_DB"
[0m04:15:14.307408 [debug] [ThreadPool]: On list_PC_DBT_DB: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "connection_name": "list_PC_DBT_DB"} */
show terse schemas in database PC_DBT_DB
    limit 10000
[0m04:15:14.307408 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:15:14.955921 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.648 seconds
[0m04:15:14.967569 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PC_DBT_DB_DBT_'
[0m04:15:14.983543 [debug] [ThreadPool]: Using snowflake connection "list_PC_DBT_DB_DBT_"
[0m04:15:14.983543 [debug] [ThreadPool]: On list_PC_DBT_DB_DBT_: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "connection_name": "list_PC_DBT_DB_DBT_"} */
show objects in PC_DBT_DB.DBT_ limit 10000;
[0m04:15:14.984545 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:15:15.342554 [debug] [ThreadPool]: SQL status: SUCCESS 16 in 0.358 seconds
[0m04:15:15.349598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '95e16ac4-558a-492c-a852-235f616699af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021161C50F50>]}
[0m04:15:15.356668 [debug] [Thread-1 (]: Began running node model.snowflake_instabee.generate_surrogate_key
[0m04:15:15.358809 [info ] [Thread-1 (]: 1 of 1 START sql view model DBT_.generate_surrogate_key ........................ [RUN]
[0m04:15:15.359818 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.snowflake_instabee.generate_surrogate_key'
[0m04:15:15.359818 [debug] [Thread-1 (]: Began compiling node model.snowflake_instabee.generate_surrogate_key
[0m04:15:15.377676 [debug] [Thread-1 (]: Writing injected SQL for node "model.snowflake_instabee.generate_surrogate_key"
[0m04:15:15.378677 [debug] [Thread-1 (]: Began executing node model.snowflake_instabee.generate_surrogate_key
[0m04:15:15.431474 [debug] [Thread-1 (]: Writing runtime sql for node "model.snowflake_instabee.generate_surrogate_key"
[0m04:15:15.433474 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.generate_surrogate_key"
[0m04:15:15.434476 [debug] [Thread-1 (]: On model.snowflake_instabee.generate_surrogate_key: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.generate_surrogate_key"} */
create or replace   view PC_DBT_DB.DBT_.generate_surrogate_key
  
   as (
    
  );
[0m04:15:15.435475 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m04:15:15.925382 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bbd3e3-0001-b465-0002-47d20007a0b6
[0m04:15:15.926384 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 5 at position 2 unexpected ')'.
[0m04:15:15.932395 [debug] [Thread-1 (]: Database Error in model generate_surrogate_key (models\macros\generate_surrogate_key.sql)
  001003 (42000): SQL compilation error:
  syntax error line 5 at position 2 unexpected ')'.
  compiled code at target\run\snowflake_instabee\models\macros\generate_surrogate_key.sql
[0m04:15:15.935401 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '95e16ac4-558a-492c-a852-235f616699af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021157DAA990>]}
[0m04:15:15.936707 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model DBT_.generate_surrogate_key ............... [[31mERROR[0m in 0.57s]
[0m04:15:15.937710 [debug] [Thread-1 (]: Finished running node model.snowflake_instabee.generate_surrogate_key
[0m04:15:15.939791 [debug] [Thread-4 (]: Marking all children of 'model.snowflake_instabee.generate_surrogate_key' to be skipped because of status 'error'.  Reason: Database Error in model generate_surrogate_key (models\macros\generate_surrogate_key.sql)
  001003 (42000): SQL compilation error:
  syntax error line 5 at position 2 unexpected ')'.
  compiled code at target\run\snowflake_instabee\models\macros\generate_surrogate_key.sql.
[0m04:15:15.942526 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:15:15.942526 [debug] [MainThread]: Connection 'list_PC_DBT_DB' was left open.
[0m04:15:15.942526 [debug] [MainThread]: On list_PC_DBT_DB: Close
[0m04:15:16.057559 [debug] [MainThread]: Connection 'list_PC_DBT_DB_DBT_' was left open.
[0m04:15:16.058715 [debug] [MainThread]: On list_PC_DBT_DB_DBT_: Close
[0m04:15:16.209230 [debug] [MainThread]: Connection 'model.snowflake_instabee.generate_surrogate_key' was left open.
[0m04:15:16.209230 [debug] [MainThread]: On model.snowflake_instabee.generate_surrogate_key: Close
[0m04:15:16.315487 [info ] [MainThread]: 
[0m04:15:16.315487 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.16 seconds (2.16s).
[0m04:15:16.317958 [debug] [MainThread]: Command end result
[0m04:15:16.371909 [debug] [MainThread]: Wrote artifact WritableManifest to E:\desk\onedrive\Desktop\snowflake_instabee\target\manifest.json
[0m04:15:16.375123 [debug] [MainThread]: Wrote artifact SemanticManifest to E:\desk\onedrive\Desktop\snowflake_instabee\target\semantic_manifest.json
[0m04:15:16.382521 [debug] [MainThread]: Wrote artifact RunExecutionResult to E:\desk\onedrive\Desktop\snowflake_instabee\target\run_results.json
[0m04:15:16.382521 [info ] [MainThread]: 
[0m04:15:16.383585 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m04:15:16.383585 [info ] [MainThread]: 
[0m04:15:16.384845 [error] [MainThread]:   Database Error in model generate_surrogate_key (models\macros\generate_surrogate_key.sql)
  001003 (42000): SQL compilation error:
  syntax error line 5 at position 2 unexpected ')'.
  compiled code at target\run\snowflake_instabee\models\macros\generate_surrogate_key.sql
[0m04:15:16.384845 [info ] [MainThread]: 
[0m04:15:16.385855 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m04:15:16.388052 [debug] [MainThread]: Command `dbt run` failed at 04:15:16.388052 after 5.18 seconds
[0m04:15:16.389187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021155694AD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211576ABDA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211576A9220>]}
[0m04:15:16.390189 [debug] [MainThread]: Flushing usage events
[0m04:15:16.837210 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m04:20:29.504325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B5C1BFD6A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B5C75EED20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B5C75EF1A0>]}


============================== 04:20:29.510563 | e9c683af-1958-4e01-9d89-6fa040683d2c ==============================
[0m04:20:29.510563 [info ] [MainThread]: Running with dbt=1.9.4
[0m04:20:29.512755 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'E:\\desk\\onedrive\\Desktop\\snowflake_instabee\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\Venee\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m04:20:29.747252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e9c683af-1958-4e01-9d89-6fa040683d2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B5C766E150>]}
[0m04:20:29.782333 [debug] [MainThread]: Set downloads directory='C:\Users\Venee\AppData\Local\Temp\dbt-downloads-qgxv8xfh'
[0m04:20:29.783694 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m04:20:29.853318 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m04:20:29.854328 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m04:20:29.887839 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m04:20:29.905455 [info ] [MainThread]: Updating lock file in file path: E:\desk\onedrive\Desktop\snowflake_instabee/package-lock.yml
[0m04:20:30.067656 [debug] [MainThread]: Set downloads directory='C:\Users\Venee\AppData\Local\Temp\dbt-downloads-_78owjk7'
[0m04:20:30.072748 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m04:20:30.588814 [info ] [MainThread]: Installed from version 1.3.0
[0m04:20:30.589815 [info ] [MainThread]: Up to date!
[0m04:20:30.590814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'e9c683af-1958-4e01-9d89-6fa040683d2c', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B5C7163110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B5C766FE30>]}
[0m04:20:30.593328 [debug] [MainThread]: Command `dbt deps` succeeded at 04:20:30.593328 after 1.34 seconds
[0m04:20:30.594264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B5C7612D50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B5C5825850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B5C7782E10>]}
[0m04:20:30.594264 [debug] [MainThread]: Flushing usage events
[0m04:20:31.123802 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m04:20:57.335151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001358A65EE70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001358A261940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001358A261430>]}


============================== 04:20:57.340739 | 6078f521-51ef-4411-bbfc-d2ce3eaaa47e ==============================
[0m04:20:57.340739 [info ] [MainThread]: Running with dbt=1.9.4
[0m04:20:57.342147 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Venee\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'E:\\desk\\onedrive\\Desktop\\snowflake_instabee\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m04:20:58.583633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6078f521-51ef-4411-bbfc-d2ce3eaaa47e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001358AB655E0>]}
[0m04:20:58.665881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6078f521-51ef-4411-bbfc-d2ce3eaaa47e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013594283560>]}
[0m04:20:58.666883 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m04:20:59.473688 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m04:20:59.859106 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
[0m04:20:59.859106 [debug] [MainThread]: Partial parsing: added file: snowflake_instabee://macros\generate_surrogate_key.sql
[0m04:20:59.860110 [debug] [MainThread]: Partial parsing: deleted file: snowflake_instabee://models\macros\generate_surrogate_key.sql
[0m04:21:00.006043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6078f521-51ef-4411-bbfc-d2ce3eaaa47e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000135943D4AD0>]}
[0m04:21:00.153591 [debug] [MainThread]: Wrote artifact WritableManifest to E:\desk\onedrive\Desktop\snowflake_instabee\target\manifest.json
[0m04:21:00.159209 [debug] [MainThread]: Wrote artifact SemanticManifest to E:\desk\onedrive\Desktop\snowflake_instabee\target\semantic_manifest.json
[0m04:21:00.197564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6078f521-51ef-4411-bbfc-d2ce3eaaa47e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013594989A00>]}
[0m04:21:00.198577 [info ] [MainThread]: Found 14 models, 17 data tests, 3 sources, 591 macros
[0m04:21:00.200413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6078f521-51ef-4411-bbfc-d2ce3eaaa47e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000135944C0BF0>]}
[0m04:21:00.204657 [info ] [MainThread]: 
[0m04:21:00.204657 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:21:00.205664 [info ] [MainThread]: 
[0m04:21:00.206670 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m04:21:00.216601 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PC_DBT_DB'
[0m04:21:00.365477 [debug] [ThreadPool]: Using snowflake connection "list_PC_DBT_DB"
[0m04:21:00.366492 [debug] [ThreadPool]: On list_PC_DBT_DB: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "connection_name": "list_PC_DBT_DB"} */
show terse schemas in database PC_DBT_DB
    limit 10000
[0m04:21:00.367505 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:21:00.975620 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.608 seconds
[0m04:21:00.982844 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PC_DBT_DB_DBT_'
[0m04:21:01.003758 [debug] [ThreadPool]: Using snowflake connection "list_PC_DBT_DB_DBT_"
[0m04:21:01.004759 [debug] [ThreadPool]: On list_PC_DBT_DB_DBT_: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "connection_name": "list_PC_DBT_DB_DBT_"} */
show objects in PC_DBT_DB.DBT_ limit 10000;
[0m04:21:01.005760 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:21:01.487691 [debug] [ThreadPool]: SQL status: SUCCESS 16 in 0.482 seconds
[0m04:21:01.495800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6078f521-51ef-4411-bbfc-d2ce3eaaa47e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001359497C050>]}
[0m04:21:01.503675 [debug] [Thread-1 (]: Began running node model.snowflake_instabee.my_first_dbt_model
[0m04:21:01.504735 [info ] [Thread-1 (]: 1 of 14 START sql table model DBT_.my_first_dbt_model .......................... [RUN]
[0m04:21:01.504735 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.snowflake_instabee.my_first_dbt_model'
[0m04:21:01.505903 [debug] [Thread-1 (]: Began compiling node model.snowflake_instabee.my_first_dbt_model
[0m04:21:01.518687 [debug] [Thread-1 (]: Writing injected SQL for node "model.snowflake_instabee.my_first_dbt_model"
[0m04:21:01.519690 [debug] [Thread-1 (]: Began executing node model.snowflake_instabee.my_first_dbt_model
[0m04:21:01.572454 [debug] [Thread-1 (]: Writing runtime sql for node "model.snowflake_instabee.my_first_dbt_model"
[0m04:21:01.574465 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.my_first_dbt_model"
[0m04:21:01.575771 [debug] [Thread-1 (]: On model.snowflake_instabee.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.my_first_dbt_model"} */
create or replace transient table PC_DBT_DB.DBT_.my_first_dbt_model
         as
        (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (
    select 1 as id, 'Example record 1' as description
    union all
    select 2 as id, 'Example record 2' as description
)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
        );
[0m04:21:01.575771 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m04:21:02.625819 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.049 seconds
[0m04:21:02.661938 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6078f521-51ef-4411-bbfc-d2ce3eaaa47e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013588024CB0>]}
[0m04:21:02.663006 [info ] [Thread-1 (]: 1 of 14 OK created sql table model DBT_.my_first_dbt_model ..................... [[32mSUCCESS 1[0m in 1.15s]
[0m04:21:02.666057 [debug] [Thread-1 (]: Finished running node model.snowflake_instabee.my_first_dbt_model
[0m04:21:02.666057 [debug] [Thread-1 (]: Began running node model.snowflake_instabee.stg_instabee_orders
[0m04:21:02.667264 [info ] [Thread-1 (]: 2 of 14 START sql view model DBT_.stg_instabee_orders .......................... [RUN]
[0m04:21:02.667264 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.snowflake_instabee.my_first_dbt_model, now model.snowflake_instabee.stg_instabee_orders)
[0m04:21:02.668637 [debug] [Thread-1 (]: Began compiling node model.snowflake_instabee.stg_instabee_orders
[0m04:21:02.689856 [debug] [Thread-1 (]: Writing injected SQL for node "model.snowflake_instabee.stg_instabee_orders"
[0m04:21:02.690857 [debug] [Thread-1 (]: Began executing node model.snowflake_instabee.stg_instabee_orders
[0m04:21:02.694170 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.stg_instabee_orders"
[0m04:21:02.695582 [debug] [Thread-1 (]: On model.snowflake_instabee.stg_instabee_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.stg_instabee_orders"} */
select current_warehouse() as warehouse
[0m04:21:02.773474 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.078 seconds
[0m04:21:02.776489 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.stg_instabee_orders"
[0m04:21:02.777490 [debug] [Thread-1 (]: On model.snowflake_instabee.stg_instabee_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.stg_instabee_orders"} */
use warehouse pc_dbt_wh
[0m04:21:02.866272 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.088 seconds
[0m04:21:02.901727 [debug] [Thread-1 (]: Writing runtime sql for node "model.snowflake_instabee.stg_instabee_orders"
[0m04:21:02.904208 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.stg_instabee_orders"
[0m04:21:02.905582 [debug] [Thread-1 (]: On model.snowflake_instabee.stg_instabee_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.stg_instabee_orders"} */
create or replace   view PC_DBT_DB.DBT_.stg_instabee_orders
  
   as (
    with source as (

    select * from INSTABEE.PUBLIC.ORDERS

),

renamed as (

    select 
md5(cast(coalesce(cast(ORDER_ID as TEXT), '') || '-' || coalesce(cast(PRODUCT_ID as TEXT), '') || '-' || coalesce(cast(ROW_ID as TEXT), '') as TEXT)) as ORDER_LINE_ID,
ROW_ID,
ORDER_ID,	
ORDERDATE AS ORDER_DATE,
SHIPDATE AS SHIP_DATE,	
SHIP_MODE,	
CUSTOMER_ID,	
CUSTOMER_NAME,	
SEGMENT,
COUNTRY,
CITY,
STATE,	
POSTAL_CODE,	
REGION,	
PRODUCT_ID,	
CATEGORY as PRODUCT_CATEGORY,	
SUB_CATEGORY,	
PRODUCT_NAME,	
SALES,	
QUANTITY,	
DISCOUNT,	
PROFIT


    from source

)

select * from renamed
  );
[0m04:21:03.193262 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.287 seconds
[0m04:21:03.197510 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.stg_instabee_orders"
[0m04:21:03.197510 [debug] [Thread-1 (]: On model.snowflake_instabee.stg_instabee_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.stg_instabee_orders"} */
use warehouse COMPUTE_WH
[0m04:21:03.297651 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.098 seconds
[0m04:21:03.300251 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6078f521-51ef-4411-bbfc-d2ce3eaaa47e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013594D93B90>]}
[0m04:21:03.301258 [info ] [Thread-1 (]: 2 of 14 OK created sql view model DBT_.stg_instabee_orders ..................... [[32mSUCCESS 1[0m in 0.63s]
[0m04:21:03.302267 [debug] [Thread-1 (]: Finished running node model.snowflake_instabee.stg_instabee_orders
[0m04:21:03.302267 [debug] [Thread-1 (]: Began running node model.snowflake_instabee.stg_instabee_people
[0m04:21:03.303274 [info ] [Thread-1 (]: 3 of 14 START sql view model DBT_.stg_instabee_people .......................... [RUN]
[0m04:21:03.304293 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.snowflake_instabee.stg_instabee_orders, now model.snowflake_instabee.stg_instabee_people)
[0m04:21:03.305302 [debug] [Thread-1 (]: Began compiling node model.snowflake_instabee.stg_instabee_people
[0m04:21:03.309302 [debug] [Thread-1 (]: Writing injected SQL for node "model.snowflake_instabee.stg_instabee_people"
[0m04:21:03.310302 [debug] [Thread-1 (]: Began executing node model.snowflake_instabee.stg_instabee_people
[0m04:21:03.314866 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.stg_instabee_people"
[0m04:21:03.316185 [debug] [Thread-1 (]: On model.snowflake_instabee.stg_instabee_people: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.stg_instabee_people"} */
select current_warehouse() as warehouse
[0m04:21:03.455175 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.139 seconds
[0m04:21:03.458174 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.stg_instabee_people"
[0m04:21:03.459174 [debug] [Thread-1 (]: On model.snowflake_instabee.stg_instabee_people: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.stg_instabee_people"} */
use warehouse pc_dbt_wh
[0m04:21:03.551515 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.092 seconds
[0m04:21:03.554538 [debug] [Thread-1 (]: Writing runtime sql for node "model.snowflake_instabee.stg_instabee_people"
[0m04:21:03.556552 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.stg_instabee_people"
[0m04:21:03.557584 [debug] [Thread-1 (]: On model.snowflake_instabee.stg_instabee_people: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.stg_instabee_people"} */
create or replace   view PC_DBT_DB.DBT_.stg_instabee_people
  
   as (
    with source as (

    select * from INSTABEE.PUBLIC.PEOPLE

)

select * from source
  );
[0m04:21:03.736944 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.179 seconds
[0m04:21:03.739980 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.stg_instabee_people"
[0m04:21:03.739980 [debug] [Thread-1 (]: On model.snowflake_instabee.stg_instabee_people: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.stg_instabee_people"} */
use warehouse COMPUTE_WH
[0m04:21:03.884852 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.144 seconds
[0m04:21:03.887095 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6078f521-51ef-4411-bbfc-d2ce3eaaa47e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013594DDCBF0>]}
[0m04:21:03.888097 [info ] [Thread-1 (]: 3 of 14 OK created sql view model DBT_.stg_instabee_people ..................... [[32mSUCCESS 1[0m in 0.58s]
[0m04:21:03.889574 [debug] [Thread-1 (]: Finished running node model.snowflake_instabee.stg_instabee_people
[0m04:21:03.889574 [debug] [Thread-1 (]: Began running node model.snowflake_instabee.stg_instabee_returns
[0m04:21:03.890695 [info ] [Thread-1 (]: 4 of 14 START sql view model DBT_.stg_instabee_returns ......................... [RUN]
[0m04:21:03.891798 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.snowflake_instabee.stg_instabee_people, now model.snowflake_instabee.stg_instabee_returns)
[0m04:21:03.891798 [debug] [Thread-1 (]: Began compiling node model.snowflake_instabee.stg_instabee_returns
[0m04:21:03.897987 [debug] [Thread-1 (]: Writing injected SQL for node "model.snowflake_instabee.stg_instabee_returns"
[0m04:21:03.899358 [debug] [Thread-1 (]: Began executing node model.snowflake_instabee.stg_instabee_returns
[0m04:21:03.901826 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.stg_instabee_returns"
[0m04:21:03.902828 [debug] [Thread-1 (]: On model.snowflake_instabee.stg_instabee_returns: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.stg_instabee_returns"} */
select current_warehouse() as warehouse
[0m04:21:03.976094 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.073 seconds
[0m04:21:03.981475 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.stg_instabee_returns"
[0m04:21:03.982458 [debug] [Thread-1 (]: On model.snowflake_instabee.stg_instabee_returns: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.stg_instabee_returns"} */
use warehouse pc_dbt_wh
[0m04:21:04.061317 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.078 seconds
[0m04:21:04.064500 [debug] [Thread-1 (]: Writing runtime sql for node "model.snowflake_instabee.stg_instabee_returns"
[0m04:21:04.066146 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.stg_instabee_returns"
[0m04:21:04.067590 [debug] [Thread-1 (]: On model.snowflake_instabee.stg_instabee_returns: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.stg_instabee_returns"} */
create or replace   view PC_DBT_DB.DBT_.stg_instabee_returns
  
   as (
    WITH source AS (
    SELECT * FROM INSTABEE.PUBLIC.RETURNS
),

deduplicated AS (
    SELECT order_id, MAX(returned) AS returned
    FROM source
    GROUP BY order_id
)

SELECT * FROM deduplicated
  );
[0m04:21:04.259153 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.191 seconds
[0m04:21:04.261239 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.stg_instabee_returns"
[0m04:21:04.262381 [debug] [Thread-1 (]: On model.snowflake_instabee.stg_instabee_returns: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.stg_instabee_returns"} */
use warehouse COMPUTE_WH
[0m04:21:04.346175 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.083 seconds
[0m04:21:04.348446 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6078f521-51ef-4411-bbfc-d2ce3eaaa47e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013594DDDD60>]}
[0m04:21:04.349447 [info ] [Thread-1 (]: 4 of 14 OK created sql view model DBT_.stg_instabee_returns .................... [[32mSUCCESS 1[0m in 0.46s]
[0m04:21:04.350448 [debug] [Thread-1 (]: Finished running node model.snowflake_instabee.stg_instabee_returns
[0m04:21:04.351705 [debug] [Thread-1 (]: Began running node model.snowflake_instabee.my_second_dbt_model
[0m04:21:04.352775 [info ] [Thread-1 (]: 5 of 14 START sql view model DBT_.my_second_dbt_model .......................... [RUN]
[0m04:21:04.352775 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.snowflake_instabee.stg_instabee_returns, now model.snowflake_instabee.my_second_dbt_model)
[0m04:21:04.354115 [debug] [Thread-1 (]: Began compiling node model.snowflake_instabee.my_second_dbt_model
[0m04:21:04.358123 [debug] [Thread-1 (]: Writing injected SQL for node "model.snowflake_instabee.my_second_dbt_model"
[0m04:21:04.359124 [debug] [Thread-1 (]: Began executing node model.snowflake_instabee.my_second_dbt_model
[0m04:21:04.365211 [debug] [Thread-1 (]: Writing runtime sql for node "model.snowflake_instabee.my_second_dbt_model"
[0m04:21:04.367225 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.my_second_dbt_model"
[0m04:21:04.368660 [debug] [Thread-1 (]: On model.snowflake_instabee.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.my_second_dbt_model"} */
create or replace   view PC_DBT_DB.DBT_.my_second_dbt_model
  
   as (
    -- Use the `ref` function to select from other models

select *
from PC_DBT_DB.DBT_.my_first_dbt_model
where id = 1
  );
[0m04:21:04.581242 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.212 seconds
[0m04:21:04.587264 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6078f521-51ef-4411-bbfc-d2ce3eaaa47e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013594EE0290>]}
[0m04:21:04.588268 [info ] [Thread-1 (]: 5 of 14 OK created sql view model DBT_.my_second_dbt_model ..................... [[32mSUCCESS 1[0m in 0.23s]
[0m04:21:04.589286 [debug] [Thread-1 (]: Finished running node model.snowflake_instabee.my_second_dbt_model
[0m04:21:04.590291 [debug] [Thread-1 (]: Began running node model.snowflake_instabee.dim_customers
[0m04:21:04.590291 [info ] [Thread-1 (]: 6 of 14 START sql table model DBT_.dim_customers ............................... [RUN]
[0m04:21:04.591568 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.snowflake_instabee.my_second_dbt_model, now model.snowflake_instabee.dim_customers)
[0m04:21:04.591568 [debug] [Thread-1 (]: Began compiling node model.snowflake_instabee.dim_customers
[0m04:21:04.596614 [debug] [Thread-1 (]: Writing injected SQL for node "model.snowflake_instabee.dim_customers"
[0m04:21:04.597616 [debug] [Thread-1 (]: Began executing node model.snowflake_instabee.dim_customers
[0m04:21:04.600750 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.dim_customers"
[0m04:21:04.601753 [debug] [Thread-1 (]: On model.snowflake_instabee.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.dim_customers"} */
select current_warehouse() as warehouse
[0m04:21:04.684979 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.082 seconds
[0m04:21:04.686992 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.dim_customers"
[0m04:21:04.687993 [debug] [Thread-1 (]: On model.snowflake_instabee.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.dim_customers"} */
use warehouse pc_dbt_wh_large
[0m04:21:04.766818 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.079 seconds
[0m04:21:04.769853 [debug] [Thread-1 (]: Writing runtime sql for node "model.snowflake_instabee.dim_customers"
[0m04:21:04.771866 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.dim_customers"
[0m04:21:04.772908 [debug] [Thread-1 (]: On model.snowflake_instabee.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.dim_customers"} */
create or replace transient table PC_DBT_DB.DBT_.dim_customers
         as
        (SELECT DISTINCT
    customer_id,
    customer_name,
    segment
FROM PC_DBT_DB.DBT_.stg_instabee_orders
        );
[0m04:21:06.593940 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.820 seconds
[0m04:21:06.596950 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.dim_customers"
[0m04:21:06.597951 [debug] [Thread-1 (]: On model.snowflake_instabee.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.dim_customers"} */
use warehouse COMPUTE_WH
[0m04:21:06.677913 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.079 seconds
[0m04:21:06.680019 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6078f521-51ef-4411-bbfc-d2ce3eaaa47e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013594E77470>]}
[0m04:21:06.681020 [info ] [Thread-1 (]: 6 of 14 OK created sql table model DBT_.dim_customers .......................... [[32mSUCCESS 1[0m in 2.09s]
[0m04:21:06.682189 [debug] [Thread-1 (]: Finished running node model.snowflake_instabee.dim_customers
[0m04:21:06.682189 [debug] [Thread-1 (]: Began running node model.snowflake_instabee.dim_products
[0m04:21:06.683192 [info ] [Thread-1 (]: 7 of 14 START sql table model DBT_.dim_products ................................ [RUN]
[0m04:21:06.684194 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.snowflake_instabee.dim_customers, now model.snowflake_instabee.dim_products)
[0m04:21:06.685207 [debug] [Thread-1 (]: Began compiling node model.snowflake_instabee.dim_products
[0m04:21:06.689213 [debug] [Thread-1 (]: Writing injected SQL for node "model.snowflake_instabee.dim_products"
[0m04:21:06.690215 [debug] [Thread-1 (]: Began executing node model.snowflake_instabee.dim_products
[0m04:21:06.693771 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.dim_products"
[0m04:21:06.694768 [debug] [Thread-1 (]: On model.snowflake_instabee.dim_products: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.dim_products"} */
select current_warehouse() as warehouse
[0m04:21:06.758979 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.063 seconds
[0m04:21:06.761864 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.dim_products"
[0m04:21:06.762880 [debug] [Thread-1 (]: On model.snowflake_instabee.dim_products: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.dim_products"} */
use warehouse pc_dbt_wh_large
[0m04:21:06.842565 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.079 seconds
[0m04:21:06.845228 [debug] [Thread-1 (]: Writing runtime sql for node "model.snowflake_instabee.dim_products"
[0m04:21:06.848464 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.dim_products"
[0m04:21:06.849467 [debug] [Thread-1 (]: On model.snowflake_instabee.dim_products: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.dim_products"} */
create or replace transient table PC_DBT_DB.DBT_.dim_products
         as
        (WITH ranked_products AS (
  SELECT
    product_id,
    product_name,
    product_category,
    sub_category,
    ROW_NUMBER() OVER (
      PARTITION BY product_id 
      ORDER BY product_category NULLS LAST, sub_category NULLS LAST, product_name NULLS LAST
    ) as rn
  FROM PC_DBT_DB.DBT_.stg_instabee_orders
  WHERE product_id IS NOT NULL
  GROUP BY product_id, product_name, product_category, sub_category
)

SELECT
  product_id,
  product_name,
  product_category,
  sub_category
FROM ranked_products
WHERE rn = 1
        );
[0m04:21:07.662121 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.811 seconds
[0m04:21:07.664948 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.dim_products"
[0m04:21:07.666069 [debug] [Thread-1 (]: On model.snowflake_instabee.dim_products: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.dim_products"} */
use warehouse COMPUTE_WH
[0m04:21:07.741586 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.074 seconds
[0m04:21:07.744082 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6078f521-51ef-4411-bbfc-d2ce3eaaa47e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013594EDDC40>]}
[0m04:21:07.745155 [info ] [Thread-1 (]: 7 of 14 OK created sql table model DBT_.dim_products ........................... [[32mSUCCESS 1[0m in 1.06s]
[0m04:21:07.746159 [debug] [Thread-1 (]: Finished running node model.snowflake_instabee.dim_products
[0m04:21:07.747233 [debug] [Thread-1 (]: Began running node model.snowflake_instabee.dim_regions
[0m04:21:07.749466 [info ] [Thread-1 (]: 8 of 14 START sql table model DBT_.dim_regions ................................. [RUN]
[0m04:21:07.750465 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.snowflake_instabee.dim_products, now model.snowflake_instabee.dim_regions)
[0m04:21:07.751608 [debug] [Thread-1 (]: Began compiling node model.snowflake_instabee.dim_regions
[0m04:21:07.757086 [debug] [Thread-1 (]: Writing injected SQL for node "model.snowflake_instabee.dim_regions"
[0m04:21:07.758091 [debug] [Thread-1 (]: Began executing node model.snowflake_instabee.dim_regions
[0m04:21:07.764087 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.dim_regions"
[0m04:21:07.765293 [debug] [Thread-1 (]: On model.snowflake_instabee.dim_regions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.dim_regions"} */
select current_warehouse() as warehouse
[0m04:21:07.835753 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.070 seconds
[0m04:21:07.838766 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.dim_regions"
[0m04:21:07.838766 [debug] [Thread-1 (]: On model.snowflake_instabee.dim_regions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.dim_regions"} */
use warehouse pc_dbt_wh_large
[0m04:21:07.918253 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.079 seconds
[0m04:21:07.921253 [debug] [Thread-1 (]: Writing runtime sql for node "model.snowflake_instabee.dim_regions"
[0m04:21:07.923253 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.dim_regions"
[0m04:21:07.924254 [debug] [Thread-1 (]: On model.snowflake_instabee.dim_regions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.dim_regions"} */
create or replace transient table PC_DBT_DB.DBT_.dim_regions
         as
        (SELECT DISTINCT
    r.region,
    r.state,
    p.regional_manager
FROM PC_DBT_DB.DBT_.stg_instabee_orders r
LEFT JOIN PC_DBT_DB.DBT_.stg_instabee_people p
    ON r.region = p.region
        );
[0m04:21:09.398479 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.474 seconds
[0m04:21:09.401512 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.dim_regions"
[0m04:21:09.402519 [debug] [Thread-1 (]: On model.snowflake_instabee.dim_regions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.dim_regions"} */
use warehouse COMPUTE_WH
[0m04:21:09.487775 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.084 seconds
[0m04:21:09.489788 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6078f521-51ef-4411-bbfc-d2ce3eaaa47e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013594E763F0>]}
[0m04:21:09.490789 [info ] [Thread-1 (]: 8 of 14 OK created sql table model DBT_.dim_regions ............................ [[32mSUCCESS 1[0m in 1.74s]
[0m04:21:09.492073 [debug] [Thread-1 (]: Finished running node model.snowflake_instabee.dim_regions
[0m04:21:09.494104 [debug] [Thread-1 (]: Began running node model.snowflake_instabee.fact_sales
[0m04:21:09.496108 [info ] [Thread-1 (]: 9 of 14 START sql table model DBT_.fact_sales .................................. [RUN]
[0m04:21:09.496700 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.snowflake_instabee.dim_regions, now model.snowflake_instabee.fact_sales)
[0m04:21:09.497956 [debug] [Thread-1 (]: Began compiling node model.snowflake_instabee.fact_sales
[0m04:21:09.504017 [debug] [Thread-1 (]: Writing injected SQL for node "model.snowflake_instabee.fact_sales"
[0m04:21:09.506034 [debug] [Thread-1 (]: Began executing node model.snowflake_instabee.fact_sales
[0m04:21:09.509949 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.fact_sales"
[0m04:21:09.510949 [debug] [Thread-1 (]: On model.snowflake_instabee.fact_sales: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.fact_sales"} */
select current_warehouse() as warehouse
[0m04:21:09.581940 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.070 seconds
[0m04:21:09.584948 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.fact_sales"
[0m04:21:09.584948 [debug] [Thread-1 (]: On model.snowflake_instabee.fact_sales: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.fact_sales"} */
use warehouse pc_dbt_wh_large
[0m04:21:09.661294 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.075 seconds
[0m04:21:09.665752 [debug] [Thread-1 (]: Writing runtime sql for node "model.snowflake_instabee.fact_sales"
[0m04:21:09.669751 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.fact_sales"
[0m04:21:09.669751 [debug] [Thread-1 (]: On model.snowflake_instabee.fact_sales: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.fact_sales"} */
create or replace transient table PC_DBT_DB.DBT_.fact_sales
         as
        (WITH base AS (
    SELECT
        o.order_line_id,
        o.order_id,
        o.order_date,
        o.ship_date,
        o.ship_mode,
        o.customer_id,
        o.product_id,
        o.country,
        o.region,
        o.state,
        o.sales,
        o.quantity,
        o.discount,
        o.profit,
        r.returned
    FROM PC_DBT_DB.DBT_.stg_instabee_orders o
    LEFT JOIN PC_DBT_DB.DBT_.stg_instabee_returns r
        ON o.order_id = r.order_id
)

SELECT *
FROM base
        );
[0m04:21:12.219865 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.549 seconds
[0m04:21:12.221865 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.fact_sales"
[0m04:21:12.222865 [debug] [Thread-1 (]: On model.snowflake_instabee.fact_sales: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.fact_sales"} */
use warehouse COMPUTE_WH
[0m04:21:12.298350 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.075 seconds
[0m04:21:12.300774 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6078f521-51ef-4411-bbfc-d2ce3eaaa47e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013594F06F00>]}
[0m04:21:12.301775 [info ] [Thread-1 (]: 9 of 14 OK created sql table model DBT_.fact_sales ............................. [[32mSUCCESS 1[0m in 2.80s]
[0m04:21:12.303182 [debug] [Thread-1 (]: Finished running node model.snowflake_instabee.fact_sales
[0m04:21:12.303182 [debug] [Thread-1 (]: Began running node model.snowflake_instabee.month_on_month_change
[0m04:21:12.304558 [info ] [Thread-1 (]: 10 of 14 START sql table model DBT_.month_on_month_change ...................... [RUN]
[0m04:21:12.305558 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.snowflake_instabee.fact_sales, now model.snowflake_instabee.month_on_month_change)
[0m04:21:12.306941 [debug] [Thread-1 (]: Began compiling node model.snowflake_instabee.month_on_month_change
[0m04:21:12.311816 [debug] [Thread-1 (]: Writing injected SQL for node "model.snowflake_instabee.month_on_month_change"
[0m04:21:12.313827 [debug] [Thread-1 (]: Began executing node model.snowflake_instabee.month_on_month_change
[0m04:21:12.316826 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.month_on_month_change"
[0m04:21:12.317826 [debug] [Thread-1 (]: On model.snowflake_instabee.month_on_month_change: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.month_on_month_change"} */
select current_warehouse() as warehouse
[0m04:21:12.392387 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.074 seconds
[0m04:21:12.394687 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.month_on_month_change"
[0m04:21:12.395695 [debug] [Thread-1 (]: On model.snowflake_instabee.month_on_month_change: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.month_on_month_change"} */
use warehouse pc_dbt_wh_large
[0m04:21:12.470906 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.074 seconds
[0m04:21:12.530719 [debug] [Thread-1 (]: Writing runtime sql for node "model.snowflake_instabee.month_on_month_change"
[0m04:21:12.533157 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.month_on_month_change"
[0m04:21:12.534218 [debug] [Thread-1 (]: On model.snowflake_instabee.month_on_month_change: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.month_on_month_change"} */
create or replace transient table PC_DBT_DB.DBT_.month_on_month_change
         as
        (SELECT
    DATE_TRUNC('month', order_date) AS order_month,
    SUM(sales) AS total_sales,
    LAG(SUM(sales)) OVER (ORDER BY DATE_TRUNC('month', order_date)) AS previous_month_sales,
    SUM(sales) - LAG(SUM(sales)) OVER (ORDER BY DATE_TRUNC('month', order_date)) AS change_in_sales
FROM PC_DBT_DB.DBT_.fact_sales
WHERE EXTRACT(YEAR FROM order_date) = 2019
GROUP BY 1
        );
[0m04:21:13.350045 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.815 seconds
[0m04:21:13.353079 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.month_on_month_change"
[0m04:21:13.353079 [debug] [Thread-1 (]: On model.snowflake_instabee.month_on_month_change: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.month_on_month_change"} */
use warehouse COMPUTE_WH
[0m04:21:13.430913 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.077 seconds
[0m04:21:13.433927 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6078f521-51ef-4411-bbfc-d2ce3eaaa47e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013594E75DF0>]}
[0m04:21:13.434928 [info ] [Thread-1 (]: 10 of 14 OK created sql table model DBT_.month_on_month_change ................. [[32mSUCCESS 1[0m in 1.13s]
[0m04:21:13.436212 [debug] [Thread-1 (]: Finished running node model.snowflake_instabee.month_on_month_change
[0m04:21:13.436212 [debug] [Thread-1 (]: Began running node model.snowflake_instabee.monthly_returns_per_category
[0m04:21:13.437215 [info ] [Thread-1 (]: 11 of 14 START sql table model DBT_.monthly_returns_per_category ............... [RUN]
[0m04:21:13.437215 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.snowflake_instabee.month_on_month_change, now model.snowflake_instabee.monthly_returns_per_category)
[0m04:21:13.438677 [debug] [Thread-1 (]: Began compiling node model.snowflake_instabee.monthly_returns_per_category
[0m04:21:13.447200 [debug] [Thread-1 (]: Writing injected SQL for node "model.snowflake_instabee.monthly_returns_per_category"
[0m04:21:13.448208 [debug] [Thread-1 (]: Began executing node model.snowflake_instabee.monthly_returns_per_category
[0m04:21:13.452271 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.monthly_returns_per_category"
[0m04:21:13.453276 [debug] [Thread-1 (]: On model.snowflake_instabee.monthly_returns_per_category: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.monthly_returns_per_category"} */
select current_warehouse() as warehouse
[0m04:21:13.521643 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.068 seconds
[0m04:21:13.523649 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.monthly_returns_per_category"
[0m04:21:13.524852 [debug] [Thread-1 (]: On model.snowflake_instabee.monthly_returns_per_category: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.monthly_returns_per_category"} */
use warehouse pc_dbt_wh_large
[0m04:21:13.596364 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.071 seconds
[0m04:21:13.599399 [debug] [Thread-1 (]: Writing runtime sql for node "model.snowflake_instabee.monthly_returns_per_category"
[0m04:21:13.601410 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.monthly_returns_per_category"
[0m04:21:13.602847 [debug] [Thread-1 (]: On model.snowflake_instabee.monthly_returns_per_category: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.monthly_returns_per_category"} */
create or replace transient table PC_DBT_DB.DBT_.monthly_returns_per_category
         as
        (select * from (SELECT
    DATE_TRUNC('month', s.order_date) AS order_month,
    p.product_category,P.SUB_CATEGORY,
    COUNT(CASE WHEN s.order_id IS NOT NULL and s.returned = 'Yes' THEN 1 END) AS returned_orders
FROM PC_DBT_DB.DBT_.fact_sales s
JOIN PC_DBT_DB.DBT_.dim_products p
    ON s.product_id = p.product_id
WHERE EXTRACT(YEAR FROM s.order_date) = 2019
GROUP BY 1, 2,3
ORDER BY 4 DESC)
WHERE returned_orders <>0
        );
[0m04:21:14.633825 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.030 seconds
[0m04:21:14.636846 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.monthly_returns_per_category"
[0m04:21:14.637847 [debug] [Thread-1 (]: On model.snowflake_instabee.monthly_returns_per_category: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.monthly_returns_per_category"} */
use warehouse COMPUTE_WH
[0m04:21:14.715825 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.077 seconds
[0m04:21:14.717825 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6078f521-51ef-4411-bbfc-d2ce3eaaa47e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013594E171A0>]}
[0m04:21:14.718825 [info ] [Thread-1 (]: 11 of 14 OK created sql table model DBT_.monthly_returns_per_category .......... [[32mSUCCESS 1[0m in 1.28s]
[0m04:21:14.719826 [debug] [Thread-1 (]: Finished running node model.snowflake_instabee.monthly_returns_per_category
[0m04:21:14.720826 [debug] [Thread-1 (]: Began running node model.snowflake_instabee.sales_growth_per_category
[0m04:21:14.720826 [info ] [Thread-1 (]: 12 of 14 START sql table model DBT_.sales_growth_per_category .................. [RUN]
[0m04:21:14.722121 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.snowflake_instabee.monthly_returns_per_category, now model.snowflake_instabee.sales_growth_per_category)
[0m04:21:14.723104 [debug] [Thread-1 (]: Began compiling node model.snowflake_instabee.sales_growth_per_category
[0m04:21:14.732163 [debug] [Thread-1 (]: Writing injected SQL for node "model.snowflake_instabee.sales_growth_per_category"
[0m04:21:14.733165 [debug] [Thread-1 (]: Began executing node model.snowflake_instabee.sales_growth_per_category
[0m04:21:14.736691 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.sales_growth_per_category"
[0m04:21:14.737692 [debug] [Thread-1 (]: On model.snowflake_instabee.sales_growth_per_category: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.sales_growth_per_category"} */
select current_warehouse() as warehouse
[0m04:21:14.805657 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.068 seconds
[0m04:21:14.811208 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.sales_growth_per_category"
[0m04:21:14.811208 [debug] [Thread-1 (]: On model.snowflake_instabee.sales_growth_per_category: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.sales_growth_per_category"} */
use warehouse pc_dbt_wh_large
[0m04:21:14.886931 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.074 seconds
[0m04:21:14.889711 [debug] [Thread-1 (]: Writing runtime sql for node "model.snowflake_instabee.sales_growth_per_category"
[0m04:21:14.893683 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.sales_growth_per_category"
[0m04:21:14.894171 [debug] [Thread-1 (]: On model.snowflake_instabee.sales_growth_per_category: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.sales_growth_per_category"} */
create or replace transient table PC_DBT_DB.DBT_.sales_growth_per_category
         as
        (SELECT
    DATE_TRUNC('month', s.order_date) AS order_month,
    p.product_category,
    SUM(s.sales) AS monthly_sales,
    LAG(SUM(s.sales)) OVER (PARTITION BY p.product_category ORDER BY DATE_TRUNC('month', s.order_date)) AS previous_month_sales,
    (SUM(s.sales) - LAG(SUM(s.sales)) OVER (PARTITION BY p.product_category ORDER BY DATE_TRUNC('month', s.order_date))) /
        NULLIF(LAG(SUM(s.sales)) OVER (PARTITION BY p.product_category ORDER BY DATE_TRUNC('month', s.order_date)), 0) AS growth_rate
FROM PC_DBT_DB.DBT_.fact_sales s
JOIN PC_DBT_DB.DBT_.dim_products p
    ON s.product_id = p.product_id
WHERE EXTRACT(YEAR FROM order_date) = 2019
GROUP BY 1, 2
        );
[0m04:21:15.869578 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.974 seconds
[0m04:21:15.872611 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.sales_growth_per_category"
[0m04:21:15.873838 [debug] [Thread-1 (]: On model.snowflake_instabee.sales_growth_per_category: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.sales_growth_per_category"} */
use warehouse COMPUTE_WH
[0m04:21:15.959800 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.084 seconds
[0m04:21:15.961936 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6078f521-51ef-4411-bbfc-d2ce3eaaa47e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013594D83110>]}
[0m04:21:15.962937 [info ] [Thread-1 (]: 12 of 14 OK created sql table model DBT_.sales_growth_per_category ............. [[32mSUCCESS 1[0m in 1.24s]
[0m04:21:15.964426 [debug] [Thread-1 (]: Finished running node model.snowflake_instabee.sales_growth_per_category
[0m04:21:15.964426 [debug] [Thread-1 (]: Began running node model.snowflake_instabee.sales_over_time
[0m04:21:15.965438 [info ] [Thread-1 (]: 13 of 14 START sql table model DBT_.sales_over_time ............................ [RUN]
[0m04:21:15.966442 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.snowflake_instabee.sales_growth_per_category, now model.snowflake_instabee.sales_over_time)
[0m04:21:15.966442 [debug] [Thread-1 (]: Began compiling node model.snowflake_instabee.sales_over_time
[0m04:21:15.971462 [debug] [Thread-1 (]: Writing injected SQL for node "model.snowflake_instabee.sales_over_time"
[0m04:21:15.972564 [debug] [Thread-1 (]: Began executing node model.snowflake_instabee.sales_over_time
[0m04:21:15.976064 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.sales_over_time"
[0m04:21:15.977063 [debug] [Thread-1 (]: On model.snowflake_instabee.sales_over_time: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.sales_over_time"} */
select current_warehouse() as warehouse
[0m04:21:16.049514 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.071 seconds
[0m04:21:16.051513 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.sales_over_time"
[0m04:21:16.052514 [debug] [Thread-1 (]: On model.snowflake_instabee.sales_over_time: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.sales_over_time"} */
use warehouse pc_dbt_wh_large
[0m04:21:16.125808 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.073 seconds
[0m04:21:16.129149 [debug] [Thread-1 (]: Writing runtime sql for node "model.snowflake_instabee.sales_over_time"
[0m04:21:16.132286 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.sales_over_time"
[0m04:21:16.133289 [debug] [Thread-1 (]: On model.snowflake_instabee.sales_over_time: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.sales_over_time"} */
create or replace transient table PC_DBT_DB.DBT_.sales_over_time
         as
        (WITH monthly_sales AS (
  SELECT
      DATE_TRUNC('month', order_date) AS order_month,
      p.product_category,
      SUM(s.sales) AS category_sales
  FROM PC_DBT_DB.DBT_.fact_sales s
  JOIN PC_DBT_DB.DBT_.dim_products p
      ON s.product_id = p.product_id
  WHERE EXTRACT(YEAR FROM order_date) = 2019
  GROUP BY 1, 2
),

monthly_totals AS (
  SELECT
      order_month,
      SUM(category_sales) AS total_monthly_sales
  FROM monthly_sales
  GROUP BY 1
)

SELECT
    ms.order_month,
    ms.product_category,
    ms.category_sales,
    ROUND(ms.category_sales * 100.0 / mt.total_monthly_sales, 2) AS sales_percentage
FROM monthly_sales ms
JOIN monthly_totals mt
    ON ms.order_month = mt.order_month
ORDER BY 1, 4 DESC
        );
[0m04:21:16.993763 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.860 seconds
[0m04:21:16.997287 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.sales_over_time"
[0m04:21:16.998300 [debug] [Thread-1 (]: On model.snowflake_instabee.sales_over_time: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.sales_over_time"} */
use warehouse COMPUTE_WH
[0m04:21:17.118590 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.120 seconds
[0m04:21:17.120590 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6078f521-51ef-4411-bbfc-d2ce3eaaa47e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013594E15FD0>]}
[0m04:21:17.122055 [info ] [Thread-1 (]: 13 of 14 OK created sql table model DBT_.sales_over_time ....................... [[32mSUCCESS 1[0m in 1.15s]
[0m04:21:17.124253 [debug] [Thread-1 (]: Finished running node model.snowflake_instabee.sales_over_time
[0m04:21:17.126275 [debug] [Thread-1 (]: Began running node model.snowflake_instabee.top_selling_states_and_regions
[0m04:21:17.128336 [info ] [Thread-1 (]: 14 of 14 START sql table model DBT_.top_selling_states_and_regions ............. [RUN]
[0m04:21:17.129342 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.snowflake_instabee.sales_over_time, now model.snowflake_instabee.top_selling_states_and_regions)
[0m04:21:17.129342 [debug] [Thread-1 (]: Began compiling node model.snowflake_instabee.top_selling_states_and_regions
[0m04:21:17.136393 [debug] [Thread-1 (]: Writing injected SQL for node "model.snowflake_instabee.top_selling_states_and_regions"
[0m04:21:17.138432 [debug] [Thread-1 (]: Began executing node model.snowflake_instabee.top_selling_states_and_regions
[0m04:21:17.250137 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.top_selling_states_and_regions"
[0m04:21:17.251137 [debug] [Thread-1 (]: On model.snowflake_instabee.top_selling_states_and_regions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.top_selling_states_and_regions"} */
select current_warehouse() as warehouse
[0m04:21:17.325399 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.074 seconds
[0m04:21:17.328437 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.top_selling_states_and_regions"
[0m04:21:17.329439 [debug] [Thread-1 (]: On model.snowflake_instabee.top_selling_states_and_regions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.top_selling_states_and_regions"} */
use warehouse pc_dbt_wh_large
[0m04:21:17.406414 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.076 seconds
[0m04:21:17.409139 [debug] [Thread-1 (]: Writing runtime sql for node "model.snowflake_instabee.top_selling_states_and_regions"
[0m04:21:17.412507 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.top_selling_states_and_regions"
[0m04:21:17.413507 [debug] [Thread-1 (]: On model.snowflake_instabee.top_selling_states_and_regions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.top_selling_states_and_regions"} */
create or replace transient table PC_DBT_DB.DBT_.top_selling_states_and_regions
         as
        (WITH monthly_region_sales AS(SELECT
DATE_TRUNC('month', order_date) AS order_month,
    s.region,
    s.state,
    d.regional_manager,
    SUM(s.sales) AS region_sales
FROM PC_DBT_DB.DBT_.fact_sales s
LEFT JOIN PC_DBT_DB.DBT_.dim_regions d
    ON s.region = d.region AND s.state = d.state
WHERE EXTRACT(YEAR FROM s.order_date) = 2019
GROUP BY 1, 2, 3,4
ORDER BY region_sales DESC),

monthly_totals AS (
  SELECT
      order_month,
      SUM(region_sales) AS total_monthly_sales
  FROM monthly_region_sales
  GROUP BY 1
),

ranked_regions AS (
  SELECT
      mrs.*,
      mt.total_monthly_sales,
      ROUND(mrs.region_sales * 100.0 / mt.total_monthly_sales, 2) AS sales_percentage,
      ROW_NUMBER() OVER (PARTITION BY mrs.order_month ORDER BY mrs.region_sales DESC) AS region_rank
  FROM monthly_region_sales mrs
  JOIN monthly_totals mt
      ON mrs.order_month = mt.order_month
  WHERE mrs.order_month IS NOT NULL
)

SELECT
    order_month,
    region AS top_region,
    state AS top_state,
    regional_manager,
    region_sales,
    sales_percentage
FROM ranked_regions
WHERE region_rank = 1
ORDER BY order_month DESC
        );
[0m04:21:18.370605 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.957 seconds
[0m04:21:18.376516 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.top_selling_states_and_regions"
[0m04:21:18.377518 [debug] [Thread-1 (]: On model.snowflake_instabee.top_selling_states_and_regions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.top_selling_states_and_regions"} */
use warehouse COMPUTE_WH
[0m04:21:18.454733 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.076 seconds
[0m04:21:18.456725 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6078f521-51ef-4411-bbfc-d2ce3eaaa47e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013594E6EBA0>]}
[0m04:21:18.457728 [info ] [Thread-1 (]: 14 of 14 OK created sql table model DBT_.top_selling_states_and_regions ........ [[32mSUCCESS 1[0m in 1.33s]
[0m04:21:18.458729 [debug] [Thread-1 (]: Finished running node model.snowflake_instabee.top_selling_states_and_regions
[0m04:21:18.460949 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:21:18.460949 [debug] [MainThread]: Connection 'list_PC_DBT_DB' was left open.
[0m04:21:18.461953 [debug] [MainThread]: On list_PC_DBT_DB: Close
[0m04:21:18.569198 [debug] [MainThread]: Connection 'list_PC_DBT_DB_DBT_' was left open.
[0m04:21:18.570406 [debug] [MainThread]: On list_PC_DBT_DB_DBT_: Close
[0m04:21:18.763172 [debug] [MainThread]: Connection 'model.snowflake_instabee.top_selling_states_and_regions' was left open.
[0m04:21:18.764183 [debug] [MainThread]: On model.snowflake_instabee.top_selling_states_and_regions: Close
[0m04:21:18.914982 [info ] [MainThread]: 
[0m04:21:18.915987 [info ] [MainThread]: Finished running 10 table models, 4 view models in 0 hours 0 minutes and 18.71 seconds (18.71s).
[0m04:21:18.921189 [debug] [MainThread]: Command end result
[0m04:21:18.972668 [debug] [MainThread]: Wrote artifact WritableManifest to E:\desk\onedrive\Desktop\snowflake_instabee\target\manifest.json
[0m04:21:18.976698 [debug] [MainThread]: Wrote artifact SemanticManifest to E:\desk\onedrive\Desktop\snowflake_instabee\target\semantic_manifest.json
[0m04:21:18.984395 [debug] [MainThread]: Wrote artifact RunExecutionResult to E:\desk\onedrive\Desktop\snowflake_instabee\target\run_results.json
[0m04:21:18.985595 [info ] [MainThread]: 
[0m04:21:18.985595 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:21:18.986651 [info ] [MainThread]: 
[0m04:21:18.986651 [info ] [MainThread]: Done. PASS=14 WARN=0 ERROR=0 SKIP=0 TOTAL=14
[0m04:21:18.988981 [debug] [MainThread]: Command `dbt run` succeeded at 04:21:18.987980 after 21.81 seconds
[0m04:21:18.989985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013594B7B8C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000135943454C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013588FE0320>]}
[0m04:21:18.990987 [debug] [MainThread]: Flushing usage events
[0m04:21:19.557781 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:09:48.374694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232C26CC6B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232BF518C50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232C2F397C0>]}


============================== 11:09:48.406281 | 28229735-996e-4923-a905-318fd3a0db1b ==============================
[0m11:09:48.406281 [info ] [MainThread]: Running with dbt=1.9.4
[0m11:09:48.406281 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Venee\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'E:\\desk\\onedrive\\Desktop\\snowflake_instabee\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt build', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:09:49.752781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '28229735-996e-4923-a905-318fd3a0db1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232CCAF20C0>]}
[0m11:09:49.848490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '28229735-996e-4923-a905-318fd3a0db1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232CCD0B2F0>]}
[0m11:09:49.848490 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m11:09:50.982923 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m11:09:53.555751 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:09:53.555751 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:09:53.635380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '28229735-996e-4923-a905-318fd3a0db1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232CCDDD0A0>]}
[0m11:09:53.778533 [debug] [MainThread]: Wrote artifact WritableManifest to E:\desk\onedrive\Desktop\snowflake_instabee\target\manifest.json
[0m11:09:53.873386 [debug] [MainThread]: Wrote artifact SemanticManifest to E:\desk\onedrive\Desktop\snowflake_instabee\target\semantic_manifest.json
[0m11:09:54.363398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '28229735-996e-4923-a905-318fd3a0db1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232CCDDD790>]}
[0m11:09:54.363398 [info ] [MainThread]: Found 14 models, 17 data tests, 3 sources, 591 macros
[0m11:09:54.379046 [info ] [MainThread]: 
[0m11:09:54.379046 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:09:54.379046 [info ] [MainThread]: 
[0m11:09:54.379046 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:09:54.379046 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PC_DBT_DB'
[0m11:09:58.190839 [debug] [ThreadPool]: Using snowflake connection "list_PC_DBT_DB"
[0m11:09:58.190839 [debug] [ThreadPool]: On list_PC_DBT_DB: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "connection_name": "list_PC_DBT_DB"} */
show terse schemas in database PC_DBT_DB
    limit 10000
[0m11:09:58.190839 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:10:00.116171 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.922 seconds
[0m11:10:00.120187 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PC_DBT_DB_DBT_'
[0m11:10:00.131450 [debug] [ThreadPool]: Using snowflake connection "list_PC_DBT_DB_DBT_"
[0m11:10:00.131450 [debug] [ThreadPool]: On list_PC_DBT_DB_DBT_: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "connection_name": "list_PC_DBT_DB_DBT_"} */
show objects in PC_DBT_DB.DBT_ limit 10000;
[0m11:10:00.131450 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:10:00.736755 [debug] [ThreadPool]: SQL status: SUCCESS 16 in 0.596 seconds
[0m11:10:00.748473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '28229735-996e-4923-a905-318fd3a0db1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232CCC70BC0>]}
[0m11:10:00.889827 [debug] [Thread-1 (]: Began running node model.snowflake_instabee.my_first_dbt_model
[0m11:10:00.889827 [info ] [Thread-1 (]: 1 of 31 START sql table model DBT_.my_first_dbt_model .......................... [RUN]
[0m11:10:00.889827 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.snowflake_instabee.my_first_dbt_model'
[0m11:10:00.889827 [debug] [Thread-1 (]: Began compiling node model.snowflake_instabee.my_first_dbt_model
[0m11:10:00.907569 [debug] [Thread-1 (]: Writing injected SQL for node "model.snowflake_instabee.my_first_dbt_model"
[0m11:10:00.907569 [debug] [Thread-1 (]: Began executing node model.snowflake_instabee.my_first_dbt_model
[0m11:10:00.952764 [debug] [Thread-1 (]: Writing runtime sql for node "model.snowflake_instabee.my_first_dbt_model"
[0m11:10:00.952764 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.my_first_dbt_model"
[0m11:10:00.952764 [debug] [Thread-1 (]: On model.snowflake_instabee.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.my_first_dbt_model"} */
create or replace transient table PC_DBT_DB.DBT_.my_first_dbt_model
         as
        (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (
    select 1 as id, 'Example record 1' as description
    union all
    select 2 as id, 'Example record 2' as description
)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
        );
[0m11:10:00.952764 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:10:02.656882 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.698 seconds
[0m11:10:02.705982 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '28229735-996e-4923-a905-318fd3a0db1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232C28AAE10>]}
[0m11:10:02.705982 [info ] [Thread-1 (]: 1 of 31 OK created sql table model DBT_.my_first_dbt_model ..................... [[32mSUCCESS 1[0m in 1.80s]
[0m11:10:02.705982 [debug] [Thread-1 (]: Finished running node model.snowflake_instabee.my_first_dbt_model
[0m11:10:02.705982 [debug] [Thread-1 (]: Began running node model.snowflake_instabee.stg_instabee_people
[0m11:10:02.705982 [info ] [Thread-1 (]: 2 of 31 START sql view model DBT_.stg_instabee_people .......................... [RUN]
[0m11:10:02.705982 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.snowflake_instabee.my_first_dbt_model, now model.snowflake_instabee.stg_instabee_people)
[0m11:10:02.705982 [debug] [Thread-1 (]: Began compiling node model.snowflake_instabee.stg_instabee_people
[0m11:10:02.705982 [debug] [Thread-1 (]: Writing injected SQL for node "model.snowflake_instabee.stg_instabee_people"
[0m11:10:02.717999 [debug] [Thread-1 (]: Began executing node model.snowflake_instabee.stg_instabee_people
[0m11:10:02.717999 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.stg_instabee_people"
[0m11:10:02.717999 [debug] [Thread-1 (]: On model.snowflake_instabee.stg_instabee_people: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.stg_instabee_people"} */
select current_warehouse() as warehouse
[0m11:10:02.876651 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.154 seconds
[0m11:10:02.876651 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.stg_instabee_people"
[0m11:10:02.876651 [debug] [Thread-1 (]: On model.snowflake_instabee.stg_instabee_people: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.stg_instabee_people"} */
use warehouse pc_dbt_wh
[0m11:10:03.019003 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.148 seconds
[0m11:10:03.050552 [debug] [Thread-1 (]: Writing runtime sql for node "model.snowflake_instabee.stg_instabee_people"
[0m11:10:03.050552 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.stg_instabee_people"
[0m11:10:03.050552 [debug] [Thread-1 (]: On model.snowflake_instabee.stg_instabee_people: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.stg_instabee_people"} */
create or replace   view PC_DBT_DB.DBT_.stg_instabee_people
  
   as (
    with source as (

    select * from INSTABEE.PUBLIC.PEOPLE

)

select * from source
  );
[0m11:10:03.304068 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.240 seconds
[0m11:10:03.304068 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.stg_instabee_people"
[0m11:10:03.304068 [debug] [Thread-1 (]: On model.snowflake_instabee.stg_instabee_people: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.stg_instabee_people"} */
use warehouse COMPUTE_WH
[0m11:10:03.383253 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.079 seconds
[0m11:10:03.383253 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '28229735-996e-4923-a905-318fd3a0db1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232CD903EF0>]}
[0m11:10:03.383253 [info ] [Thread-1 (]: 2 of 31 OK created sql view model DBT_.stg_instabee_people ..................... [[32mSUCCESS 1[0m in 0.68s]
[0m11:10:03.383253 [debug] [Thread-1 (]: Finished running node model.snowflake_instabee.stg_instabee_people
[0m11:10:03.383253 [debug] [Thread-1 (]: Began running node model.snowflake_instabee.stg_instabee_returns
[0m11:10:03.383253 [info ] [Thread-1 (]: 3 of 31 START sql view model DBT_.stg_instabee_returns ......................... [RUN]
[0m11:10:03.383253 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.snowflake_instabee.stg_instabee_people, now model.snowflake_instabee.stg_instabee_returns)
[0m11:10:03.383253 [debug] [Thread-1 (]: Began compiling node model.snowflake_instabee.stg_instabee_returns
[0m11:10:03.399059 [debug] [Thread-1 (]: Writing injected SQL for node "model.snowflake_instabee.stg_instabee_returns"
[0m11:10:03.399059 [debug] [Thread-1 (]: Began executing node model.snowflake_instabee.stg_instabee_returns
[0m11:10:03.399059 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.stg_instabee_returns"
[0m11:10:03.399059 [debug] [Thread-1 (]: On model.snowflake_instabee.stg_instabee_returns: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.stg_instabee_returns"} */
select current_warehouse() as warehouse
[0m11:10:03.512448 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.118 seconds
[0m11:10:03.543728 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.stg_instabee_returns"
[0m11:10:03.543728 [debug] [Thread-1 (]: On model.snowflake_instabee.stg_instabee_returns: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.stg_instabee_returns"} */
use warehouse pc_dbt_wh
[0m11:10:03.651864 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.118 seconds
[0m11:10:03.667672 [debug] [Thread-1 (]: Writing runtime sql for node "model.snowflake_instabee.stg_instabee_returns"
[0m11:10:03.667672 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.stg_instabee_returns"
[0m11:10:03.667672 [debug] [Thread-1 (]: On model.snowflake_instabee.stg_instabee_returns: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.stg_instabee_returns"} */
create or replace   view PC_DBT_DB.DBT_.stg_instabee_returns
  
   as (
    WITH source AS (
    SELECT * FROM INSTABEE.PUBLIC.RETURNS
),

deduplicated AS (
    SELECT order_id, MAX(returned) AS returned
    FROM source
    GROUP BY order_id
)

SELECT * FROM deduplicated
  );
[0m11:10:03.876561 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.214 seconds
[0m11:10:03.892457 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.stg_instabee_returns"
[0m11:10:03.892457 [debug] [Thread-1 (]: On model.snowflake_instabee.stg_instabee_returns: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.stg_instabee_returns"} */
use warehouse COMPUTE_WH
[0m11:10:03.971953 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.078 seconds
[0m11:10:03.971953 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '28229735-996e-4923-a905-318fd3a0db1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232CD94C2C0>]}
[0m11:10:03.971953 [info ] [Thread-1 (]: 3 of 31 OK created sql view model DBT_.stg_instabee_returns .................... [[32mSUCCESS 1[0m in 0.59s]
[0m11:10:03.971953 [debug] [Thread-1 (]: Finished running node model.snowflake_instabee.stg_instabee_returns
[0m11:10:03.971953 [debug] [Thread-1 (]: Began running node test.snowflake_instabee.dbt_utils_source_unique_combination_of_columns_instabee_ORDERS_ORDER_ID__PRODUCT_ID__ROW_ID.3f9cb81a91
[0m11:10:03.971953 [info ] [Thread-1 (]: 4 of 31 START test dbt_utils_source_unique_combination_of_columns_instabee_ORDERS_ORDER_ID__PRODUCT_ID__ROW_ID  [RUN]
[0m11:10:03.971953 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.snowflake_instabee.stg_instabee_returns, now test.snowflake_instabee.dbt_utils_source_unique_combination_of_columns_instabee_ORDERS_ORDER_ID__PRODUCT_ID__ROW_ID.3f9cb81a91)
[0m11:10:03.971953 [debug] [Thread-1 (]: Began compiling node test.snowflake_instabee.dbt_utils_source_unique_combination_of_columns_instabee_ORDERS_ORDER_ID__PRODUCT_ID__ROW_ID.3f9cb81a91
[0m11:10:03.988002 [debug] [Thread-1 (]: Writing injected SQL for node "test.snowflake_instabee.dbt_utils_source_unique_combination_of_columns_instabee_ORDERS_ORDER_ID__PRODUCT_ID__ROW_ID.3f9cb81a91"
[0m11:10:04.003901 [debug] [Thread-1 (]: Began executing node test.snowflake_instabee.dbt_utils_source_unique_combination_of_columns_instabee_ORDERS_ORDER_ID__PRODUCT_ID__ROW_ID.3f9cb81a91
[0m11:10:04.019927 [debug] [Thread-1 (]: Writing runtime sql for node "test.snowflake_instabee.dbt_utils_source_unique_combination_of_columns_instabee_ORDERS_ORDER_ID__PRODUCT_ID__ROW_ID.3f9cb81a91"
[0m11:10:04.036030 [debug] [Thread-1 (]: Using snowflake connection "test.snowflake_instabee.dbt_utils_source_unique_combination_of_columns_instabee_ORDERS_ORDER_ID__PRODUCT_ID__ROW_ID.3f9cb81a91"
[0m11:10:04.036030 [debug] [Thread-1 (]: On test.snowflake_instabee.dbt_utils_source_unique_combination_of_columns_instabee_ORDERS_ORDER_ID__PRODUCT_ID__ROW_ID.3f9cb81a91: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "test.snowflake_instabee.dbt_utils_source_unique_combination_of_columns_instabee_ORDERS_ORDER_ID__PRODUCT_ID__ROW_ID.3f9cb81a91"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      





with validation_errors as (

    select
        ORDER_ID, PRODUCT_ID, ROW_ID
    from INSTABEE.PUBLIC.ORDERS
    group by ORDER_ID, PRODUCT_ID, ROW_ID
    having count(*) > 1

)

select *
from validation_errors



      
    ) dbt_internal_test
[0m11:10:05.009435 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.971 seconds
[0m11:10:05.017476 [info ] [Thread-1 (]: 4 of 31 PASS dbt_utils_source_unique_combination_of_columns_instabee_ORDERS_ORDER_ID__PRODUCT_ID__ROW_ID  [[32mPASS[0m in 1.05s]
[0m11:10:05.019484 [debug] [Thread-1 (]: Finished running node test.snowflake_instabee.dbt_utils_source_unique_combination_of_columns_instabee_ORDERS_ORDER_ID__PRODUCT_ID__ROW_ID.3f9cb81a91
[0m11:10:05.019484 [debug] [Thread-1 (]: Began running node test.snowflake_instabee.source_not_null_instabee_ORDERS_ORDER_ID.160b834fca
[0m11:10:05.021494 [info ] [Thread-1 (]: 5 of 31 START test source_not_null_instabee_ORDERS_ORDER_ID .................... [RUN]
[0m11:10:05.021494 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.snowflake_instabee.dbt_utils_source_unique_combination_of_columns_instabee_ORDERS_ORDER_ID__PRODUCT_ID__ROW_ID.3f9cb81a91, now test.snowflake_instabee.source_not_null_instabee_ORDERS_ORDER_ID.160b834fca)
[0m11:10:05.021494 [debug] [Thread-1 (]: Began compiling node test.snowflake_instabee.source_not_null_instabee_ORDERS_ORDER_ID.160b834fca
[0m11:10:05.031648 [debug] [Thread-1 (]: Writing injected SQL for node "test.snowflake_instabee.source_not_null_instabee_ORDERS_ORDER_ID.160b834fca"
[0m11:10:05.033655 [debug] [Thread-1 (]: Began executing node test.snowflake_instabee.source_not_null_instabee_ORDERS_ORDER_ID.160b834fca
[0m11:10:05.035402 [debug] [Thread-1 (]: Writing runtime sql for node "test.snowflake_instabee.source_not_null_instabee_ORDERS_ORDER_ID.160b834fca"
[0m11:10:05.035402 [debug] [Thread-1 (]: Using snowflake connection "test.snowflake_instabee.source_not_null_instabee_ORDERS_ORDER_ID.160b834fca"
[0m11:10:05.035402 [debug] [Thread-1 (]: On test.snowflake_instabee.source_not_null_instabee_ORDERS_ORDER_ID.160b834fca: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "test.snowflake_instabee.source_not_null_instabee_ORDERS_ORDER_ID.160b834fca"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select ORDER_ID
from INSTABEE.PUBLIC.ORDERS
where ORDER_ID is null



      
    ) dbt_internal_test
[0m11:10:05.743959 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.703 seconds
[0m11:10:05.749992 [info ] [Thread-1 (]: 5 of 31 PASS source_not_null_instabee_ORDERS_ORDER_ID .......................... [[32mPASS[0m in 0.73s]
[0m11:10:05.752003 [debug] [Thread-1 (]: Finished running node test.snowflake_instabee.source_not_null_instabee_ORDERS_ORDER_ID.160b834fca
[0m11:10:05.754013 [debug] [Thread-1 (]: Began running node test.snowflake_instabee.source_not_null_instabee_ORDERS_ROW_ID.e0a4286d0b
[0m11:10:05.754013 [info ] [Thread-1 (]: 6 of 31 START test source_not_null_instabee_ORDERS_ROW_ID ...................... [RUN]
[0m11:10:05.754013 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.snowflake_instabee.source_not_null_instabee_ORDERS_ORDER_ID.160b834fca, now test.snowflake_instabee.source_not_null_instabee_ORDERS_ROW_ID.e0a4286d0b)
[0m11:10:05.754013 [debug] [Thread-1 (]: Began compiling node test.snowflake_instabee.source_not_null_instabee_ORDERS_ROW_ID.e0a4286d0b
[0m11:10:05.758003 [debug] [Thread-1 (]: Writing injected SQL for node "test.snowflake_instabee.source_not_null_instabee_ORDERS_ROW_ID.e0a4286d0b"
[0m11:10:05.758003 [debug] [Thread-1 (]: Began executing node test.snowflake_instabee.source_not_null_instabee_ORDERS_ROW_ID.e0a4286d0b
[0m11:10:05.758003 [debug] [Thread-1 (]: Writing runtime sql for node "test.snowflake_instabee.source_not_null_instabee_ORDERS_ROW_ID.e0a4286d0b"
[0m11:10:05.758003 [debug] [Thread-1 (]: Using snowflake connection "test.snowflake_instabee.source_not_null_instabee_ORDERS_ROW_ID.e0a4286d0b"
[0m11:10:05.758003 [debug] [Thread-1 (]: On test.snowflake_instabee.source_not_null_instabee_ORDERS_ROW_ID.e0a4286d0b: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "test.snowflake_instabee.source_not_null_instabee_ORDERS_ROW_ID.e0a4286d0b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select ROW_ID
from INSTABEE.PUBLIC.ORDERS
where ROW_ID is null



      
    ) dbt_internal_test
[0m11:10:06.426778 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.657 seconds
[0m11:10:06.432813 [info ] [Thread-1 (]: 6 of 31 PASS source_not_null_instabee_ORDERS_ROW_ID ............................ [[32mPASS[0m in 0.68s]
[0m11:10:06.434561 [debug] [Thread-1 (]: Finished running node test.snowflake_instabee.source_not_null_instabee_ORDERS_ROW_ID.e0a4286d0b
[0m11:10:06.434561 [debug] [Thread-1 (]: Began running node test.snowflake_instabee.source_relationships_instabee_ORDERS_REGION__REGION__source_instabee_PEOPLE_.83bfea9f9b
[0m11:10:06.436569 [info ] [Thread-1 (]: 7 of 31 START test source_relationships_instabee_ORDERS_REGION__REGION__source_instabee_PEOPLE_  [RUN]
[0m11:10:06.436569 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.snowflake_instabee.source_not_null_instabee_ORDERS_ROW_ID.e0a4286d0b, now test.snowflake_instabee.source_relationships_instabee_ORDERS_REGION__REGION__source_instabee_PEOPLE_.83bfea9f9b)
[0m11:10:06.436569 [debug] [Thread-1 (]: Began compiling node test.snowflake_instabee.source_relationships_instabee_ORDERS_REGION__REGION__source_instabee_PEOPLE_.83bfea9f9b
[0m11:10:06.449072 [debug] [Thread-1 (]: Writing injected SQL for node "test.snowflake_instabee.source_relationships_instabee_ORDERS_REGION__REGION__source_instabee_PEOPLE_.83bfea9f9b"
[0m11:10:06.450582 [debug] [Thread-1 (]: Began executing node test.snowflake_instabee.source_relationships_instabee_ORDERS_REGION__REGION__source_instabee_PEOPLE_.83bfea9f9b
[0m11:10:06.450582 [debug] [Thread-1 (]: Writing runtime sql for node "test.snowflake_instabee.source_relationships_instabee_ORDERS_REGION__REGION__source_instabee_PEOPLE_.83bfea9f9b"
[0m11:10:06.450582 [debug] [Thread-1 (]: Using snowflake connection "test.snowflake_instabee.source_relationships_instabee_ORDERS_REGION__REGION__source_instabee_PEOPLE_.83bfea9f9b"
[0m11:10:06.450582 [debug] [Thread-1 (]: On test.snowflake_instabee.source_relationships_instabee_ORDERS_REGION__REGION__source_instabee_PEOPLE_.83bfea9f9b: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "test.snowflake_instabee.source_relationships_instabee_ORDERS_REGION__REGION__source_instabee_PEOPLE_.83bfea9f9b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select REGION as from_field
    from INSTABEE.PUBLIC.ORDERS
    where REGION is not null
),

parent as (
    select REGION as to_field
    from INSTABEE.PUBLIC.PEOPLE
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m11:10:10.413271 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.955 seconds
[0m11:10:10.413271 [info ] [Thread-1 (]: 7 of 31 PASS source_relationships_instabee_ORDERS_REGION__REGION__source_instabee_PEOPLE_  [[32mPASS[0m in 3.98s]
[0m11:10:10.413271 [debug] [Thread-1 (]: Finished running node test.snowflake_instabee.source_relationships_instabee_ORDERS_REGION__REGION__source_instabee_PEOPLE_.83bfea9f9b
[0m11:10:10.413271 [debug] [Thread-1 (]: Began running node test.snowflake_instabee.source_relationships_instabee_RETURNS_ORDER_ID__ORDER_ID__source_instabee_ORDERS_.6d2dc65aa4
[0m11:10:10.413271 [info ] [Thread-1 (]: 8 of 31 START test source_relationships_instabee_RETURNS_ORDER_ID__ORDER_ID__source_instabee_ORDERS_  [RUN]
[0m11:10:10.428992 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.snowflake_instabee.source_relationships_instabee_ORDERS_REGION__REGION__source_instabee_PEOPLE_.83bfea9f9b, now test.snowflake_instabee.source_relationships_instabee_RETURNS_ORDER_ID__ORDER_ID__source_instabee_ORDERS_.6d2dc65aa4)
[0m11:10:10.428992 [debug] [Thread-1 (]: Began compiling node test.snowflake_instabee.source_relationships_instabee_RETURNS_ORDER_ID__ORDER_ID__source_instabee_ORDERS_.6d2dc65aa4
[0m11:10:10.428992 [debug] [Thread-1 (]: Writing injected SQL for node "test.snowflake_instabee.source_relationships_instabee_RETURNS_ORDER_ID__ORDER_ID__source_instabee_ORDERS_.6d2dc65aa4"
[0m11:10:10.428992 [debug] [Thread-1 (]: Began executing node test.snowflake_instabee.source_relationships_instabee_RETURNS_ORDER_ID__ORDER_ID__source_instabee_ORDERS_.6d2dc65aa4
[0m11:10:10.428992 [debug] [Thread-1 (]: Writing runtime sql for node "test.snowflake_instabee.source_relationships_instabee_RETURNS_ORDER_ID__ORDER_ID__source_instabee_ORDERS_.6d2dc65aa4"
[0m11:10:10.444681 [debug] [Thread-1 (]: Using snowflake connection "test.snowflake_instabee.source_relationships_instabee_RETURNS_ORDER_ID__ORDER_ID__source_instabee_ORDERS_.6d2dc65aa4"
[0m11:10:10.444681 [debug] [Thread-1 (]: On test.snowflake_instabee.source_relationships_instabee_RETURNS_ORDER_ID__ORDER_ID__source_instabee_ORDERS_.6d2dc65aa4: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "test.snowflake_instabee.source_relationships_instabee_RETURNS_ORDER_ID__ORDER_ID__source_instabee_ORDERS_.6d2dc65aa4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select ORDER_ID as from_field
    from INSTABEE.PUBLIC.RETURNS
    where ORDER_ID is not null
),

parent as (
    select ORDER_ID as to_field
    from INSTABEE.PUBLIC.ORDERS
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m11:10:11.574103 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.128 seconds
[0m11:10:11.574103 [info ] [Thread-1 (]: 8 of 31 PASS source_relationships_instabee_RETURNS_ORDER_ID__ORDER_ID__source_instabee_ORDERS_  [[32mPASS[0m in 1.15s]
[0m11:10:11.574103 [debug] [Thread-1 (]: Finished running node test.snowflake_instabee.source_relationships_instabee_RETURNS_ORDER_ID__ORDER_ID__source_instabee_ORDERS_.6d2dc65aa4
[0m11:10:11.574103 [debug] [Thread-1 (]: Began running node test.snowflake_instabee.not_null_my_first_dbt_model_id.5fb22c2710
[0m11:10:11.574103 [info ] [Thread-1 (]: 9 of 31 START test not_null_my_first_dbt_model_id .............................. [RUN]
[0m11:10:11.574103 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.snowflake_instabee.source_relationships_instabee_RETURNS_ORDER_ID__ORDER_ID__source_instabee_ORDERS_.6d2dc65aa4, now test.snowflake_instabee.not_null_my_first_dbt_model_id.5fb22c2710)
[0m11:10:11.574103 [debug] [Thread-1 (]: Began compiling node test.snowflake_instabee.not_null_my_first_dbt_model_id.5fb22c2710
[0m11:10:11.589840 [debug] [Thread-1 (]: Writing injected SQL for node "test.snowflake_instabee.not_null_my_first_dbt_model_id.5fb22c2710"
[0m11:10:11.589840 [debug] [Thread-1 (]: Began executing node test.snowflake_instabee.not_null_my_first_dbt_model_id.5fb22c2710
[0m11:10:11.605520 [debug] [Thread-1 (]: Writing runtime sql for node "test.snowflake_instabee.not_null_my_first_dbt_model_id.5fb22c2710"
[0m11:10:11.605520 [debug] [Thread-1 (]: Using snowflake connection "test.snowflake_instabee.not_null_my_first_dbt_model_id.5fb22c2710"
[0m11:10:11.605520 [debug] [Thread-1 (]: On test.snowflake_instabee.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "test.snowflake_instabee.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from PC_DBT_DB.DBT_.my_first_dbt_model
where id is null



      
    ) dbt_internal_test
[0m11:10:12.136737 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.537 seconds
[0m11:10:12.136737 [info ] [Thread-1 (]: 9 of 31 PASS not_null_my_first_dbt_model_id .................................... [[32mPASS[0m in 0.56s]
[0m11:10:12.136737 [debug] [Thread-1 (]: Finished running node test.snowflake_instabee.not_null_my_first_dbt_model_id.5fb22c2710
[0m11:10:12.136737 [debug] [Thread-1 (]: Began running node test.snowflake_instabee.unique_my_first_dbt_model_id.16e066b321
[0m11:10:12.136737 [info ] [Thread-1 (]: 10 of 31 START test unique_my_first_dbt_model_id ............................... [RUN]
[0m11:10:12.152749 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.snowflake_instabee.not_null_my_first_dbt_model_id.5fb22c2710, now test.snowflake_instabee.unique_my_first_dbt_model_id.16e066b321)
[0m11:10:12.152749 [debug] [Thread-1 (]: Began compiling node test.snowflake_instabee.unique_my_first_dbt_model_id.16e066b321
[0m11:10:12.165979 [debug] [Thread-1 (]: Writing injected SQL for node "test.snowflake_instabee.unique_my_first_dbt_model_id.16e066b321"
[0m11:10:12.168492 [debug] [Thread-1 (]: Began executing node test.snowflake_instabee.unique_my_first_dbt_model_id.16e066b321
[0m11:10:12.168492 [debug] [Thread-1 (]: Writing runtime sql for node "test.snowflake_instabee.unique_my_first_dbt_model_id.16e066b321"
[0m11:10:12.168492 [debug] [Thread-1 (]: Using snowflake connection "test.snowflake_instabee.unique_my_first_dbt_model_id.16e066b321"
[0m11:10:12.168492 [debug] [Thread-1 (]: On test.snowflake_instabee.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "test.snowflake_instabee.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from (select * from PC_DBT_DB.DBT_.my_first_dbt_model where id is not null) dbt_subquery
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m11:10:12.792095 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.621 seconds
[0m11:10:12.792095 [info ] [Thread-1 (]: 10 of 31 PASS unique_my_first_dbt_model_id ..................................... [[32mPASS[0m in 0.64s]
[0m11:10:12.792095 [debug] [Thread-1 (]: Finished running node test.snowflake_instabee.unique_my_first_dbt_model_id.16e066b321
[0m11:10:12.792095 [debug] [Thread-1 (]: Began running node model.snowflake_instabee.stg_instabee_orders
[0m11:10:12.792095 [info ] [Thread-1 (]: 11 of 31 START sql view model DBT_.stg_instabee_orders ......................... [RUN]
[0m11:10:12.792095 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.snowflake_instabee.unique_my_first_dbt_model_id.16e066b321, now model.snowflake_instabee.stg_instabee_orders)
[0m11:10:12.792095 [debug] [Thread-1 (]: Began compiling node model.snowflake_instabee.stg_instabee_orders
[0m11:10:12.824212 [debug] [Thread-1 (]: Writing injected SQL for node "model.snowflake_instabee.stg_instabee_orders"
[0m11:10:12.824212 [debug] [Thread-1 (]: Began executing node model.snowflake_instabee.stg_instabee_orders
[0m11:10:12.828453 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.stg_instabee_orders"
[0m11:10:12.830460 [debug] [Thread-1 (]: On model.snowflake_instabee.stg_instabee_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.stg_instabee_orders"} */
select current_warehouse() as warehouse
[0m11:10:12.934731 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.112 seconds
[0m11:10:12.934731 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.stg_instabee_orders"
[0m11:10:12.934731 [debug] [Thread-1 (]: On model.snowflake_instabee.stg_instabee_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.stg_instabee_orders"} */
use warehouse pc_dbt_wh
[0m11:10:13.045630 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.102 seconds
[0m11:10:13.097711 [debug] [Thread-1 (]: Writing runtime sql for node "model.snowflake_instabee.stg_instabee_orders"
[0m11:10:13.101733 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.stg_instabee_orders"
[0m11:10:13.103743 [debug] [Thread-1 (]: On model.snowflake_instabee.stg_instabee_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.stg_instabee_orders"} */
create or replace   view PC_DBT_DB.DBT_.stg_instabee_orders
  
   as (
    with source as (

    select * from INSTABEE.PUBLIC.ORDERS

),

renamed as (

    select 
md5(cast(coalesce(cast(ORDER_ID as TEXT), '') || '-' || coalesce(cast(PRODUCT_ID as TEXT), '') || '-' || coalesce(cast(ROW_ID as TEXT), '') as TEXT)) as ORDER_LINE_ID,
ROW_ID,
ORDER_ID,	
ORDERDATE AS ORDER_DATE,
SHIPDATE AS SHIP_DATE,	
SHIP_MODE,	
CUSTOMER_ID,	
CUSTOMER_NAME,	
SEGMENT,
COUNTRY,
CITY,
STATE,	
POSTAL_CODE,	
REGION,	
PRODUCT_ID,	
CATEGORY as PRODUCT_CATEGORY,	
SUB_CATEGORY,	
PRODUCT_NAME,	
SALES,	
QUANTITY,	
DISCOUNT,	
PROFIT


    from source

)

select * from renamed
  );
[0m11:10:13.463405 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.370 seconds
[0m11:10:13.479316 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.stg_instabee_orders"
[0m11:10:13.479316 [debug] [Thread-1 (]: On model.snowflake_instabee.stg_instabee_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.stg_instabee_orders"} */
use warehouse COMPUTE_WH
[0m11:10:13.559109 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.081 seconds
[0m11:10:13.559109 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '28229735-996e-4923-a905-318fd3a0db1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232CD98CBF0>]}
[0m11:10:13.559109 [info ] [Thread-1 (]: 11 of 31 OK created sql view model DBT_.stg_instabee_orders .................... [[32mSUCCESS 1[0m in 0.77s]
[0m11:10:13.559109 [debug] [Thread-1 (]: Finished running node model.snowflake_instabee.stg_instabee_orders
[0m11:10:13.559109 [debug] [Thread-1 (]: Began running node model.snowflake_instabee.my_second_dbt_model
[0m11:10:13.559109 [info ] [Thread-1 (]: 12 of 31 START sql view model DBT_.my_second_dbt_model ......................... [RUN]
[0m11:10:13.559109 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.snowflake_instabee.stg_instabee_orders, now model.snowflake_instabee.my_second_dbt_model)
[0m11:10:13.575469 [debug] [Thread-1 (]: Began compiling node model.snowflake_instabee.my_second_dbt_model
[0m11:10:13.581085 [debug] [Thread-1 (]: Writing injected SQL for node "model.snowflake_instabee.my_second_dbt_model"
[0m11:10:13.582104 [debug] [Thread-1 (]: Began executing node model.snowflake_instabee.my_second_dbt_model
[0m11:10:13.586200 [debug] [Thread-1 (]: Writing runtime sql for node "model.snowflake_instabee.my_second_dbt_model"
[0m11:10:13.588206 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.my_second_dbt_model"
[0m11:10:13.590214 [debug] [Thread-1 (]: On model.snowflake_instabee.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.my_second_dbt_model"} */
create or replace   view PC_DBT_DB.DBT_.my_second_dbt_model
  
   as (
    -- Use the `ref` function to select from other models

select *
from PC_DBT_DB.DBT_.my_first_dbt_model
where id = 1
  );
[0m11:10:13.911388 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.330 seconds
[0m11:10:13.927131 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '28229735-996e-4923-a905-318fd3a0db1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232CD9D4740>]}
[0m11:10:13.927131 [info ] [Thread-1 (]: 12 of 31 OK created sql view model DBT_.my_second_dbt_model .................... [[32mSUCCESS 1[0m in 0.35s]
[0m11:10:13.927131 [debug] [Thread-1 (]: Finished running node model.snowflake_instabee.my_second_dbt_model
[0m11:10:13.927131 [debug] [Thread-1 (]: Began running node model.snowflake_instabee.dim_customers
[0m11:10:13.927131 [info ] [Thread-1 (]: 13 of 31 START sql table model DBT_.dim_customers .............................. [RUN]
[0m11:10:13.927131 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.snowflake_instabee.my_second_dbt_model, now model.snowflake_instabee.dim_customers)
[0m11:10:13.927131 [debug] [Thread-1 (]: Began compiling node model.snowflake_instabee.dim_customers
[0m11:10:13.927131 [debug] [Thread-1 (]: Writing injected SQL for node "model.snowflake_instabee.dim_customers"
[0m11:10:13.927131 [debug] [Thread-1 (]: Began executing node model.snowflake_instabee.dim_customers
[0m11:10:13.940358 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.dim_customers"
[0m11:10:13.943200 [debug] [Thread-1 (]: On model.snowflake_instabee.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.dim_customers"} */
select current_warehouse() as warehouse
[0m11:10:14.006916 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.067 seconds
[0m11:10:14.006916 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.dim_customers"
[0m11:10:14.006916 [debug] [Thread-1 (]: On model.snowflake_instabee.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.dim_customers"} */
use warehouse pc_dbt_wh_large
[0m11:10:14.087005 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.080 seconds
[0m11:10:14.087005 [debug] [Thread-1 (]: Writing runtime sql for node "model.snowflake_instabee.dim_customers"
[0m11:10:14.103661 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.dim_customers"
[0m11:10:14.103661 [debug] [Thread-1 (]: On model.snowflake_instabee.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.dim_customers"} */
create or replace transient table PC_DBT_DB.DBT_.dim_customers
         as
        (SELECT DISTINCT
    customer_id,
    customer_name,
    segment
FROM PC_DBT_DB.DBT_.stg_instabee_orders
        );
[0m11:10:15.703343 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.600 seconds
[0m11:10:15.782605 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.dim_customers"
[0m11:10:15.814228 [debug] [Thread-1 (]: On model.snowflake_instabee.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.dim_customers"} */
use warehouse COMPUTE_WH
[0m11:10:15.909080 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.106 seconds
[0m11:10:15.924943 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '28229735-996e-4923-a905-318fd3a0db1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232BF917F20>]}
[0m11:10:15.924943 [info ] [Thread-1 (]: 13 of 31 OK created sql table model DBT_.dim_customers ......................... [[32mSUCCESS 1[0m in 2.00s]
[0m11:10:15.924943 [debug] [Thread-1 (]: Finished running node model.snowflake_instabee.dim_customers
[0m11:10:15.924943 [debug] [Thread-1 (]: Began running node model.snowflake_instabee.dim_products
[0m11:10:15.924943 [info ] [Thread-1 (]: 14 of 31 START sql table model DBT_.dim_products ............................... [RUN]
[0m11:10:15.924943 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.snowflake_instabee.dim_customers, now model.snowflake_instabee.dim_products)
[0m11:10:15.924943 [debug] [Thread-1 (]: Began compiling node model.snowflake_instabee.dim_products
[0m11:10:15.940906 [debug] [Thread-1 (]: Writing injected SQL for node "model.snowflake_instabee.dim_products"
[0m11:10:15.940906 [debug] [Thread-1 (]: Began executing node model.snowflake_instabee.dim_products
[0m11:10:15.940906 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.dim_products"
[0m11:10:15.940906 [debug] [Thread-1 (]: On model.snowflake_instabee.dim_products: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.dim_products"} */
select current_warehouse() as warehouse
[0m11:10:16.004574 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.072 seconds
[0m11:10:16.020573 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.dim_products"
[0m11:10:16.020573 [debug] [Thread-1 (]: On model.snowflake_instabee.dim_products: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.dim_products"} */
use warehouse pc_dbt_wh_large
[0m11:10:16.084109 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.071 seconds
[0m11:10:16.100099 [debug] [Thread-1 (]: Writing runtime sql for node "model.snowflake_instabee.dim_products"
[0m11:10:16.100838 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.dim_products"
[0m11:10:16.100838 [debug] [Thread-1 (]: On model.snowflake_instabee.dim_products: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.dim_products"} */
create or replace transient table PC_DBT_DB.DBT_.dim_products
         as
        (WITH ranked_products AS (
  SELECT
    product_id,
    product_name,
    product_category,
    sub_category,
    ROW_NUMBER() OVER (
      PARTITION BY product_id 
      ORDER BY product_category NULLS LAST, sub_category NULLS LAST, product_name NULLS LAST
    ) as rn
  FROM PC_DBT_DB.DBT_.stg_instabee_orders
  WHERE product_id IS NOT NULL
  GROUP BY product_id, product_name, product_category, sub_category
)

SELECT
  product_id,
  product_name,
  product_category,
  sub_category
FROM ranked_products
WHERE rn = 1
        );
[0m11:10:17.342368 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.238 seconds
[0m11:10:17.342368 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.dim_products"
[0m11:10:17.342368 [debug] [Thread-1 (]: On model.snowflake_instabee.dim_products: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.dim_products"} */
use warehouse COMPUTE_WH
[0m11:10:17.421832 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.077 seconds
[0m11:10:17.421832 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '28229735-996e-4923-a905-318fd3a0db1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232BF53F500>]}
[0m11:10:17.421832 [info ] [Thread-1 (]: 14 of 31 OK created sql table model DBT_.dim_products .......................... [[32mSUCCESS 1[0m in 1.50s]
[0m11:10:17.421832 [debug] [Thread-1 (]: Finished running node model.snowflake_instabee.dim_products
[0m11:10:17.421832 [debug] [Thread-1 (]: Began running node model.snowflake_instabee.dim_regions
[0m11:10:17.430172 [info ] [Thread-1 (]: 15 of 31 START sql table model DBT_.dim_regions ................................ [RUN]
[0m11:10:17.430172 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.snowflake_instabee.dim_products, now model.snowflake_instabee.dim_regions)
[0m11:10:17.430172 [debug] [Thread-1 (]: Began compiling node model.snowflake_instabee.dim_regions
[0m11:10:17.437539 [debug] [Thread-1 (]: Writing injected SQL for node "model.snowflake_instabee.dim_regions"
[0m11:10:17.440353 [debug] [Thread-1 (]: Began executing node model.snowflake_instabee.dim_regions
[0m11:10:17.440353 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.dim_regions"
[0m11:10:17.440353 [debug] [Thread-1 (]: On model.snowflake_instabee.dim_regions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.dim_regions"} */
select current_warehouse() as warehouse
[0m11:10:17.512276 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.068 seconds
[0m11:10:17.512276 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.dim_regions"
[0m11:10:17.512276 [debug] [Thread-1 (]: On model.snowflake_instabee.dim_regions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.dim_regions"} */
use warehouse pc_dbt_wh_large
[0m11:10:17.583773 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.076 seconds
[0m11:10:17.596452 [debug] [Thread-1 (]: Writing runtime sql for node "model.snowflake_instabee.dim_regions"
[0m11:10:17.596452 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.dim_regions"
[0m11:10:17.596452 [debug] [Thread-1 (]: On model.snowflake_instabee.dim_regions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.dim_regions"} */
create or replace transient table PC_DBT_DB.DBT_.dim_regions
         as
        (SELECT DISTINCT
    r.region,
    r.state,
    p.regional_manager
FROM PC_DBT_DB.DBT_.stg_instabee_orders r
LEFT JOIN PC_DBT_DB.DBT_.stg_instabee_people p
    ON r.region = p.region
        );
[0m11:10:18.497028 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.898 seconds
[0m11:10:18.497028 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.dim_regions"
[0m11:10:18.497028 [debug] [Thread-1 (]: On model.snowflake_instabee.dim_regions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.dim_regions"} */
use warehouse COMPUTE_WH
[0m11:10:18.589115 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.089 seconds
[0m11:10:18.589115 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '28229735-996e-4923-a905-318fd3a0db1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232BF53F8C0>]}
[0m11:10:18.589115 [info ] [Thread-1 (]: 15 of 31 OK created sql table model DBT_.dim_regions ........................... [[32mSUCCESS 1[0m in 1.16s]
[0m11:10:18.599476 [debug] [Thread-1 (]: Finished running node model.snowflake_instabee.dim_regions
[0m11:10:18.599476 [debug] [Thread-1 (]: Began running node model.snowflake_instabee.fact_sales
[0m11:10:18.599476 [info ] [Thread-1 (]: 16 of 31 START sql table model DBT_.fact_sales ................................. [RUN]
[0m11:10:18.599476 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.snowflake_instabee.dim_regions, now model.snowflake_instabee.fact_sales)
[0m11:10:18.599476 [debug] [Thread-1 (]: Began compiling node model.snowflake_instabee.fact_sales
[0m11:10:18.603831 [debug] [Thread-1 (]: Writing injected SQL for node "model.snowflake_instabee.fact_sales"
[0m11:10:18.603831 [debug] [Thread-1 (]: Began executing node model.snowflake_instabee.fact_sales
[0m11:10:18.609959 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.fact_sales"
[0m11:10:18.609959 [debug] [Thread-1 (]: On model.snowflake_instabee.fact_sales: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.fact_sales"} */
select current_warehouse() as warehouse
[0m11:10:18.682518 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.071 seconds
[0m11:10:18.687561 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.fact_sales"
[0m11:10:18.687561 [debug] [Thread-1 (]: On model.snowflake_instabee.fact_sales: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.fact_sales"} */
use warehouse pc_dbt_wh_large
[0m11:10:18.769900 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.083 seconds
[0m11:10:18.777666 [debug] [Thread-1 (]: Writing runtime sql for node "model.snowflake_instabee.fact_sales"
[0m11:10:18.780394 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.fact_sales"
[0m11:10:18.780394 [debug] [Thread-1 (]: On model.snowflake_instabee.fact_sales: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.fact_sales"} */
create or replace transient table PC_DBT_DB.DBT_.fact_sales
         as
        (WITH base AS (
    SELECT
        o.order_line_id,
        o.order_id,
        o.order_date,
        o.ship_date,
        o.ship_mode,
        o.customer_id,
        o.product_id,
        o.country,
        o.region,
        o.state,
        o.sales,
        o.quantity,
        o.discount,
        o.profit,
        r.returned
    FROM PC_DBT_DB.DBT_.stg_instabee_orders o
    LEFT JOIN PC_DBT_DB.DBT_.stg_instabee_returns r
        ON o.order_id = r.order_id
)

SELECT *
FROM base
        );
[0m11:10:20.463528 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.680 seconds
[0m11:10:20.463528 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.fact_sales"
[0m11:10:20.463528 [debug] [Thread-1 (]: On model.snowflake_instabee.fact_sales: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.fact_sales"} */
use warehouse COMPUTE_WH
[0m11:10:20.565811 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.098 seconds
[0m11:10:20.567852 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '28229735-996e-4923-a905-318fd3a0db1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232CD9487D0>]}
[0m11:10:20.568866 [info ] [Thread-1 (]: 16 of 31 OK created sql table model DBT_.fact_sales ............................ [[32mSUCCESS 1[0m in 1.97s]
[0m11:10:20.569880 [debug] [Thread-1 (]: Finished running node model.snowflake_instabee.fact_sales
[0m11:10:20.570909 [debug] [Thread-1 (]: Began running node test.snowflake_instabee.not_null_my_second_dbt_model_id.151b76d778
[0m11:10:20.571925 [info ] [Thread-1 (]: 17 of 31 START test not_null_my_second_dbt_model_id ............................ [RUN]
[0m11:10:20.571925 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.snowflake_instabee.fact_sales, now test.snowflake_instabee.not_null_my_second_dbt_model_id.151b76d778)
[0m11:10:20.571925 [debug] [Thread-1 (]: Began compiling node test.snowflake_instabee.not_null_my_second_dbt_model_id.151b76d778
[0m11:10:20.581134 [debug] [Thread-1 (]: Writing injected SQL for node "test.snowflake_instabee.not_null_my_second_dbt_model_id.151b76d778"
[0m11:10:20.581134 [debug] [Thread-1 (]: Began executing node test.snowflake_instabee.not_null_my_second_dbt_model_id.151b76d778
[0m11:10:20.587160 [debug] [Thread-1 (]: Writing runtime sql for node "test.snowflake_instabee.not_null_my_second_dbt_model_id.151b76d778"
[0m11:10:20.589167 [debug] [Thread-1 (]: Using snowflake connection "test.snowflake_instabee.not_null_my_second_dbt_model_id.151b76d778"
[0m11:10:20.591646 [debug] [Thread-1 (]: On test.snowflake_instabee.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "test.snowflake_instabee.not_null_my_second_dbt_model_id.151b76d778"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from PC_DBT_DB.DBT_.my_second_dbt_model
where id is null



      
    ) dbt_internal_test
[0m11:10:20.846628 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.255 seconds
[0m11:10:20.853268 [info ] [Thread-1 (]: 17 of 31 PASS not_null_my_second_dbt_model_id .................................. [[32mPASS[0m in 0.28s]
[0m11:10:20.853268 [debug] [Thread-1 (]: Finished running node test.snowflake_instabee.not_null_my_second_dbt_model_id.151b76d778
[0m11:10:20.853268 [debug] [Thread-1 (]: Began running node test.snowflake_instabee.unique_my_second_dbt_model_id.57a0f8c493
[0m11:10:20.855276 [info ] [Thread-1 (]: 18 of 31 START test unique_my_second_dbt_model_id .............................. [RUN]
[0m11:10:20.855276 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.snowflake_instabee.not_null_my_second_dbt_model_id.151b76d778, now test.snowflake_instabee.unique_my_second_dbt_model_id.57a0f8c493)
[0m11:10:20.855276 [debug] [Thread-1 (]: Began compiling node test.snowflake_instabee.unique_my_second_dbt_model_id.57a0f8c493
[0m11:10:20.862460 [debug] [Thread-1 (]: Writing injected SQL for node "test.snowflake_instabee.unique_my_second_dbt_model_id.57a0f8c493"
[0m11:10:20.862460 [debug] [Thread-1 (]: Began executing node test.snowflake_instabee.unique_my_second_dbt_model_id.57a0f8c493
[0m11:10:20.866484 [debug] [Thread-1 (]: Writing runtime sql for node "test.snowflake_instabee.unique_my_second_dbt_model_id.57a0f8c493"
[0m11:10:20.869505 [debug] [Thread-1 (]: Using snowflake connection "test.snowflake_instabee.unique_my_second_dbt_model_id.57a0f8c493"
[0m11:10:20.869505 [debug] [Thread-1 (]: On test.snowflake_instabee.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "test.snowflake_instabee.unique_my_second_dbt_model_id.57a0f8c493"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from PC_DBT_DB.DBT_.my_second_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m11:10:21.443434 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.574 seconds
[0m11:10:21.447491 [info ] [Thread-1 (]: 18 of 31 PASS unique_my_second_dbt_model_id .................................... [[32mPASS[0m in 0.59s]
[0m11:10:21.449498 [debug] [Thread-1 (]: Finished running node test.snowflake_instabee.unique_my_second_dbt_model_id.57a0f8c493
[0m11:10:21.449498 [debug] [Thread-1 (]: Began running node test.snowflake_instabee.not_null_dim_customers_customer_id.dd91cd1c8d
[0m11:10:21.451244 [info ] [Thread-1 (]: 19 of 31 START test not_null_dim_customers_customer_id ......................... [RUN]
[0m11:10:21.451244 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.snowflake_instabee.unique_my_second_dbt_model_id.57a0f8c493, now test.snowflake_instabee.not_null_dim_customers_customer_id.dd91cd1c8d)
[0m11:10:21.453754 [debug] [Thread-1 (]: Began compiling node test.snowflake_instabee.not_null_dim_customers_customer_id.dd91cd1c8d
[0m11:10:21.453754 [debug] [Thread-1 (]: Writing injected SQL for node "test.snowflake_instabee.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m11:10:21.453754 [debug] [Thread-1 (]: Began executing node test.snowflake_instabee.not_null_dim_customers_customer_id.dd91cd1c8d
[0m11:10:21.464184 [debug] [Thread-1 (]: Writing runtime sql for node "test.snowflake_instabee.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m11:10:21.469232 [debug] [Thread-1 (]: Using snowflake connection "test.snowflake_instabee.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m11:10:21.469232 [debug] [Thread-1 (]: On test.snowflake_instabee.not_null_dim_customers_customer_id.dd91cd1c8d: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "test.snowflake_instabee.not_null_dim_customers_customer_id.dd91cd1c8d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from PC_DBT_DB.DBT_.dim_customers
where customer_id is null



      
    ) dbt_internal_test
[0m11:10:22.059316 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.589 seconds
[0m11:10:22.059316 [info ] [Thread-1 (]: 19 of 31 PASS not_null_dim_customers_customer_id ............................... [[32mPASS[0m in 0.61s]
[0m11:10:22.059316 [debug] [Thread-1 (]: Finished running node test.snowflake_instabee.not_null_dim_customers_customer_id.dd91cd1c8d
[0m11:10:22.059316 [debug] [Thread-1 (]: Began running node test.snowflake_instabee.unique_dim_customers_customer_id.15c9f1e2fd
[0m11:10:22.059316 [info ] [Thread-1 (]: 20 of 31 START test unique_dim_customers_customer_id ........................... [RUN]
[0m11:10:22.068752 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.snowflake_instabee.not_null_dim_customers_customer_id.dd91cd1c8d, now test.snowflake_instabee.unique_dim_customers_customer_id.15c9f1e2fd)
[0m11:10:22.069759 [debug] [Thread-1 (]: Began compiling node test.snowflake_instabee.unique_dim_customers_customer_id.15c9f1e2fd
[0m11:10:22.076818 [debug] [Thread-1 (]: Writing injected SQL for node "test.snowflake_instabee.unique_dim_customers_customer_id.15c9f1e2fd"
[0m11:10:22.078828 [debug] [Thread-1 (]: Began executing node test.snowflake_instabee.unique_dim_customers_customer_id.15c9f1e2fd
[0m11:10:22.081882 [debug] [Thread-1 (]: Writing runtime sql for node "test.snowflake_instabee.unique_dim_customers_customer_id.15c9f1e2fd"
[0m11:10:22.083892 [debug] [Thread-1 (]: Using snowflake connection "test.snowflake_instabee.unique_dim_customers_customer_id.15c9f1e2fd"
[0m11:10:22.083892 [debug] [Thread-1 (]: On test.snowflake_instabee.unique_dim_customers_customer_id.15c9f1e2fd: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "test.snowflake_instabee.unique_dim_customers_customer_id.15c9f1e2fd"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from PC_DBT_DB.DBT_.dim_customers
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
[0m11:10:22.660574 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.576 seconds
[0m11:10:22.664619 [info ] [Thread-1 (]: 20 of 31 PASS unique_dim_customers_customer_id ................................. [[32mPASS[0m in 0.61s]
[0m11:10:22.665628 [debug] [Thread-1 (]: Finished running node test.snowflake_instabee.unique_dim_customers_customer_id.15c9f1e2fd
[0m11:10:22.667639 [debug] [Thread-1 (]: Began running node test.snowflake_instabee.not_null_dim_products_product_id.c8aba288d1
[0m11:10:22.667639 [info ] [Thread-1 (]: 21 of 31 START test not_null_dim_products_product_id ........................... [RUN]
[0m11:10:22.667639 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.snowflake_instabee.unique_dim_customers_customer_id.15c9f1e2fd, now test.snowflake_instabee.not_null_dim_products_product_id.c8aba288d1)
[0m11:10:22.667639 [debug] [Thread-1 (]: Began compiling node test.snowflake_instabee.not_null_dim_products_product_id.c8aba288d1
[0m11:10:22.675027 [debug] [Thread-1 (]: Writing injected SQL for node "test.snowflake_instabee.not_null_dim_products_product_id.c8aba288d1"
[0m11:10:22.675027 [debug] [Thread-1 (]: Began executing node test.snowflake_instabee.not_null_dim_products_product_id.c8aba288d1
[0m11:10:22.679044 [debug] [Thread-1 (]: Writing runtime sql for node "test.snowflake_instabee.not_null_dim_products_product_id.c8aba288d1"
[0m11:10:22.681052 [debug] [Thread-1 (]: Using snowflake connection "test.snowflake_instabee.not_null_dim_products_product_id.c8aba288d1"
[0m11:10:22.681052 [debug] [Thread-1 (]: On test.snowflake_instabee.not_null_dim_products_product_id.c8aba288d1: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "test.snowflake_instabee.not_null_dim_products_product_id.c8aba288d1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_id
from PC_DBT_DB.DBT_.dim_products
where product_id is null



      
    ) dbt_internal_test
[0m11:10:23.175744 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.497 seconds
[0m11:10:23.182833 [info ] [Thread-1 (]: 21 of 31 PASS not_null_dim_products_product_id ................................. [[32mPASS[0m in 0.52s]
[0m11:10:23.184845 [debug] [Thread-1 (]: Finished running node test.snowflake_instabee.not_null_dim_products_product_id.c8aba288d1
[0m11:10:23.184845 [debug] [Thread-1 (]: Began running node test.snowflake_instabee.unique_dim_products_product_id.ef7b2a9985
[0m11:10:23.186356 [info ] [Thread-1 (]: 22 of 31 START test unique_dim_products_product_id ............................. [RUN]
[0m11:10:23.186356 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.snowflake_instabee.not_null_dim_products_product_id.c8aba288d1, now test.snowflake_instabee.unique_dim_products_product_id.ef7b2a9985)
[0m11:10:23.186356 [debug] [Thread-1 (]: Began compiling node test.snowflake_instabee.unique_dim_products_product_id.ef7b2a9985
[0m11:10:23.196424 [debug] [Thread-1 (]: Writing injected SQL for node "test.snowflake_instabee.unique_dim_products_product_id.ef7b2a9985"
[0m11:10:23.196424 [debug] [Thread-1 (]: Began executing node test.snowflake_instabee.unique_dim_products_product_id.ef7b2a9985
[0m11:10:23.196424 [debug] [Thread-1 (]: Writing runtime sql for node "test.snowflake_instabee.unique_dim_products_product_id.ef7b2a9985"
[0m11:10:23.196424 [debug] [Thread-1 (]: Using snowflake connection "test.snowflake_instabee.unique_dim_products_product_id.ef7b2a9985"
[0m11:10:23.206572 [debug] [Thread-1 (]: On test.snowflake_instabee.unique_dim_products_product_id.ef7b2a9985: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "test.snowflake_instabee.unique_dim_products_product_id.ef7b2a9985"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    product_id as unique_field,
    count(*) as n_records

from PC_DBT_DB.DBT_.dim_products
where product_id is not null
group by product_id
having count(*) > 1



      
    ) dbt_internal_test
[0m11:10:23.608431 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.411 seconds
[0m11:10:23.620932 [info ] [Thread-1 (]: 22 of 31 PASS unique_dim_products_product_id ................................... [[32mPASS[0m in 0.43s]
[0m11:10:23.622941 [debug] [Thread-1 (]: Finished running node test.snowflake_instabee.unique_dim_products_product_id.ef7b2a9985
[0m11:10:23.622941 [debug] [Thread-1 (]: Began running node test.snowflake_instabee.not_null_dim_regions_region.935ece66be
[0m11:10:23.623949 [info ] [Thread-1 (]: 23 of 31 START test not_null_dim_regions_region ................................ [RUN]
[0m11:10:23.623949 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.snowflake_instabee.unique_dim_products_product_id.ef7b2a9985, now test.snowflake_instabee.not_null_dim_regions_region.935ece66be)
[0m11:10:23.623949 [debug] [Thread-1 (]: Began compiling node test.snowflake_instabee.not_null_dim_regions_region.935ece66be
[0m11:10:23.629436 [debug] [Thread-1 (]: Writing injected SQL for node "test.snowflake_instabee.not_null_dim_regions_region.935ece66be"
[0m11:10:23.713985 [debug] [Thread-1 (]: Began executing node test.snowflake_instabee.not_null_dim_regions_region.935ece66be
[0m11:10:23.719499 [debug] [Thread-1 (]: Writing runtime sql for node "test.snowflake_instabee.not_null_dim_regions_region.935ece66be"
[0m11:10:23.719499 [debug] [Thread-1 (]: Using snowflake connection "test.snowflake_instabee.not_null_dim_regions_region.935ece66be"
[0m11:10:23.719499 [debug] [Thread-1 (]: On test.snowflake_instabee.not_null_dim_regions_region.935ece66be: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "test.snowflake_instabee.not_null_dim_regions_region.935ece66be"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select region
from PC_DBT_DB.DBT_.dim_regions
where region is null



      
    ) dbt_internal_test
[0m11:10:24.220141 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.496 seconds
[0m11:10:24.222151 [info ] [Thread-1 (]: 23 of 31 PASS not_null_dim_regions_region ...................................... [[32mPASS[0m in 0.60s]
[0m11:10:24.224161 [debug] [Thread-1 (]: Finished running node test.snowflake_instabee.not_null_dim_regions_region.935ece66be
[0m11:10:24.224161 [debug] [Thread-1 (]: Began running node test.snowflake_instabee.not_null_fact_sales_order_id.f6f073d70b
[0m11:10:24.226170 [info ] [Thread-1 (]: 24 of 31 START test not_null_fact_sales_order_id ............................... [RUN]
[0m11:10:24.226682 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.snowflake_instabee.not_null_dim_regions_region.935ece66be, now test.snowflake_instabee.not_null_fact_sales_order_id.f6f073d70b)
[0m11:10:24.226682 [debug] [Thread-1 (]: Began compiling node test.snowflake_instabee.not_null_fact_sales_order_id.f6f073d70b
[0m11:10:24.232739 [debug] [Thread-1 (]: Writing injected SQL for node "test.snowflake_instabee.not_null_fact_sales_order_id.f6f073d70b"
[0m11:10:24.234748 [debug] [Thread-1 (]: Began executing node test.snowflake_instabee.not_null_fact_sales_order_id.f6f073d70b
[0m11:10:24.238798 [debug] [Thread-1 (]: Writing runtime sql for node "test.snowflake_instabee.not_null_fact_sales_order_id.f6f073d70b"
[0m11:10:24.238798 [debug] [Thread-1 (]: Using snowflake connection "test.snowflake_instabee.not_null_fact_sales_order_id.f6f073d70b"
[0m11:10:24.240808 [debug] [Thread-1 (]: On test.snowflake_instabee.not_null_fact_sales_order_id.f6f073d70b: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "test.snowflake_instabee.not_null_fact_sales_order_id.f6f073d70b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_id
from PC_DBT_DB.DBT_.fact_sales
where order_id is null



      
    ) dbt_internal_test
[0m11:10:24.723797 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.482 seconds
[0m11:10:24.729017 [info ] [Thread-1 (]: 24 of 31 PASS not_null_fact_sales_order_id ..................................... [[32mPASS[0m in 0.50s]
[0m11:10:24.731028 [debug] [Thread-1 (]: Finished running node test.snowflake_instabee.not_null_fact_sales_order_id.f6f073d70b
[0m11:10:24.733040 [debug] [Thread-1 (]: Began running node test.snowflake_instabee.not_null_fact_sales_order_line_id.224e5eff48
[0m11:10:24.735052 [info ] [Thread-1 (]: 25 of 31 START test not_null_fact_sales_order_line_id .......................... [RUN]
[0m11:10:24.735052 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.snowflake_instabee.not_null_fact_sales_order_id.f6f073d70b, now test.snowflake_instabee.not_null_fact_sales_order_line_id.224e5eff48)
[0m11:10:24.735052 [debug] [Thread-1 (]: Began compiling node test.snowflake_instabee.not_null_fact_sales_order_line_id.224e5eff48
[0m11:10:24.743182 [debug] [Thread-1 (]: Writing injected SQL for node "test.snowflake_instabee.not_null_fact_sales_order_line_id.224e5eff48"
[0m11:10:24.743182 [debug] [Thread-1 (]: Began executing node test.snowflake_instabee.not_null_fact_sales_order_line_id.224e5eff48
[0m11:10:24.747258 [debug] [Thread-1 (]: Writing runtime sql for node "test.snowflake_instabee.not_null_fact_sales_order_line_id.224e5eff48"
[0m11:10:24.749268 [debug] [Thread-1 (]: Using snowflake connection "test.snowflake_instabee.not_null_fact_sales_order_line_id.224e5eff48"
[0m11:10:24.751278 [debug] [Thread-1 (]: On test.snowflake_instabee.not_null_fact_sales_order_line_id.224e5eff48: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "test.snowflake_instabee.not_null_fact_sales_order_line_id.224e5eff48"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_line_id
from PC_DBT_DB.DBT_.fact_sales
where order_line_id is null



      
    ) dbt_internal_test
[0m11:10:25.198777 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.448 seconds
[0m11:10:25.203810 [info ] [Thread-1 (]: 25 of 31 PASS not_null_fact_sales_order_line_id ................................ [[32mPASS[0m in 0.47s]
[0m11:10:25.203810 [debug] [Thread-1 (]: Finished running node test.snowflake_instabee.not_null_fact_sales_order_line_id.224e5eff48
[0m11:10:25.205818 [debug] [Thread-1 (]: Began running node test.snowflake_instabee.unique_fact_sales_order_line_id.317c4be9bd
[0m11:10:25.205818 [info ] [Thread-1 (]: 26 of 31 START test unique_fact_sales_order_line_id ............................ [RUN]
[0m11:10:25.205818 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.snowflake_instabee.not_null_fact_sales_order_line_id.224e5eff48, now test.snowflake_instabee.unique_fact_sales_order_line_id.317c4be9bd)
[0m11:10:25.205818 [debug] [Thread-1 (]: Began compiling node test.snowflake_instabee.unique_fact_sales_order_line_id.317c4be9bd
[0m11:10:25.212247 [debug] [Thread-1 (]: Writing injected SQL for node "test.snowflake_instabee.unique_fact_sales_order_line_id.317c4be9bd"
[0m11:10:25.214256 [debug] [Thread-1 (]: Began executing node test.snowflake_instabee.unique_fact_sales_order_line_id.317c4be9bd
[0m11:10:25.220423 [debug] [Thread-1 (]: Writing runtime sql for node "test.snowflake_instabee.unique_fact_sales_order_line_id.317c4be9bd"
[0m11:10:25.220423 [debug] [Thread-1 (]: Using snowflake connection "test.snowflake_instabee.unique_fact_sales_order_line_id.317c4be9bd"
[0m11:10:25.220423 [debug] [Thread-1 (]: On test.snowflake_instabee.unique_fact_sales_order_line_id.317c4be9bd: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "test.snowflake_instabee.unique_fact_sales_order_line_id.317c4be9bd"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    order_line_id as unique_field,
    count(*) as n_records

from PC_DBT_DB.DBT_.fact_sales
where order_line_id is not null
group by order_line_id
having count(*) > 1



      
    ) dbt_internal_test
[0m11:10:25.649779 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.427 seconds
[0m11:10:25.649779 [info ] [Thread-1 (]: 26 of 31 PASS unique_fact_sales_order_line_id .................................. [[32mPASS[0m in 0.44s]
[0m11:10:25.649779 [debug] [Thread-1 (]: Finished running node test.snowflake_instabee.unique_fact_sales_order_line_id.317c4be9bd
[0m11:10:25.649779 [debug] [Thread-1 (]: Began running node model.snowflake_instabee.month_on_month_change
[0m11:10:25.658193 [info ] [Thread-1 (]: 27 of 31 START sql table model DBT_.month_on_month_change ...................... [RUN]
[0m11:10:25.658193 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.snowflake_instabee.unique_fact_sales_order_line_id.317c4be9bd, now model.snowflake_instabee.month_on_month_change)
[0m11:10:25.658193 [debug] [Thread-1 (]: Began compiling node model.snowflake_instabee.month_on_month_change
[0m11:10:25.664723 [debug] [Thread-1 (]: Writing injected SQL for node "model.snowflake_instabee.month_on_month_change"
[0m11:10:25.665732 [debug] [Thread-1 (]: Began executing node model.snowflake_instabee.month_on_month_change
[0m11:10:25.668544 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.month_on_month_change"
[0m11:10:25.668544 [debug] [Thread-1 (]: On model.snowflake_instabee.month_on_month_change: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.month_on_month_change"} */
select current_warehouse() as warehouse
[0m11:10:25.740315 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.070 seconds
[0m11:10:25.744804 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.month_on_month_change"
[0m11:10:25.744804 [debug] [Thread-1 (]: On model.snowflake_instabee.month_on_month_change: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.month_on_month_change"} */
use warehouse pc_dbt_wh_large
[0m11:10:25.826902 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.078 seconds
[0m11:10:25.830467 [debug] [Thread-1 (]: Writing runtime sql for node "model.snowflake_instabee.month_on_month_change"
[0m11:10:25.834485 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.month_on_month_change"
[0m11:10:25.834485 [debug] [Thread-1 (]: On model.snowflake_instabee.month_on_month_change: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.month_on_month_change"} */
create or replace transient table PC_DBT_DB.DBT_.month_on_month_change
         as
        (SELECT
    DATE_TRUNC('month', order_date) AS order_month,
    SUM(sales) AS total_sales,
    LAG(SUM(sales)) OVER (ORDER BY DATE_TRUNC('month', order_date)) AS previous_month_sales,
    SUM(sales) - LAG(SUM(sales)) OVER (ORDER BY DATE_TRUNC('month', order_date)) AS change_in_sales
FROM PC_DBT_DB.DBT_.fact_sales
WHERE EXTRACT(YEAR FROM order_date) = 2019
GROUP BY 1
        );
[0m11:10:26.783046 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.947 seconds
[0m11:10:26.785149 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.month_on_month_change"
[0m11:10:26.787159 [debug] [Thread-1 (]: On model.snowflake_instabee.month_on_month_change: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.month_on_month_change"} */
use warehouse COMPUTE_WH
[0m11:10:26.877396 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.090 seconds
[0m11:10:26.879410 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '28229735-996e-4923-a905-318fd3a0db1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232CD36B350>]}
[0m11:10:26.879410 [info ] [Thread-1 (]: 27 of 31 OK created sql table model DBT_.month_on_month_change ................. [[32mSUCCESS 1[0m in 1.22s]
[0m11:10:26.879410 [debug] [Thread-1 (]: Finished running node model.snowflake_instabee.month_on_month_change
[0m11:10:26.879410 [debug] [Thread-1 (]: Began running node model.snowflake_instabee.monthly_returns_per_category
[0m11:10:26.879410 [info ] [Thread-1 (]: 28 of 31 START sql table model DBT_.monthly_returns_per_category ............... [RUN]
[0m11:10:26.879410 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.snowflake_instabee.month_on_month_change, now model.snowflake_instabee.monthly_returns_per_category)
[0m11:10:26.879410 [debug] [Thread-1 (]: Began compiling node model.snowflake_instabee.monthly_returns_per_category
[0m11:10:26.895487 [debug] [Thread-1 (]: Writing injected SQL for node "model.snowflake_instabee.monthly_returns_per_category"
[0m11:10:26.895487 [debug] [Thread-1 (]: Began executing node model.snowflake_instabee.monthly_returns_per_category
[0m11:10:26.895487 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.monthly_returns_per_category"
[0m11:10:26.895487 [debug] [Thread-1 (]: On model.snowflake_instabee.monthly_returns_per_category: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.monthly_returns_per_category"} */
select current_warehouse() as warehouse
[0m11:10:27.006402 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.106 seconds
[0m11:10:27.006402 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.monthly_returns_per_category"
[0m11:10:27.006402 [debug] [Thread-1 (]: On model.snowflake_instabee.monthly_returns_per_category: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.monthly_returns_per_category"} */
use warehouse pc_dbt_wh_large
[0m11:10:27.085368 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.072 seconds
[0m11:10:27.085368 [debug] [Thread-1 (]: Writing runtime sql for node "model.snowflake_instabee.monthly_returns_per_category"
[0m11:10:27.085368 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.monthly_returns_per_category"
[0m11:10:27.085368 [debug] [Thread-1 (]: On model.snowflake_instabee.monthly_returns_per_category: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.monthly_returns_per_category"} */
create or replace transient table PC_DBT_DB.DBT_.monthly_returns_per_category
         as
        (select * from (SELECT
    DATE_TRUNC('month', s.order_date) AS order_month,
    p.product_category,P.SUB_CATEGORY,
    COUNT(CASE WHEN s.order_id IS NOT NULL and s.returned = 'Yes' THEN 1 END) AS returned_orders
FROM PC_DBT_DB.DBT_.fact_sales s
JOIN PC_DBT_DB.DBT_.dim_products p
    ON s.product_id = p.product_id
WHERE EXTRACT(YEAR FROM s.order_date) = 2019
GROUP BY 1, 2,3
ORDER BY 4 DESC)
WHERE returned_orders <>0
        );
[0m11:10:28.229478 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.128 seconds
[0m11:10:28.234507 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.monthly_returns_per_category"
[0m11:10:28.234507 [debug] [Thread-1 (]: On model.snowflake_instabee.monthly_returns_per_category: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.monthly_returns_per_category"} */
use warehouse COMPUTE_WH
[0m11:10:28.315491 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.079 seconds
[0m11:10:28.315491 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '28229735-996e-4923-a905-318fd3a0db1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232CD974710>]}
[0m11:10:28.315491 [info ] [Thread-1 (]: 28 of 31 OK created sql table model DBT_.monthly_returns_per_category .......... [[32mSUCCESS 1[0m in 1.44s]
[0m11:10:28.315491 [debug] [Thread-1 (]: Finished running node model.snowflake_instabee.monthly_returns_per_category
[0m11:10:28.315491 [debug] [Thread-1 (]: Began running node model.snowflake_instabee.sales_growth_per_category
[0m11:10:28.315491 [info ] [Thread-1 (]: 29 of 31 START sql table model DBT_.sales_growth_per_category .................. [RUN]
[0m11:10:28.315491 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.snowflake_instabee.monthly_returns_per_category, now model.snowflake_instabee.sales_growth_per_category)
[0m11:10:28.315491 [debug] [Thread-1 (]: Began compiling node model.snowflake_instabee.sales_growth_per_category
[0m11:10:28.333163 [debug] [Thread-1 (]: Writing injected SQL for node "model.snowflake_instabee.sales_growth_per_category"
[0m11:10:28.333163 [debug] [Thread-1 (]: Began executing node model.snowflake_instabee.sales_growth_per_category
[0m11:10:28.333163 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.sales_growth_per_category"
[0m11:10:28.333163 [debug] [Thread-1 (]: On model.snowflake_instabee.sales_growth_per_category: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.sales_growth_per_category"} */
select current_warehouse() as warehouse
[0m11:10:28.433311 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.092 seconds
[0m11:10:28.435321 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.sales_growth_per_category"
[0m11:10:28.437331 [debug] [Thread-1 (]: On model.snowflake_instabee.sales_growth_per_category: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.sales_growth_per_category"} */
use warehouse pc_dbt_wh_large
[0m11:10:28.506066 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.072 seconds
[0m11:10:28.506066 [debug] [Thread-1 (]: Writing runtime sql for node "model.snowflake_instabee.sales_growth_per_category"
[0m11:10:28.506066 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.sales_growth_per_category"
[0m11:10:28.506066 [debug] [Thread-1 (]: On model.snowflake_instabee.sales_growth_per_category: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.sales_growth_per_category"} */
create or replace transient table PC_DBT_DB.DBT_.sales_growth_per_category
         as
        (SELECT
    DATE_TRUNC('month', s.order_date) AS order_month,
    p.product_category,
    SUM(s.sales) AS monthly_sales,
    LAG(SUM(s.sales)) OVER (PARTITION BY p.product_category ORDER BY DATE_TRUNC('month', s.order_date)) AS previous_month_sales,
    (SUM(s.sales) - LAG(SUM(s.sales)) OVER (PARTITION BY p.product_category ORDER BY DATE_TRUNC('month', s.order_date))) /
        NULLIF(LAG(SUM(s.sales)) OVER (PARTITION BY p.product_category ORDER BY DATE_TRUNC('month', s.order_date)), 0) AS growth_rate
FROM PC_DBT_DB.DBT_.fact_sales s
JOIN PC_DBT_DB.DBT_.dim_products p
    ON s.product_id = p.product_id
WHERE EXTRACT(YEAR FROM order_date) = 2019
GROUP BY 1, 2
        );
[0m11:10:29.540810 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.027 seconds
[0m11:10:29.540810 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.sales_growth_per_category"
[0m11:10:29.540810 [debug] [Thread-1 (]: On model.snowflake_instabee.sales_growth_per_category: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.sales_growth_per_category"} */
use warehouse COMPUTE_WH
[0m11:10:29.636058 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.080 seconds
[0m11:10:29.637067 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '28229735-996e-4923-a905-318fd3a0db1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232CCCCE6C0>]}
[0m11:10:29.639077 [info ] [Thread-1 (]: 29 of 31 OK created sql table model DBT_.sales_growth_per_category ............. [[32mSUCCESS 1[0m in 1.32s]
[0m11:10:29.639077 [debug] [Thread-1 (]: Finished running node model.snowflake_instabee.sales_growth_per_category
[0m11:10:29.641086 [debug] [Thread-1 (]: Began running node model.snowflake_instabee.sales_over_time
[0m11:10:29.641086 [info ] [Thread-1 (]: 30 of 31 START sql table model DBT_.sales_over_time ............................ [RUN]
[0m11:10:29.641086 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.snowflake_instabee.sales_growth_per_category, now model.snowflake_instabee.sales_over_time)
[0m11:10:29.643864 [debug] [Thread-1 (]: Began compiling node model.snowflake_instabee.sales_over_time
[0m11:10:29.647880 [debug] [Thread-1 (]: Writing injected SQL for node "model.snowflake_instabee.sales_over_time"
[0m11:10:29.649889 [debug] [Thread-1 (]: Began executing node model.snowflake_instabee.sales_over_time
[0m11:10:29.652905 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.sales_over_time"
[0m11:10:29.652905 [debug] [Thread-1 (]: On model.snowflake_instabee.sales_over_time: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.sales_over_time"} */
select current_warehouse() as warehouse
[0m11:10:29.716327 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.073 seconds
[0m11:10:29.716327 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.sales_over_time"
[0m11:10:29.716327 [debug] [Thread-1 (]: On model.snowflake_instabee.sales_over_time: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.sales_over_time"} */
use warehouse pc_dbt_wh_large
[0m11:10:29.808356 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.076 seconds
[0m11:10:29.811374 [debug] [Thread-1 (]: Writing runtime sql for node "model.snowflake_instabee.sales_over_time"
[0m11:10:29.811374 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.sales_over_time"
[0m11:10:29.811374 [debug] [Thread-1 (]: On model.snowflake_instabee.sales_over_time: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.sales_over_time"} */
create or replace transient table PC_DBT_DB.DBT_.sales_over_time
         as
        (WITH monthly_sales AS (
  SELECT
      DATE_TRUNC('month', order_date) AS order_month,
      p.product_category,
      SUM(s.sales) AS category_sales
  FROM PC_DBT_DB.DBT_.fact_sales s
  JOIN PC_DBT_DB.DBT_.dim_products p
      ON s.product_id = p.product_id
  WHERE EXTRACT(YEAR FROM order_date) = 2019
  GROUP BY 1, 2
),

monthly_totals AS (
  SELECT
      order_month,
      SUM(category_sales) AS total_monthly_sales
  FROM monthly_sales
  GROUP BY 1
)

SELECT
    ms.order_month,
    ms.product_category,
    ms.category_sales,
    ROUND(ms.category_sales * 100.0 / mt.total_monthly_sales, 2) AS sales_percentage
FROM monthly_sales ms
JOIN monthly_totals mt
    ON ms.order_month = mt.order_month
ORDER BY 1, 4 DESC
        );
[0m11:10:30.918451 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.104 seconds
[0m11:10:30.924114 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.sales_over_time"
[0m11:10:30.924114 [debug] [Thread-1 (]: On model.snowflake_instabee.sales_over_time: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.sales_over_time"} */
use warehouse COMPUTE_WH
[0m11:10:31.003756 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.079 seconds
[0m11:10:31.005767 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '28229735-996e-4923-a905-318fd3a0db1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232CD9C6480>]}
[0m11:10:31.007775 [info ] [Thread-1 (]: 30 of 31 OK created sql table model DBT_.sales_over_time ....................... [[32mSUCCESS 1[0m in 1.36s]
[0m11:10:31.007775 [debug] [Thread-1 (]: Finished running node model.snowflake_instabee.sales_over_time
[0m11:10:31.009783 [debug] [Thread-1 (]: Began running node model.snowflake_instabee.top_selling_states_and_regions
[0m11:10:31.009783 [info ] [Thread-1 (]: 31 of 31 START sql table model DBT_.top_selling_states_and_regions ............. [RUN]
[0m11:10:31.009783 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.snowflake_instabee.sales_over_time, now model.snowflake_instabee.top_selling_states_and_regions)
[0m11:10:31.012273 [debug] [Thread-1 (]: Began compiling node model.snowflake_instabee.top_selling_states_and_regions
[0m11:10:31.018295 [debug] [Thread-1 (]: Writing injected SQL for node "model.snowflake_instabee.top_selling_states_and_regions"
[0m11:10:31.018295 [debug] [Thread-1 (]: Began executing node model.snowflake_instabee.top_selling_states_and_regions
[0m11:10:31.022314 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.top_selling_states_and_regions"
[0m11:10:31.023824 [debug] [Thread-1 (]: On model.snowflake_instabee.top_selling_states_and_regions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.top_selling_states_and_regions"} */
select current_warehouse() as warehouse
[0m11:10:31.087328 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.066 seconds
[0m11:10:31.087328 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.top_selling_states_and_regions"
[0m11:10:31.087328 [debug] [Thread-1 (]: On model.snowflake_instabee.top_selling_states_and_regions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.top_selling_states_and_regions"} */
use warehouse pc_dbt_wh_large
[0m11:10:31.182701 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.102 seconds
[0m11:10:31.198704 [debug] [Thread-1 (]: Writing runtime sql for node "model.snowflake_instabee.top_selling_states_and_regions"
[0m11:10:31.198704 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.top_selling_states_and_regions"
[0m11:10:31.198704 [debug] [Thread-1 (]: On model.snowflake_instabee.top_selling_states_and_regions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.top_selling_states_and_regions"} */
create or replace transient table PC_DBT_DB.DBT_.top_selling_states_and_regions
         as
        (WITH monthly_region_sales AS(SELECT
DATE_TRUNC('month', order_date) AS order_month,
    s.region,
    s.state,
    d.regional_manager,
    SUM(s.sales) AS region_sales
FROM PC_DBT_DB.DBT_.fact_sales s
LEFT JOIN PC_DBT_DB.DBT_.dim_regions d
    ON s.region = d.region AND s.state = d.state
WHERE EXTRACT(YEAR FROM s.order_date) = 2019
GROUP BY 1, 2, 3,4
ORDER BY region_sales DESC),

monthly_totals AS (
  SELECT
      order_month,
      SUM(region_sales) AS total_monthly_sales
  FROM monthly_region_sales
  GROUP BY 1
),

ranked_regions AS (
  SELECT
      mrs.*,
      mt.total_monthly_sales,
      ROUND(mrs.region_sales * 100.0 / mt.total_monthly_sales, 2) AS sales_percentage,
      ROW_NUMBER() OVER (PARTITION BY mrs.order_month ORDER BY mrs.region_sales DESC) AS region_rank
  FROM monthly_region_sales mrs
  JOIN monthly_totals mt
      ON mrs.order_month = mt.order_month
  WHERE mrs.order_month IS NOT NULL
)

SELECT
    order_month,
    region AS top_region,
    state AS top_state,
    regional_manager,
    region_sales,
    sales_percentage
FROM ranked_regions
WHERE region_rank = 1
ORDER BY order_month DESC
        );
[0m11:10:32.346608 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.139 seconds
[0m11:10:32.346608 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.top_selling_states_and_regions"
[0m11:10:32.346608 [debug] [Thread-1 (]: On model.snowflake_instabee.top_selling_states_and_regions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.top_selling_states_and_regions"} */
use warehouse COMPUTE_WH
[0m11:10:32.426554 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.078 seconds
[0m11:10:32.426554 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '28229735-996e-4923-a905-318fd3a0db1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232CCCA0590>]}
[0m11:10:32.442529 [info ] [Thread-1 (]: 31 of 31 OK created sql table model DBT_.top_selling_states_and_regions ........ [[32mSUCCESS 1[0m in 1.42s]
[0m11:10:32.442529 [debug] [Thread-1 (]: Finished running node model.snowflake_instabee.top_selling_states_and_regions
[0m11:10:32.442529 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:10:32.442529 [debug] [MainThread]: Connection 'list_PC_DBT_DB' was left open.
[0m11:10:32.442529 [debug] [MainThread]: On list_PC_DBT_DB: Close
[0m11:10:32.551949 [debug] [MainThread]: Connection 'list_PC_DBT_DB_DBT_' was left open.
[0m11:10:32.551949 [debug] [MainThread]: On list_PC_DBT_DB_DBT_: Close
[0m11:10:32.661439 [debug] [MainThread]: Connection 'model.snowflake_instabee.top_selling_states_and_regions' was left open.
[0m11:10:32.661439 [debug] [MainThread]: On model.snowflake_instabee.top_selling_states_and_regions: Close
[0m11:10:32.759827 [info ] [MainThread]: 
[0m11:10:32.759827 [info ] [MainThread]: Finished running 10 table models, 17 data tests, 4 view models in 0 hours 0 minutes and 38.38 seconds (38.38s).
[0m11:10:32.775542 [debug] [MainThread]: Command end result
[0m11:10:32.823385 [debug] [MainThread]: Wrote artifact WritableManifest to E:\desk\onedrive\Desktop\snowflake_instabee\target\manifest.json
[0m11:10:32.839027 [debug] [MainThread]: Wrote artifact SemanticManifest to E:\desk\onedrive\Desktop\snowflake_instabee\target\semantic_manifest.json
[0m11:10:32.839027 [debug] [MainThread]: Wrote artifact RunExecutionResult to E:\desk\onedrive\Desktop\snowflake_instabee\target\run_results.json
[0m11:10:32.839027 [info ] [MainThread]: 
[0m11:10:32.854683 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:10:32.854683 [info ] [MainThread]: 
[0m11:10:32.854683 [info ] [MainThread]: Done. PASS=31 WARN=0 ERROR=0 SKIP=0 TOTAL=31
[0m11:10:32.854683 [debug] [MainThread]: Command `dbt build` succeeded at 11:10:32.854683 after 44.67 seconds
[0m11:10:32.854683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232C4171E80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232C2882CC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232BF2BC650>]}
[0m11:10:32.854683 [debug] [MainThread]: Flushing usage events
[0m11:10:33.589667 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:56:35.090369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236B49F3EF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236B49F3D70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236B49F3860>]}


============================== 13:56:35.113687 | 7be2f62a-a177-4c1b-ad67-96b1f1af1035 ==============================
[0m13:56:35.113687 [info ] [MainThread]: Running with dbt=1.9.4
[0m13:56:35.113687 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'E:\\desk\\onedrive\\Desktop\\snowflake_instabee\\logs', 'profiles_dir': 'C:\\Users\\Venee\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:56:35.359576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7be2f62a-a177-4c1b-ad67-96b1f1af1035', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236B4A78620>]}
[0m13:56:35.775043 [debug] [MainThread]: Set downloads directory='C:\Users\Venee\AppData\Local\Temp\dbt-downloads-wwld_bwg'
[0m13:56:35.783049 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m13:56:35.850039 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m13:56:35.850039 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m13:56:35.881559 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m13:56:35.910917 [info ] [MainThread]: Updating lock file in file path: E:\desk\onedrive\Desktop\snowflake_instabee/package-lock.yml
[0m13:56:35.991669 [debug] [MainThread]: Set downloads directory='C:\Users\Venee\AppData\Local\Temp\dbt-downloads-gn28uv9a'
[0m13:56:35.991669 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m13:56:36.450593 [info ] [MainThread]: Installed from version 1.1.1
[0m13:56:36.450593 [info ] [MainThread]: Updated version available: 1.3.0
[0m13:56:36.450593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '7be2f62a-a177-4c1b-ad67-96b1f1af1035', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236B4A78410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236B2E29370>]}
[0m13:56:36.450593 [info ] [MainThread]: 
[0m13:56:36.450593 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m13:56:36.450593 [debug] [MainThread]: Command `dbt deps` succeeded at 13:56:36.450593 after 1.62 seconds
[0m13:56:36.450593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236B2B31FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236B49F3860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236B49F3D70>]}
[0m13:56:36.450593 [debug] [MainThread]: Flushing usage events
[0m13:56:36.998941 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:57:33.815616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215FA5F3020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215FA5F36B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215FA5F3B90>]}


============================== 13:57:33.815616 | 0ab74c2a-8686-4498-b21c-14a9444c816a ==============================
[0m13:57:33.815616 [info ] [MainThread]: Running with dbt=1.9.4
[0m13:57:33.815616 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\Venee\\.dbt', 'log_path': 'E:\\desk\\onedrive\\Desktop\\snowflake_instabee\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:57:34.022317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0ab74c2a-8686-4498-b21c-14a9444c816a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215FA4F9A60>]}
[0m13:57:34.069819 [debug] [MainThread]: Set downloads directory='C:\Users\Venee\AppData\Local\Temp\dbt-downloads-4myih1qx'
[0m13:57:34.069819 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m13:57:34.132967 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m13:57:34.132967 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m13:57:34.164351 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m13:57:34.180472 [info ] [MainThread]: Updating lock file in file path: E:\desk\onedrive\Desktop\snowflake_instabee/package-lock.yml
[0m13:57:34.339260 [debug] [MainThread]: Set downloads directory='C:\Users\Venee\AppData\Local\Temp\dbt-downloads-a5c_6vyl'
[0m13:57:34.339260 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m13:57:34.876830 [info ] [MainThread]: Installed from version 1.3.0
[0m13:57:34.876830 [info ] [MainThread]: Up to date!
[0m13:57:34.876830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '0ab74c2a-8686-4498-b21c-14a9444c816a', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215FA6B14F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215FA4C15B0>]}
[0m13:57:34.876830 [debug] [MainThread]: Command `dbt deps` succeeded at 13:57:34.876830 after 1.24 seconds
[0m13:57:34.876830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215FA395BB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215F8A07E30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215FA63D100>]}
[0m13:57:34.876830 [debug] [MainThread]: Flushing usage events
[0m13:57:35.320895 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:57:58.851871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000292DDFF3DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000292DDFF3D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000292DDFF3C50>]}


============================== 13:57:58.858506 | 9a6f3d47-1cf7-43fa-ae4c-e69273fd8436 ==============================
[0m13:57:58.858506 [info ] [MainThread]: Running with dbt=1.9.4
[0m13:57:58.858506 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'E:\\desk\\onedrive\\Desktop\\snowflake_instabee\\logs', 'profiles_dir': 'C:\\Users\\Venee\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:57:58.862176 [error] [MainThread]: Encountered an error:
Runtime Error
  
  dbt encountered an error while trying to read your profiles.yml file.
  
  Runtime Error
    Syntax error near line 2
    ------------------------------
    1  | target: dev
    2  |   outputs:
    3  |     dev:
    4  |       type: snowflake
    5  |       account: XU17144.europe-west4.gcp  # From your debug output
    
    Raw Error:
    ------------------------------
    mapping values are not allowed in this context
      in "<unicode string>", line 2, column 10
  
[0m13:57:58.862176 [debug] [MainThread]: Command `dbt run` failed at 13:57:58.862176 after 0.09 seconds
[0m13:57:58.862176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000292DD953BC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000292DDD71370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000292DDFF2D20>]}
[0m13:57:58.862176 [debug] [MainThread]: Flushing usage events
[0m13:57:59.447436 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:59:13.285175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D97689C5C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9799293A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D97992BEC0>]}


============================== 13:59:13.295242 | 307f46ce-1423-433c-bad8-6ca9d59a1963 ==============================
[0m13:59:13.295242 [info ] [MainThread]: Running with dbt=1.9.4
[0m13:59:13.295242 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'E:\\desk\\onedrive\\Desktop\\snowflake_instabee\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\Venee\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:59:22.004173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '307f46ce-1423-433c-bad8-6ca9d59a1963', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D902D79790>]}
[0m13:59:22.173931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '307f46ce-1423-433c-bad8-6ca9d59a1963', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D90299CC50>]}
[0m13:59:22.189953 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m13:59:23.202816 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m13:59:25.756897 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:59:25.756897 [debug] [MainThread]: Partial parsing: updated file: snowflake_instabee://macros\generate_surrogate_key.sql
[0m13:59:25.898741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '307f46ce-1423-433c-bad8-6ca9d59a1963', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D90435F500>]}
[0m13:59:26.056794 [debug] [MainThread]: Wrote artifact WritableManifest to E:\desk\onedrive\Desktop\snowflake_instabee\target\manifest.json
[0m13:59:26.158829 [debug] [MainThread]: Wrote artifact SemanticManifest to E:\desk\onedrive\Desktop\snowflake_instabee\target\semantic_manifest.json
[0m13:59:26.278293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '307f46ce-1423-433c-bad8-6ca9d59a1963', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D90437FCB0>]}
[0m13:59:26.278293 [info ] [MainThread]: Found 14 models, 17 data tests, 3 sources, 591 macros
[0m13:59:26.278293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '307f46ce-1423-433c-bad8-6ca9d59a1963', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D902EA9CA0>]}
[0m13:59:26.278293 [info ] [MainThread]: 
[0m13:59:26.278293 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:59:26.278293 [info ] [MainThread]: 
[0m13:59:26.278293 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:59:26.278293 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PC_DBT_DB'
[0m13:59:31.066410 [debug] [ThreadPool]: Using snowflake connection "list_PC_DBT_DB"
[0m13:59:31.067411 [debug] [ThreadPool]: On list_PC_DBT_DB: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "connection_name": "list_PC_DBT_DB"} */
show terse schemas in database PC_DBT_DB
    limit 10000
[0m13:59:31.068412 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:59:32.050510 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.986 seconds
[0m13:59:32.056824 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_PC_DBT_DB_DBT_'
[0m13:59:32.066428 [debug] [ThreadPool]: Using snowflake connection "list_PC_DBT_DB_DBT_"
[0m13:59:32.066428 [debug] [ThreadPool]: On list_PC_DBT_DB_DBT_: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "connection_name": "list_PC_DBT_DB_DBT_"} */
show objects in PC_DBT_DB.DBT_ limit 10000;
[0m13:59:32.066428 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:59:32.691052 [debug] [ThreadPool]: SQL status: SUCCESS 16 in 0.612 seconds
[0m13:59:32.701417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '307f46ce-1423-433c-bad8-6ca9d59a1963', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D902EABFE0>]}
[0m13:59:32.799132 [debug] [Thread-1 (]: Began running node model.snowflake_instabee.my_first_dbt_model
[0m13:59:32.799132 [info ] [Thread-1 (]: 1 of 14 START sql table model DBT_.my_first_dbt_model .......................... [RUN]
[0m13:59:32.799132 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.snowflake_instabee.my_first_dbt_model'
[0m13:59:32.811494 [debug] [Thread-1 (]: Began compiling node model.snowflake_instabee.my_first_dbt_model
[0m13:59:32.823267 [debug] [Thread-1 (]: Writing injected SQL for node "model.snowflake_instabee.my_first_dbt_model"
[0m13:59:32.825273 [debug] [Thread-1 (]: Began executing node model.snowflake_instabee.my_first_dbt_model
[0m13:59:32.877978 [debug] [Thread-1 (]: Writing runtime sql for node "model.snowflake_instabee.my_first_dbt_model"
[0m13:59:32.877978 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.my_first_dbt_model"
[0m13:59:32.885684 [debug] [Thread-1 (]: On model.snowflake_instabee.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.my_first_dbt_model"} */
create or replace transient table PC_DBT_DB.DBT_.my_first_dbt_model
         as
        (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (
    select 1 as id, 'Example record 1' as description
    union all
    select 2 as id, 'Example record 2' as description
)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
        );
[0m13:59:32.887693 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:59:35.548462 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.663 seconds
[0m13:59:35.593141 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '307f46ce-1423-433c-bad8-6ca9d59a1963', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D976994A40>]}
[0m13:59:35.593141 [info ] [Thread-1 (]: 1 of 14 OK created sql table model DBT_.my_first_dbt_model ..................... [[32mSUCCESS 1[0m in 2.79s]
[0m13:59:35.599739 [debug] [Thread-1 (]: Finished running node model.snowflake_instabee.my_first_dbt_model
[0m13:59:35.599739 [debug] [Thread-1 (]: Began running node model.snowflake_instabee.stg_instabee_orders
[0m13:59:35.599739 [info ] [Thread-1 (]: 2 of 14 START sql view model DBT_.stg_instabee_orders .......................... [RUN]
[0m13:59:35.599739 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.snowflake_instabee.my_first_dbt_model, now model.snowflake_instabee.stg_instabee_orders)
[0m13:59:35.599739 [debug] [Thread-1 (]: Began compiling node model.snowflake_instabee.stg_instabee_orders
[0m13:59:35.622620 [debug] [Thread-1 (]: Writing injected SQL for node "model.snowflake_instabee.stg_instabee_orders"
[0m13:59:35.624627 [debug] [Thread-1 (]: Began executing node model.snowflake_instabee.stg_instabee_orders
[0m13:59:35.630528 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.stg_instabee_orders"
[0m13:59:35.630528 [debug] [Thread-1 (]: On model.snowflake_instabee.stg_instabee_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.stg_instabee_orders"} */
select current_warehouse() as warehouse
[0m13:59:35.802751 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.171 seconds
[0m13:59:35.877549 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.stg_instabee_orders"
[0m13:59:35.877549 [debug] [Thread-1 (]: On model.snowflake_instabee.stg_instabee_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.stg_instabee_orders"} */
use warehouse pc_dbt_wh
[0m13:59:36.038344 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.153 seconds
[0m13:59:36.065281 [debug] [Thread-1 (]: Writing runtime sql for node "model.snowflake_instabee.stg_instabee_orders"
[0m13:59:36.065281 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.stg_instabee_orders"
[0m13:59:36.065281 [debug] [Thread-1 (]: On model.snowflake_instabee.stg_instabee_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.stg_instabee_orders"} */
create or replace   view PC_DBT_DB.DBT_.stg_instabee_orders
  
   as (
    with source as (

    select * from INSTABEE.PUBLIC.ORDERS

),

renamed as (

    select 
md5(cast(coalesce(cast(ORDER_ID as TEXT), '') || '-' || coalesce(cast(PRODUCT_ID as TEXT), '') || '-' || coalesce(cast(ROW_ID as TEXT), '') as TEXT)) as ORDER_LINE_ID,
ROW_ID,
ORDER_ID,	
ORDERDATE AS ORDER_DATE,
SHIPDATE AS SHIP_DATE,	
SHIP_MODE,	
CUSTOMER_ID,	
CUSTOMER_NAME,	
SEGMENT,
COUNTRY,
CITY,
STATE,	
POSTAL_CODE,	
REGION,	
PRODUCT_ID,	
CATEGORY as PRODUCT_CATEGORY,	
SUB_CATEGORY,	
PRODUCT_NAME,	
SALES,	
QUANTITY,	
DISCOUNT,	
PROFIT


    from source

)

select * from renamed
  );
[0m13:59:36.493967 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.424 seconds
[0m13:59:36.502510 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.stg_instabee_orders"
[0m13:59:36.502510 [debug] [Thread-1 (]: On model.snowflake_instabee.stg_instabee_orders: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.stg_instabee_orders"} */
use warehouse COMPUTE_WH
[0m13:59:36.645852 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.141 seconds
[0m13:59:36.645852 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '307f46ce-1423-433c-bad8-6ca9d59a1963', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D90483BE30>]}
[0m13:59:36.645852 [info ] [Thread-1 (]: 2 of 14 OK created sql view model DBT_.stg_instabee_orders ..................... [[32mSUCCESS 1[0m in 1.05s]
[0m13:59:36.645852 [debug] [Thread-1 (]: Finished running node model.snowflake_instabee.stg_instabee_orders
[0m13:59:36.645852 [debug] [Thread-1 (]: Began running node model.snowflake_instabee.stg_instabee_people
[0m13:59:36.645852 [info ] [Thread-1 (]: 3 of 14 START sql view model DBT_.stg_instabee_people .......................... [RUN]
[0m13:59:36.645852 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.snowflake_instabee.stg_instabee_orders, now model.snowflake_instabee.stg_instabee_people)
[0m13:59:36.645852 [debug] [Thread-1 (]: Began compiling node model.snowflake_instabee.stg_instabee_people
[0m13:59:36.661841 [debug] [Thread-1 (]: Writing injected SQL for node "model.snowflake_instabee.stg_instabee_people"
[0m13:59:36.661841 [debug] [Thread-1 (]: Began executing node model.snowflake_instabee.stg_instabee_people
[0m13:59:36.668896 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.stg_instabee_people"
[0m13:59:36.668896 [debug] [Thread-1 (]: On model.snowflake_instabee.stg_instabee_people: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.stg_instabee_people"} */
select current_warehouse() as warehouse
[0m13:59:36.836520 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.171 seconds
[0m13:59:36.836520 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.stg_instabee_people"
[0m13:59:36.836520 [debug] [Thread-1 (]: On model.snowflake_instabee.stg_instabee_people: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.stg_instabee_people"} */
use warehouse pc_dbt_wh
[0m13:59:37.114966 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.268 seconds
[0m13:59:37.120991 [debug] [Thread-1 (]: Writing runtime sql for node "model.snowflake_instabee.stg_instabee_people"
[0m13:59:37.122999 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.stg_instabee_people"
[0m13:59:37.125010 [debug] [Thread-1 (]: On model.snowflake_instabee.stg_instabee_people: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.stg_instabee_people"} */
create or replace   view PC_DBT_DB.DBT_.stg_instabee_people
  
   as (
    with source as (

    select * from INSTABEE.PUBLIC.PEOPLE

)

select * from source
  );
[0m13:59:37.503555 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.381 seconds
[0m13:59:37.503555 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.stg_instabee_people"
[0m13:59:37.503555 [debug] [Thread-1 (]: On model.snowflake_instabee.stg_instabee_people: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.stg_instabee_people"} */
use warehouse COMPUTE_WH
[0m13:59:37.625723 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.112 seconds
[0m13:59:37.627735 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '307f46ce-1423-433c-bad8-6ca9d59a1963', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D90482DC70>]}
[0m13:59:37.629743 [info ] [Thread-1 (]: 3 of 14 OK created sql view model DBT_.stg_instabee_people ..................... [[32mSUCCESS 1[0m in 0.98s]
[0m13:59:37.629743 [debug] [Thread-1 (]: Finished running node model.snowflake_instabee.stg_instabee_people
[0m13:59:37.629743 [debug] [Thread-1 (]: Began running node model.snowflake_instabee.stg_instabee_returns
[0m13:59:37.631750 [info ] [Thread-1 (]: 4 of 14 START sql view model DBT_.stg_instabee_returns ......................... [RUN]
[0m13:59:37.631750 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.snowflake_instabee.stg_instabee_people, now model.snowflake_instabee.stg_instabee_returns)
[0m13:59:37.633495 [debug] [Thread-1 (]: Began compiling node model.snowflake_instabee.stg_instabee_returns
[0m13:59:37.633495 [debug] [Thread-1 (]: Writing injected SQL for node "model.snowflake_instabee.stg_instabee_returns"
[0m13:59:37.633495 [debug] [Thread-1 (]: Began executing node model.snowflake_instabee.stg_instabee_returns
[0m13:59:37.633495 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.stg_instabee_returns"
[0m13:59:37.633495 [debug] [Thread-1 (]: On model.snowflake_instabee.stg_instabee_returns: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.stg_instabee_returns"} */
select current_warehouse() as warehouse
[0m13:59:37.712779 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.077 seconds
[0m13:59:37.723822 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.stg_instabee_returns"
[0m13:59:37.725830 [debug] [Thread-1 (]: On model.snowflake_instabee.stg_instabee_returns: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.stg_instabee_returns"} */
use warehouse pc_dbt_wh
[0m13:59:37.882949 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.157 seconds
[0m13:59:37.886967 [debug] [Thread-1 (]: Writing runtime sql for node "model.snowflake_instabee.stg_instabee_returns"
[0m13:59:37.888477 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.stg_instabee_returns"
[0m13:59:37.890488 [debug] [Thread-1 (]: On model.snowflake_instabee.stg_instabee_returns: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.stg_instabee_returns"} */
create or replace   view PC_DBT_DB.DBT_.stg_instabee_returns
  
   as (
    WITH source AS (
    SELECT * FROM INSTABEE.PUBLIC.RETURNS
),

deduplicated AS (
    SELECT order_id, MAX(returned) AS returned
    FROM source
    GROUP BY order_id
)

SELECT * FROM deduplicated
  );
[0m13:59:38.137561 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.250 seconds
[0m13:59:38.144286 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.stg_instabee_returns"
[0m13:59:38.144286 [debug] [Thread-1 (]: On model.snowflake_instabee.stg_instabee_returns: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.stg_instabee_returns"} */
use warehouse COMPUTE_WH
[0m13:59:38.228162 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.084 seconds
[0m13:59:38.228162 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '307f46ce-1423-433c-bad8-6ca9d59a1963', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D90489D940>]}
[0m13:59:38.228162 [info ] [Thread-1 (]: 4 of 14 OK created sql view model DBT_.stg_instabee_returns .................... [[32mSUCCESS 1[0m in 0.60s]
[0m13:59:38.228162 [debug] [Thread-1 (]: Finished running node model.snowflake_instabee.stg_instabee_returns
[0m13:59:38.228162 [debug] [Thread-1 (]: Began running node model.snowflake_instabee.my_second_dbt_model
[0m13:59:38.228162 [info ] [Thread-1 (]: 5 of 14 START sql view model DBT_.my_second_dbt_model .......................... [RUN]
[0m13:59:38.228162 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.snowflake_instabee.stg_instabee_returns, now model.snowflake_instabee.my_second_dbt_model)
[0m13:59:38.243832 [debug] [Thread-1 (]: Began compiling node model.snowflake_instabee.my_second_dbt_model
[0m13:59:38.249629 [debug] [Thread-1 (]: Writing injected SQL for node "model.snowflake_instabee.my_second_dbt_model"
[0m13:59:38.251635 [debug] [Thread-1 (]: Began executing node model.snowflake_instabee.my_second_dbt_model
[0m13:59:38.255650 [debug] [Thread-1 (]: Writing runtime sql for node "model.snowflake_instabee.my_second_dbt_model"
[0m13:59:38.257657 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.my_second_dbt_model"
[0m13:59:38.259666 [debug] [Thread-1 (]: On model.snowflake_instabee.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.my_second_dbt_model"} */
create or replace   view PC_DBT_DB.DBT_.my_second_dbt_model
  
   as (
    -- Use the `ref` function to select from other models

select *
from PC_DBT_DB.DBT_.my_first_dbt_model
where id = 1
  );
[0m13:59:38.450347 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.198 seconds
[0m13:59:38.450347 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '307f46ce-1423-433c-bad8-6ca9d59a1963', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9048CCB00>]}
[0m13:59:38.466182 [info ] [Thread-1 (]: 5 of 14 OK created sql view model DBT_.my_second_dbt_model ..................... [[32mSUCCESS 1[0m in 0.22s]
[0m13:59:38.466182 [debug] [Thread-1 (]: Finished running node model.snowflake_instabee.my_second_dbt_model
[0m13:59:38.466182 [debug] [Thread-1 (]: Began running node model.snowflake_instabee.dim_customers
[0m13:59:38.466182 [info ] [Thread-1 (]: 6 of 14 START sql table model DBT_.dim_customers ............................... [RUN]
[0m13:59:38.466182 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.snowflake_instabee.my_second_dbt_model, now model.snowflake_instabee.dim_customers)
[0m13:59:38.466182 [debug] [Thread-1 (]: Began compiling node model.snowflake_instabee.dim_customers
[0m13:59:38.466182 [debug] [Thread-1 (]: Writing injected SQL for node "model.snowflake_instabee.dim_customers"
[0m13:59:38.466182 [debug] [Thread-1 (]: Began executing node model.snowflake_instabee.dim_customers
[0m13:59:38.466182 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.dim_customers"
[0m13:59:38.466182 [debug] [Thread-1 (]: On model.snowflake_instabee.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.dim_customers"} */
select current_warehouse() as warehouse
[0m13:59:38.545828 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.069 seconds
[0m13:59:38.545828 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.dim_customers"
[0m13:59:38.545828 [debug] [Thread-1 (]: On model.snowflake_instabee.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.dim_customers"} */
use warehouse pc_dbt_wh_large
[0m13:59:38.636943 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.085 seconds
[0m13:59:38.639948 [debug] [Thread-1 (]: Writing runtime sql for node "model.snowflake_instabee.dim_customers"
[0m13:59:38.642149 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.dim_customers"
[0m13:59:38.643400 [debug] [Thread-1 (]: On model.snowflake_instabee.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.dim_customers"} */
create or replace transient table PC_DBT_DB.DBT_.dim_customers
         as
        (SELECT DISTINCT
    customer_id,
    customer_name,
    segment
FROM PC_DBT_DB.DBT_.stg_instabee_orders
        );
[0m13:59:40.898763 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.262 seconds
[0m13:59:40.907882 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.dim_customers"
[0m13:59:40.914495 [debug] [Thread-1 (]: On model.snowflake_instabee.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.dim_customers"} */
use warehouse COMPUTE_WH
[0m13:59:41.038405 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.122 seconds
[0m13:59:41.042160 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '307f46ce-1423-433c-bad8-6ca9d59a1963', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D90482F7D0>]}
[0m13:59:41.042160 [info ] [Thread-1 (]: 6 of 14 OK created sql table model DBT_.dim_customers .......................... [[32mSUCCESS 1[0m in 2.57s]
[0m13:59:41.042160 [debug] [Thread-1 (]: Finished running node model.snowflake_instabee.dim_customers
[0m13:59:41.042160 [debug] [Thread-1 (]: Began running node model.snowflake_instabee.dim_products
[0m13:59:41.042160 [info ] [Thread-1 (]: 7 of 14 START sql table model DBT_.dim_products ................................ [RUN]
[0m13:59:41.042160 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.snowflake_instabee.dim_customers, now model.snowflake_instabee.dim_products)
[0m13:59:41.042160 [debug] [Thread-1 (]: Began compiling node model.snowflake_instabee.dim_products
[0m13:59:41.042160 [debug] [Thread-1 (]: Writing injected SQL for node "model.snowflake_instabee.dim_products"
[0m13:59:41.042160 [debug] [Thread-1 (]: Began executing node model.snowflake_instabee.dim_products
[0m13:59:41.057893 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.dim_products"
[0m13:59:41.057893 [debug] [Thread-1 (]: On model.snowflake_instabee.dim_products: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.dim_products"} */
select current_warehouse() as warehouse
[0m13:59:41.130914 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.072 seconds
[0m13:59:41.132922 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.dim_products"
[0m13:59:41.132922 [debug] [Thread-1 (]: On model.snowflake_instabee.dim_products: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.dim_products"} */
use warehouse pc_dbt_wh_large
[0m13:59:41.231711 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.097 seconds
[0m13:59:41.233722 [debug] [Thread-1 (]: Writing runtime sql for node "model.snowflake_instabee.dim_products"
[0m13:59:41.237737 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.dim_products"
[0m13:59:41.237737 [debug] [Thread-1 (]: On model.snowflake_instabee.dim_products: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.dim_products"} */
create or replace transient table PC_DBT_DB.DBT_.dim_products
         as
        (WITH ranked_products AS (
  SELECT
    product_id,
    product_name,
    product_category,
    sub_category,
    ROW_NUMBER() OVER (
      PARTITION BY product_id 
      ORDER BY product_category NULLS LAST, sub_category NULLS LAST, product_name NULLS LAST
    ) as rn
  FROM PC_DBT_DB.DBT_.stg_instabee_orders
  WHERE product_id IS NOT NULL
  GROUP BY product_id, product_name, product_category, sub_category
)

SELECT
  product_id,
  product_name,
  product_category,
  sub_category
FROM ranked_products
WHERE rn = 1
        );
[0m13:59:42.344092 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.106 seconds
[0m13:59:42.351377 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.dim_products"
[0m13:59:42.353671 [debug] [Thread-1 (]: On model.snowflake_instabee.dim_products: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.dim_products"} */
use warehouse COMPUTE_WH
[0m13:59:42.458264 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.104 seconds
[0m13:59:42.462728 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '307f46ce-1423-433c-bad8-6ca9d59a1963', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D90482E4B0>]}
[0m13:59:42.462728 [info ] [Thread-1 (]: 7 of 14 OK created sql table model DBT_.dim_products ........................... [[32mSUCCESS 1[0m in 1.42s]
[0m13:59:42.465525 [debug] [Thread-1 (]: Finished running node model.snowflake_instabee.dim_products
[0m13:59:42.465525 [debug] [Thread-1 (]: Began running node model.snowflake_instabee.dim_regions
[0m13:59:42.467532 [info ] [Thread-1 (]: 8 of 14 START sql table model DBT_.dim_regions ................................. [RUN]
[0m13:59:42.467532 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.snowflake_instabee.dim_products, now model.snowflake_instabee.dim_regions)
[0m13:59:42.467532 [debug] [Thread-1 (]: Began compiling node model.snowflake_instabee.dim_regions
[0m13:59:42.474213 [debug] [Thread-1 (]: Writing injected SQL for node "model.snowflake_instabee.dim_regions"
[0m13:59:42.474213 [debug] [Thread-1 (]: Began executing node model.snowflake_instabee.dim_regions
[0m13:59:42.482386 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.dim_regions"
[0m13:59:42.483688 [debug] [Thread-1 (]: On model.snowflake_instabee.dim_regions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.dim_regions"} */
select current_warehouse() as warehouse
[0m13:59:42.549541 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.071 seconds
[0m13:59:42.549541 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.dim_regions"
[0m13:59:42.549541 [debug] [Thread-1 (]: On model.snowflake_instabee.dim_regions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.dim_regions"} */
use warehouse pc_dbt_wh_large
[0m13:59:42.629222 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.077 seconds
[0m13:59:42.629222 [debug] [Thread-1 (]: Writing runtime sql for node "model.snowflake_instabee.dim_regions"
[0m13:59:42.629222 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.dim_regions"
[0m13:59:42.645095 [debug] [Thread-1 (]: On model.snowflake_instabee.dim_regions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.dim_regions"} */
create or replace transient table PC_DBT_DB.DBT_.dim_regions
         as
        (SELECT DISTINCT
    r.region,
    r.state,
    p.regional_manager
FROM PC_DBT_DB.DBT_.stg_instabee_orders r
LEFT JOIN PC_DBT_DB.DBT_.stg_instabee_people p
    ON r.region = p.region
        );
[0m13:59:46.290107 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.644 seconds
[0m13:59:46.303483 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.dim_regions"
[0m13:59:46.307502 [debug] [Thread-1 (]: On model.snowflake_instabee.dim_regions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.dim_regions"} */
use warehouse COMPUTE_WH
[0m13:59:46.459552 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.151 seconds
[0m13:59:46.463554 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '307f46ce-1423-433c-bad8-6ca9d59a1963', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D90489A2A0>]}
[0m13:59:46.465218 [info ] [Thread-1 (]: 8 of 14 OK created sql table model DBT_.dim_regions ............................ [[32mSUCCESS 1[0m in 4.00s]
[0m13:59:46.467415 [debug] [Thread-1 (]: Finished running node model.snowflake_instabee.dim_regions
[0m13:59:46.470141 [debug] [Thread-1 (]: Began running node model.snowflake_instabee.fact_sales
[0m13:59:46.471196 [info ] [Thread-1 (]: 9 of 14 START sql table model DBT_.fact_sales .................................. [RUN]
[0m13:59:46.473196 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.snowflake_instabee.dim_regions, now model.snowflake_instabee.fact_sales)
[0m13:59:46.474982 [debug] [Thread-1 (]: Began compiling node model.snowflake_instabee.fact_sales
[0m13:59:46.494082 [debug] [Thread-1 (]: Writing injected SQL for node "model.snowflake_instabee.fact_sales"
[0m13:59:46.500467 [debug] [Thread-1 (]: Began executing node model.snowflake_instabee.fact_sales
[0m13:59:46.511469 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.fact_sales"
[0m13:59:46.512468 [debug] [Thread-1 (]: On model.snowflake_instabee.fact_sales: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.fact_sales"} */
select current_warehouse() as warehouse
[0m13:59:46.603600 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.086 seconds
[0m13:59:46.608598 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.fact_sales"
[0m13:59:46.610599 [debug] [Thread-1 (]: On model.snowflake_instabee.fact_sales: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.fact_sales"} */
use warehouse pc_dbt_wh_large
[0m13:59:46.695836 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.083 seconds
[0m13:59:46.702669 [debug] [Thread-1 (]: Writing runtime sql for node "model.snowflake_instabee.fact_sales"
[0m13:59:46.709666 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.fact_sales"
[0m13:59:46.711667 [debug] [Thread-1 (]: On model.snowflake_instabee.fact_sales: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.fact_sales"} */
create or replace transient table PC_DBT_DB.DBT_.fact_sales
         as
        (WITH base AS (
    SELECT
        o.order_line_id,
        o.order_id,
        o.order_date,
        o.ship_date,
        o.ship_mode,
        o.customer_id,
        o.product_id,
        o.country,
        o.region,
        o.state,
        o.sales,
        o.quantity,
        o.discount,
        o.profit,
        r.returned
    FROM PC_DBT_DB.DBT_.stg_instabee_orders o
    LEFT JOIN PC_DBT_DB.DBT_.stg_instabee_returns r
        ON o.order_id = r.order_id
)

SELECT *
FROM base
        );
[0m13:59:48.597524 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.884 seconds
[0m13:59:48.601672 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.fact_sales"
[0m13:59:48.602673 [debug] [Thread-1 (]: On model.snowflake_instabee.fact_sales: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.fact_sales"} */
use warehouse COMPUTE_WH
[0m13:59:48.718159 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.114 seconds
[0m13:59:48.722159 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '307f46ce-1423-433c-bad8-6ca9d59a1963', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D904905B80>]}
[0m13:59:48.723160 [info ] [Thread-1 (]: 9 of 14 OK created sql table model DBT_.fact_sales ............................. [[32mSUCCESS 1[0m in 2.25s]
[0m13:59:48.725162 [debug] [Thread-1 (]: Finished running node model.snowflake_instabee.fact_sales
[0m13:59:48.727161 [debug] [Thread-1 (]: Began running node model.snowflake_instabee.month_on_month_change
[0m13:59:48.728162 [info ] [Thread-1 (]: 10 of 14 START sql table model DBT_.month_on_month_change ...................... [RUN]
[0m13:59:48.729162 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.snowflake_instabee.fact_sales, now model.snowflake_instabee.month_on_month_change)
[0m13:59:48.730887 [debug] [Thread-1 (]: Began compiling node model.snowflake_instabee.month_on_month_change
[0m13:59:48.738923 [debug] [Thread-1 (]: Writing injected SQL for node "model.snowflake_instabee.month_on_month_change"
[0m13:59:48.740921 [debug] [Thread-1 (]: Began executing node model.snowflake_instabee.month_on_month_change
[0m13:59:48.746922 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.month_on_month_change"
[0m13:59:48.748832 [debug] [Thread-1 (]: On model.snowflake_instabee.month_on_month_change: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.month_on_month_change"} */
select current_warehouse() as warehouse
[0m13:59:48.824808 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.075 seconds
[0m13:59:48.827810 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.month_on_month_change"
[0m13:59:48.828810 [debug] [Thread-1 (]: On model.snowflake_instabee.month_on_month_change: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.month_on_month_change"} */
use warehouse pc_dbt_wh_large
[0m13:59:48.907978 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.077 seconds
[0m13:59:48.910977 [debug] [Thread-1 (]: Writing runtime sql for node "model.snowflake_instabee.month_on_month_change"
[0m13:59:48.914978 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.month_on_month_change"
[0m13:59:48.915979 [debug] [Thread-1 (]: On model.snowflake_instabee.month_on_month_change: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.month_on_month_change"} */
create or replace transient table PC_DBT_DB.DBT_.month_on_month_change
         as
        (SELECT
    DATE_TRUNC('month', order_date) AS order_month,
    SUM(sales) AS total_sales,
    LAG(SUM(sales)) OVER (ORDER BY DATE_TRUNC('month', order_date)) AS previous_month_sales,
    SUM(sales) - LAG(SUM(sales)) OVER (ORDER BY DATE_TRUNC('month', order_date)) AS change_in_sales
FROM PC_DBT_DB.DBT_.fact_sales
WHERE EXTRACT(YEAR FROM order_date) = 2019
GROUP BY 1
        );
[0m13:59:50.087239 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.170 seconds
[0m13:59:50.090258 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.month_on_month_change"
[0m13:59:50.090258 [debug] [Thread-1 (]: On model.snowflake_instabee.month_on_month_change: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.month_on_month_change"} */
use warehouse COMPUTE_WH
[0m13:59:50.168185 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.078 seconds
[0m13:59:50.168185 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '307f46ce-1423-433c-bad8-6ca9d59a1963', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9048A9BB0>]}
[0m13:59:50.168185 [info ] [Thread-1 (]: 10 of 14 OK created sql table model DBT_.month_on_month_change ................. [[32mSUCCESS 1[0m in 1.44s]
[0m13:59:50.168185 [debug] [Thread-1 (]: Finished running node model.snowflake_instabee.month_on_month_change
[0m13:59:50.168185 [debug] [Thread-1 (]: Began running node model.snowflake_instabee.monthly_returns_per_category
[0m13:59:50.168185 [info ] [Thread-1 (]: 11 of 14 START sql table model DBT_.monthly_returns_per_category ............... [RUN]
[0m13:59:50.168185 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.snowflake_instabee.month_on_month_change, now model.snowflake_instabee.monthly_returns_per_category)
[0m13:59:50.168185 [debug] [Thread-1 (]: Began compiling node model.snowflake_instabee.monthly_returns_per_category
[0m13:59:50.184339 [debug] [Thread-1 (]: Writing injected SQL for node "model.snowflake_instabee.monthly_returns_per_category"
[0m13:59:50.184339 [debug] [Thread-1 (]: Began executing node model.snowflake_instabee.monthly_returns_per_category
[0m13:59:50.184339 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.monthly_returns_per_category"
[0m13:59:50.184339 [debug] [Thread-1 (]: On model.snowflake_instabee.monthly_returns_per_category: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.monthly_returns_per_category"} */
select current_warehouse() as warehouse
[0m13:59:50.272329 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.079 seconds
[0m13:59:50.276350 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.monthly_returns_per_category"
[0m13:59:50.278358 [debug] [Thread-1 (]: On model.snowflake_instabee.monthly_returns_per_category: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.monthly_returns_per_category"} */
use warehouse pc_dbt_wh_large
[0m13:59:50.362260 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.091 seconds
[0m13:59:50.362260 [debug] [Thread-1 (]: Writing runtime sql for node "model.snowflake_instabee.monthly_returns_per_category"
[0m13:59:50.377944 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.monthly_returns_per_category"
[0m13:59:50.377944 [debug] [Thread-1 (]: On model.snowflake_instabee.monthly_returns_per_category: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.monthly_returns_per_category"} */
create or replace transient table PC_DBT_DB.DBT_.monthly_returns_per_category
         as
        (select * from (SELECT
    DATE_TRUNC('month', s.order_date) AS order_month,
    p.product_category,P.SUB_CATEGORY,
    COUNT(CASE WHEN s.order_id IS NOT NULL and s.returned = 'Yes' THEN 1 END) AS returned_orders
FROM PC_DBT_DB.DBT_.fact_sales s
JOIN PC_DBT_DB.DBT_.dim_products p
    ON s.product_id = p.product_id
WHERE EXTRACT(YEAR FROM s.order_date) = 2019
GROUP BY 1, 2,3
ORDER BY 4 DESC)
WHERE returned_orders <>0
        );
[0m13:59:52.445244 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.063 seconds
[0m13:59:52.520859 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.monthly_returns_per_category"
[0m13:59:52.520859 [debug] [Thread-1 (]: On model.snowflake_instabee.monthly_returns_per_category: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.monthly_returns_per_category"} */
use warehouse COMPUTE_WH
[0m13:59:52.671069 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.120 seconds
[0m13:59:52.683194 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '307f46ce-1423-433c-bad8-6ca9d59a1963', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9048A4380>]}
[0m13:59:52.687193 [info ] [Thread-1 (]: 11 of 14 OK created sql table model DBT_.monthly_returns_per_category .......... [[32mSUCCESS 1[0m in 2.51s]
[0m13:59:52.690193 [debug] [Thread-1 (]: Finished running node model.snowflake_instabee.monthly_returns_per_category
[0m13:59:52.693195 [debug] [Thread-1 (]: Began running node model.snowflake_instabee.sales_growth_per_category
[0m13:59:52.694196 [info ] [Thread-1 (]: 12 of 14 START sql table model DBT_.sales_growth_per_category .................. [RUN]
[0m13:59:52.695702 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.snowflake_instabee.monthly_returns_per_category, now model.snowflake_instabee.sales_growth_per_category)
[0m13:59:52.696857 [debug] [Thread-1 (]: Began compiling node model.snowflake_instabee.sales_growth_per_category
[0m13:59:52.715590 [debug] [Thread-1 (]: Writing injected SQL for node "model.snowflake_instabee.sales_growth_per_category"
[0m13:59:52.719589 [debug] [Thread-1 (]: Began executing node model.snowflake_instabee.sales_growth_per_category
[0m13:59:52.733148 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.sales_growth_per_category"
[0m13:59:52.735149 [debug] [Thread-1 (]: On model.snowflake_instabee.sales_growth_per_category: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.sales_growth_per_category"} */
select current_warehouse() as warehouse
[0m13:59:52.817767 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.082 seconds
[0m13:59:52.821793 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.sales_growth_per_category"
[0m13:59:52.821793 [debug] [Thread-1 (]: On model.snowflake_instabee.sales_growth_per_category: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.sales_growth_per_category"} */
use warehouse pc_dbt_wh_large
[0m13:59:52.931222 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.108 seconds
[0m13:59:52.935223 [debug] [Thread-1 (]: Writing runtime sql for node "model.snowflake_instabee.sales_growth_per_category"
[0m13:59:52.939222 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.sales_growth_per_category"
[0m13:59:52.940225 [debug] [Thread-1 (]: On model.snowflake_instabee.sales_growth_per_category: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.sales_growth_per_category"} */
create or replace transient table PC_DBT_DB.DBT_.sales_growth_per_category
         as
        (SELECT
    DATE_TRUNC('month', s.order_date) AS order_month,
    p.product_category,
    SUM(s.sales) AS monthly_sales,
    LAG(SUM(s.sales)) OVER (PARTITION BY p.product_category ORDER BY DATE_TRUNC('month', s.order_date)) AS previous_month_sales,
    (SUM(s.sales) - LAG(SUM(s.sales)) OVER (PARTITION BY p.product_category ORDER BY DATE_TRUNC('month', s.order_date))) /
        NULLIF(LAG(SUM(s.sales)) OVER (PARTITION BY p.product_category ORDER BY DATE_TRUNC('month', s.order_date)), 0) AS growth_rate
FROM PC_DBT_DB.DBT_.fact_sales s
JOIN PC_DBT_DB.DBT_.dim_products p
    ON s.product_id = p.product_id
WHERE EXTRACT(YEAR FROM order_date) = 2019
GROUP BY 1, 2
        );
[0m13:59:54.141823 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.199 seconds
[0m13:59:54.146243 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.sales_growth_per_category"
[0m13:59:54.147246 [debug] [Thread-1 (]: On model.snowflake_instabee.sales_growth_per_category: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.sales_growth_per_category"} */
use warehouse COMPUTE_WH
[0m13:59:54.370019 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.221 seconds
[0m13:59:54.373020 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '307f46ce-1423-433c-bad8-6ca9d59a1963', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D90477E900>]}
[0m13:59:54.375019 [info ] [Thread-1 (]: 12 of 14 OK created sql table model DBT_.sales_growth_per_category ............. [[32mSUCCESS 1[0m in 1.68s]
[0m13:59:54.377019 [debug] [Thread-1 (]: Finished running node model.snowflake_instabee.sales_growth_per_category
[0m13:59:54.378436 [debug] [Thread-1 (]: Began running node model.snowflake_instabee.sales_over_time
[0m13:59:54.379468 [info ] [Thread-1 (]: 13 of 14 START sql table model DBT_.sales_over_time ............................ [RUN]
[0m13:59:54.382468 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.snowflake_instabee.sales_growth_per_category, now model.snowflake_instabee.sales_over_time)
[0m13:59:54.383469 [debug] [Thread-1 (]: Began compiling node model.snowflake_instabee.sales_over_time
[0m13:59:54.436065 [debug] [Thread-1 (]: Writing injected SQL for node "model.snowflake_instabee.sales_over_time"
[0m13:59:54.439066 [debug] [Thread-1 (]: Began executing node model.snowflake_instabee.sales_over_time
[0m13:59:54.456141 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.sales_over_time"
[0m13:59:54.457141 [debug] [Thread-1 (]: On model.snowflake_instabee.sales_over_time: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.sales_over_time"} */
select current_warehouse() as warehouse
[0m13:59:54.533176 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.075 seconds
[0m13:59:54.538178 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.sales_over_time"
[0m13:59:54.539179 [debug] [Thread-1 (]: On model.snowflake_instabee.sales_over_time: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.sales_over_time"} */
use warehouse pc_dbt_wh_large
[0m13:59:54.613629 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.073 seconds
[0m13:59:54.618627 [debug] [Thread-1 (]: Writing runtime sql for node "model.snowflake_instabee.sales_over_time"
[0m13:59:54.624628 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.sales_over_time"
[0m13:59:54.625627 [debug] [Thread-1 (]: On model.snowflake_instabee.sales_over_time: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.sales_over_time"} */
create or replace transient table PC_DBT_DB.DBT_.sales_over_time
         as
        (WITH monthly_sales AS (
  SELECT
      DATE_TRUNC('month', order_date) AS order_month,
      p.product_category,
      SUM(s.sales) AS category_sales
  FROM PC_DBT_DB.DBT_.fact_sales s
  JOIN PC_DBT_DB.DBT_.dim_products p
      ON s.product_id = p.product_id
  WHERE EXTRACT(YEAR FROM order_date) = 2019
  GROUP BY 1, 2
),

monthly_totals AS (
  SELECT
      order_month,
      SUM(category_sales) AS total_monthly_sales
  FROM monthly_sales
  GROUP BY 1
)

SELECT
    ms.order_month,
    ms.product_category,
    ms.category_sales,
    ROUND(ms.category_sales * 100.0 / mt.total_monthly_sales, 2) AS sales_percentage
FROM monthly_sales ms
JOIN monthly_totals mt
    ON ms.order_month = mt.order_month
ORDER BY 1, 4 DESC
        );
[0m13:59:55.748095 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.122 seconds
[0m13:59:55.752097 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.sales_over_time"
[0m13:59:55.755302 [debug] [Thread-1 (]: On model.snowflake_instabee.sales_over_time: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.sales_over_time"} */
use warehouse COMPUTE_WH
[0m13:59:55.833660 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.078 seconds
[0m13:59:55.839663 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '307f46ce-1423-433c-bad8-6ca9d59a1963', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D904839970>]}
[0m13:59:55.841661 [info ] [Thread-1 (]: 13 of 14 OK created sql table model DBT_.sales_over_time ....................... [[32mSUCCESS 1[0m in 1.46s]
[0m13:59:55.843661 [debug] [Thread-1 (]: Finished running node model.snowflake_instabee.sales_over_time
[0m13:59:55.845806 [debug] [Thread-1 (]: Began running node model.snowflake_instabee.top_selling_states_and_regions
[0m13:59:55.847803 [info ] [Thread-1 (]: 14 of 14 START sql table model DBT_.top_selling_states_and_regions ............. [RUN]
[0m13:59:55.851802 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.snowflake_instabee.sales_over_time, now model.snowflake_instabee.top_selling_states_and_regions)
[0m13:59:55.852805 [debug] [Thread-1 (]: Began compiling node model.snowflake_instabee.top_selling_states_and_regions
[0m13:59:55.866599 [debug] [Thread-1 (]: Writing injected SQL for node "model.snowflake_instabee.top_selling_states_and_regions"
[0m13:59:55.868698 [debug] [Thread-1 (]: Began executing node model.snowflake_instabee.top_selling_states_and_regions
[0m13:59:55.993662 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.top_selling_states_and_regions"
[0m13:59:55.994148 [debug] [Thread-1 (]: On model.snowflake_instabee.top_selling_states_and_regions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.top_selling_states_and_regions"} */
select current_warehouse() as warehouse
[0m13:59:56.069234 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.074 seconds
[0m13:59:56.071450 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.top_selling_states_and_regions"
[0m13:59:56.072473 [debug] [Thread-1 (]: On model.snowflake_instabee.top_selling_states_and_regions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.top_selling_states_and_regions"} */
use warehouse pc_dbt_wh_large
[0m13:59:56.153076 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.077 seconds
[0m13:59:56.161520 [debug] [Thread-1 (]: Writing runtime sql for node "model.snowflake_instabee.top_selling_states_and_regions"
[0m13:59:56.186968 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.top_selling_states_and_regions"
[0m13:59:56.189027 [debug] [Thread-1 (]: On model.snowflake_instabee.top_selling_states_and_regions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.top_selling_states_and_regions"} */
create or replace transient table PC_DBT_DB.DBT_.top_selling_states_and_regions
         as
        (WITH monthly_region_sales AS(SELECT
DATE_TRUNC('month', order_date) AS order_month,
    s.region,
    s.state,
    d.regional_manager,
    SUM(s.sales) AS region_sales
FROM PC_DBT_DB.DBT_.fact_sales s
LEFT JOIN PC_DBT_DB.DBT_.dim_regions d
    ON s.region = d.region AND s.state = d.state
WHERE EXTRACT(YEAR FROM s.order_date) = 2019
GROUP BY 1, 2, 3,4
ORDER BY region_sales DESC),

monthly_totals AS (
  SELECT
      order_month,
      SUM(region_sales) AS total_monthly_sales
  FROM monthly_region_sales
  GROUP BY 1
),

ranked_regions AS (
  SELECT
      mrs.*,
      mt.total_monthly_sales,
      ROUND(mrs.region_sales * 100.0 / mt.total_monthly_sales, 2) AS sales_percentage,
      ROW_NUMBER() OVER (PARTITION BY mrs.order_month ORDER BY mrs.region_sales DESC) AS region_rank
  FROM monthly_region_sales mrs
  JOIN monthly_totals mt
      ON mrs.order_month = mt.order_month
  WHERE mrs.order_month IS NOT NULL
)

SELECT
    order_month,
    region AS top_region,
    state AS top_state,
    regional_manager,
    region_sales,
    sales_percentage
FROM ranked_regions
WHERE region_rank = 1
ORDER BY order_month DESC
        );
[0m13:59:57.635283 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.446 seconds
[0m13:59:57.643539 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake_instabee.top_selling_states_and_regions"
[0m13:59:57.644589 [debug] [Thread-1 (]: On model.snowflake_instabee.top_selling_states_and_regions: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "instabee", "target_name": "dev", "node_id": "model.snowflake_instabee.top_selling_states_and_regions"} */
use warehouse COMPUTE_WH
[0m13:59:57.742561 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.096 seconds
[0m13:59:57.746040 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '307f46ce-1423-433c-bad8-6ca9d59a1963', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D904920E00>]}
[0m13:59:57.748040 [info ] [Thread-1 (]: 14 of 14 OK created sql table model DBT_.top_selling_states_and_regions ........ [[32mSUCCESS 1[0m in 1.90s]
[0m13:59:57.750084 [debug] [Thread-1 (]: Finished running node model.snowflake_instabee.top_selling_states_and_regions
[0m13:59:57.752083 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:59:57.753084 [debug] [MainThread]: Connection 'list_PC_DBT_DB' was left open.
[0m13:59:57.754084 [debug] [MainThread]: On list_PC_DBT_DB: Close
[0m13:59:57.884248 [debug] [MainThread]: Connection 'list_PC_DBT_DB_DBT_' was left open.
[0m13:59:57.887295 [debug] [MainThread]: On list_PC_DBT_DB_DBT_: Close
[0m13:59:58.020127 [debug] [MainThread]: Connection 'model.snowflake_instabee.top_selling_states_and_regions' was left open.
[0m13:59:58.021128 [debug] [MainThread]: On model.snowflake_instabee.top_selling_states_and_regions: Close
[0m13:59:58.143207 [info ] [MainThread]: 
[0m13:59:58.144369 [info ] [MainThread]: Finished running 10 table models, 4 view models in 0 hours 0 minutes and 31.86 seconds (31.86s).
[0m13:59:58.152931 [debug] [MainThread]: Command end result
[0m13:59:58.328995 [debug] [MainThread]: Wrote artifact WritableManifest to E:\desk\onedrive\Desktop\snowflake_instabee\target\manifest.json
[0m13:59:58.337111 [debug] [MainThread]: Wrote artifact SemanticManifest to E:\desk\onedrive\Desktop\snowflake_instabee\target\semantic_manifest.json
[0m13:59:58.404247 [debug] [MainThread]: Wrote artifact RunExecutionResult to E:\desk\onedrive\Desktop\snowflake_instabee\target\run_results.json
[0m13:59:58.406247 [info ] [MainThread]: 
[0m13:59:58.414855 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:59:58.416855 [info ] [MainThread]: 
[0m13:59:58.417854 [info ] [MainThread]: Done. PASS=14 WARN=0 ERROR=0 SKIP=0 TOTAL=14
[0m13:59:58.420854 [debug] [MainThread]: Command `dbt run` succeeded at 13:59:58.420854 after 45.32 seconds
[0m13:59:58.422854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D97992BEC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D97B295970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D979D993A0>]}
[0m13:59:58.427464 [debug] [MainThread]: Flushing usage events
[0m13:59:59.139344 [debug] [MainThread]: An error was encountered while trying to flush usage events
