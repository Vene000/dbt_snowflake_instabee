{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.9.4", "generated_at": "2025-04-22T11:59:58.145883Z", "invocation_id": "307f46ce-1423-433c-bad8-6ca9d59a1963", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-22T11:59:32.811494Z", "completed_at": "2025-04-22T11:59:32.825273Z"}, {"name": "execute", "started_at": "2025-04-22T11:59:32.827281Z", "completed_at": "2025-04-22T11:59:35.584832Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 2.7857003211975098, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bbdbcb-0001-b58c-0002-47d200097032"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.snowflake_instabee.my_first_dbt_model", "compiled": true, "compiled_code": "/*\n    Welcome to your first dbt model!\n    Did you know that you can also configure models directly within SQL files?\n    This will override configurations stated in dbt_project.yml\n\n    Try changing \"table\" to \"view\" below\n*/\n\n\n\nwith source_data as (\n    select 1 as id, 'Example record 1' as description\n    union all\n    select 2 as id, 'Example record 2' as description\n)\n\nselect *\nfrom source_data\n\n/*\n    Uncomment the line below to remove records with null `id` values\n*/\n\n-- where id is not null", "relation_name": "PC_DBT_DB.DBT_.my_first_dbt_model", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-22T11:59:35.599739Z", "completed_at": "2025-04-22T11:59:35.624627Z"}, {"name": "execute", "started_at": "2025-04-22T11:59:35.626513Z", "completed_at": "2025-04-22T11:59:36.645852Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.0461132526397705, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bbdbcb-0001-b590-0002-47d20009804a"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.snowflake_instabee.stg_instabee_orders", "compiled": true, "compiled_code": "with source as (\n\n    select * from INSTABEE.PUBLIC.ORDERS\n\n),\n\nrenamed as (\n\n    select \nmd5(cast(coalesce(cast(ORDER_ID as TEXT), '') || '-' || coalesce(cast(PRODUCT_ID as TEXT), '') || '-' || coalesce(cast(ROW_ID as TEXT), '') as TEXT)) as ORDER_LINE_ID,\nROW_ID,\nORDER_ID,\t\nORDERDATE AS ORDER_DATE,\nSHIPDATE AS SHIP_DATE,\t\nSHIP_MODE,\t\nCUSTOMER_ID,\t\nCUSTOMER_NAME,\t\nSEGMENT,\nCOUNTRY,\nCITY,\nSTATE,\t\nPOSTAL_CODE,\t\nREGION,\t\nPRODUCT_ID,\t\nCATEGORY as PRODUCT_CATEGORY,\t\nSUB_CATEGORY,\t\nPRODUCT_NAME,\t\nSALES,\t\nQUANTITY,\t\nDISCOUNT,\t\nPROFIT\n\n\n    from source\n\n)\n\nselect * from renamed", "relation_name": "PC_DBT_DB.DBT_.stg_instabee_orders", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-22T11:59:36.645852Z", "completed_at": "2025-04-22T11:59:36.661841Z"}, {"name": "execute", "started_at": "2025-04-22T11:59:36.661841Z", "completed_at": "2025-04-22T11:59:37.627735Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.9818828105926514, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bbdbcb-0001-b50d-0002-47d200089b06"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.snowflake_instabee.stg_instabee_people", "compiled": true, "compiled_code": "with source as (\n\n    select * from INSTABEE.PUBLIC.PEOPLE\n\n)\n\nselect * from source", "relation_name": "PC_DBT_DB.DBT_.stg_instabee_people", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-22T11:59:37.633495Z", "completed_at": "2025-04-22T11:59:37.633495Z"}, {"name": "execute", "started_at": "2025-04-22T11:59:37.633495Z", "completed_at": "2025-04-22T11:59:38.228162Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.596411943435669, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bbdbcb-0001-b547-0002-47d20009b042"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.snowflake_instabee.stg_instabee_returns", "compiled": true, "compiled_code": "WITH source AS (\n    SELECT * FROM INSTABEE.PUBLIC.RETURNS\n),\n\ndeduplicated AS (\n    SELECT order_id, MAX(returned) AS returned\n    FROM source\n    GROUP BY order_id\n)\n\nSELECT * FROM deduplicated", "relation_name": "PC_DBT_DB.DBT_.stg_instabee_returns", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-22T11:59:38.243832Z", "completed_at": "2025-04-22T11:59:38.249629Z"}, {"name": "execute", "started_at": "2025-04-22T11:59:38.251635Z", "completed_at": "2025-04-22T11:59:38.450347Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.2221846580505371, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bbdbcb-0001-b58c-0002-47d200097036"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.snowflake_instabee.my_second_dbt_model", "compiled": true, "compiled_code": "-- Use the `ref` function to select from other models\n\nselect *\nfrom PC_DBT_DB.DBT_.my_first_dbt_model\nwhere id = 1", "relation_name": "PC_DBT_DB.DBT_.my_second_dbt_model", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-22T11:59:38.466182Z", "completed_at": "2025-04-22T11:59:38.466182Z"}, {"name": "execute", "started_at": "2025-04-22T11:59:38.466182Z", "completed_at": "2025-04-22T11:59:41.040411Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 2.5742294788360596, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bbdbcb-0001-b590-0002-47d20009804e"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.snowflake_instabee.dim_customers", "compiled": true, "compiled_code": "SELECT DISTINCT\n    customer_id,\n    customer_name,\n    segment\nFROM PC_DBT_DB.DBT_.stg_instabee_orders", "relation_name": "PC_DBT_DB.DBT_.dim_customers", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-22T11:59:41.042160Z", "completed_at": "2025-04-22T11:59:41.042160Z"}, {"name": "execute", "started_at": "2025-04-22T11:59:41.042160Z", "completed_at": "2025-04-22T11:59:42.458264Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.4161040782928467, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bbdbcb-0001-b50d-0002-47d200089b0a"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.snowflake_instabee.dim_products", "compiled": true, "compiled_code": "WITH ranked_products AS (\n  SELECT\n    product_id,\n    product_name,\n    product_category,\n    sub_category,\n    ROW_NUMBER() OVER (\n      PARTITION BY product_id \n      ORDER BY product_category NULLS LAST, sub_category NULLS LAST, product_name NULLS LAST\n    ) as rn\n  FROM PC_DBT_DB.DBT_.stg_instabee_orders\n  WHERE product_id IS NOT NULL\n  GROUP BY product_id, product_name, product_category, sub_category\n)\n\nSELECT\n  product_id,\n  product_name,\n  product_category,\n  sub_category\nFROM ranked_products\nWHERE rn = 1", "relation_name": "PC_DBT_DB.DBT_.dim_products", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-22T11:59:42.467532Z", "completed_at": "2025-04-22T11:59:42.474213Z"}, {"name": "execute", "started_at": "2025-04-22T11:59:42.478370Z", "completed_at": "2025-04-22T11:59:46.462552Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 3.996021270751953, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bbdbcb-0001-b547-0002-47d20009b046"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.snowflake_instabee.dim_regions", "compiled": true, "compiled_code": "SELECT DISTINCT\n    r.region,\n    r.state,\n    p.regional_manager\nFROM PC_DBT_DB.DBT_.stg_instabee_orders r\nLEFT JOIN PC_DBT_DB.DBT_.stg_instabee_people p\n    ON r.region = p.region", "relation_name": "PC_DBT_DB.DBT_.dim_regions", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-22T11:59:46.475982Z", "completed_at": "2025-04-22T11:59:46.499468Z"}, {"name": "execute", "started_at": "2025-04-22T11:59:46.501467Z", "completed_at": "2025-04-22T11:59:48.721163Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 2.248967170715332, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bbdbcb-0001-b51e-0002-47d20008e0ee"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.snowflake_instabee.fact_sales", "compiled": true, "compiled_code": "WITH base AS (\n    SELECT\n        o.order_line_id,\n        o.order_id,\n        o.order_date,\n        o.ship_date,\n        o.ship_mode,\n        o.customer_id,\n        o.product_id,\n        o.country,\n        o.region,\n        o.state,\n        o.sales,\n        o.quantity,\n        o.discount,\n        o.profit,\n        r.returned\n    FROM PC_DBT_DB.DBT_.stg_instabee_orders o\n    LEFT JOIN PC_DBT_DB.DBT_.stg_instabee_returns r\n        ON o.order_id = r.order_id\n)\n\nSELECT *\nFROM base", "relation_name": "PC_DBT_DB.DBT_.fact_sales", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-22T11:59:48.731921Z", "completed_at": "2025-04-22T11:59:48.740921Z"}, {"name": "execute", "started_at": "2025-04-22T11:59:48.741924Z", "completed_at": "2025-04-22T11:59:50.168185Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.439023494720459, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bbdbcb-0001-b4ac-0002-47d200095032"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.snowflake_instabee.month_on_month_change", "compiled": true, "compiled_code": "SELECT\n    DATE_TRUNC('month', order_date) AS order_month,\n    SUM(sales) AS total_sales,\n    LAG(SUM(sales)) OVER (ORDER BY DATE_TRUNC('month', order_date)) AS previous_month_sales,\n    SUM(sales) - LAG(SUM(sales)) OVER (ORDER BY DATE_TRUNC('month', order_date)) AS change_in_sales\nFROM PC_DBT_DB.DBT_.fact_sales\nWHERE EXTRACT(YEAR FROM order_date) = 2019\nGROUP BY 1", "relation_name": "PC_DBT_DB.DBT_.month_on_month_change", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-22T11:59:50.168185Z", "completed_at": "2025-04-22T11:59:50.184339Z"}, {"name": "execute", "started_at": "2025-04-22T11:59:50.184339Z", "completed_at": "2025-04-22T11:59:52.681193Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 2.513007640838623, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bbdbcb-0001-b51a-0002-47d20009102e"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.snowflake_instabee.monthly_returns_per_category", "compiled": true, "compiled_code": "select * from (SELECT\n    DATE_TRUNC('month', s.order_date) AS order_month,\n    p.product_category,P.SUB_CATEGORY,\n    COUNT(CASE WHEN s.order_id IS NOT NULL and s.returned = 'Yes' THEN 1 END) AS returned_orders\nFROM PC_DBT_DB.DBT_.fact_sales s\nJOIN PC_DBT_DB.DBT_.dim_products p\n    ON s.product_id = p.product_id\nWHERE EXTRACT(YEAR FROM s.order_date) = 2019\nGROUP BY 1, 2,3\nORDER BY 4 DESC)\nWHERE returned_orders <>0", "relation_name": "PC_DBT_DB.DBT_.monthly_returns_per_category", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-22T11:59:52.698855Z", "completed_at": "2025-04-22T11:59:52.719589Z"}, {"name": "execute", "started_at": "2025-04-22T11:59:52.724590Z", "completed_at": "2025-04-22T11:59:54.373020Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.6773180961608887, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bbdbcb-0001-b514-0002-47d20008c0ca"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.snowflake_instabee.sales_growth_per_category", "compiled": true, "compiled_code": "SELECT\n    DATE_TRUNC('month', s.order_date) AS order_month,\n    p.product_category,\n    SUM(s.sales) AS monthly_sales,\n    LAG(SUM(s.sales)) OVER (PARTITION BY p.product_category ORDER BY DATE_TRUNC('month', s.order_date)) AS previous_month_sales,\n    (SUM(s.sales) - LAG(SUM(s.sales)) OVER (PARTITION BY p.product_category ORDER BY DATE_TRUNC('month', s.order_date))) /\n        NULLIF(LAG(SUM(s.sales)) OVER (PARTITION BY p.product_category ORDER BY DATE_TRUNC('month', s.order_date)), 0) AS growth_rate\nFROM PC_DBT_DB.DBT_.fact_sales s\nJOIN PC_DBT_DB.DBT_.dim_products p\n    ON s.product_id = p.product_id\nWHERE EXTRACT(YEAR FROM order_date) = 2019\nGROUP BY 1, 2", "relation_name": "PC_DBT_DB.DBT_.sales_growth_per_category", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-22T11:59:54.384469Z", "completed_at": "2025-04-22T11:59:54.438065Z"}, {"name": "execute", "started_at": "2025-04-22T11:59:54.440068Z", "completed_at": "2025-04-22T11:59:55.839663Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.4581966400146484, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bbdbcb-0001-b582-0002-47d200096036"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.snowflake_instabee.sales_over_time", "compiled": true, "compiled_code": "WITH monthly_sales AS (\n  SELECT\n      DATE_TRUNC('month', order_date) AS order_month,\n      p.product_category,\n      SUM(s.sales) AS category_sales\n  FROM PC_DBT_DB.DBT_.fact_sales s\n  JOIN PC_DBT_DB.DBT_.dim_products p\n      ON s.product_id = p.product_id\n  WHERE EXTRACT(YEAR FROM order_date) = 2019\n  GROUP BY 1, 2\n),\n\nmonthly_totals AS (\n  SELECT\n      order_month,\n      SUM(category_sales) AS total_monthly_sales\n  FROM monthly_sales\n  GROUP BY 1\n)\n\nSELECT\n    ms.order_month,\n    ms.product_category,\n    ms.category_sales,\n    ROUND(ms.category_sales * 100.0 / mt.total_monthly_sales, 2) AS sales_percentage\nFROM monthly_sales ms\nJOIN monthly_totals mt\n    ON ms.order_month = mt.order_month\nORDER BY 1, 4 DESC", "relation_name": "PC_DBT_DB.DBT_.sales_over_time", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-22T11:59:55.854804Z", "completed_at": "2025-04-22T11:59:55.868698Z"}, {"name": "execute", "started_at": "2025-04-22T11:59:55.869698Z", "completed_at": "2025-04-22T11:59:57.745009Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.8972375392913818, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bbdbcb-0001-b58f-0002-47d20009406a"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.snowflake_instabee.top_selling_states_and_regions", "compiled": true, "compiled_code": "WITH monthly_region_sales AS(SELECT\nDATE_TRUNC('month', order_date) AS order_month,\n    s.region,\n    s.state,\n    d.regional_manager,\n    SUM(s.sales) AS region_sales\nFROM PC_DBT_DB.DBT_.fact_sales s\nLEFT JOIN PC_DBT_DB.DBT_.dim_regions d\n    ON s.region = d.region AND s.state = d.state\nWHERE EXTRACT(YEAR FROM s.order_date) = 2019\nGROUP BY 1, 2, 3,4\nORDER BY region_sales DESC),\n\nmonthly_totals AS (\n  SELECT\n      order_month,\n      SUM(region_sales) AS total_monthly_sales\n  FROM monthly_region_sales\n  GROUP BY 1\n),\n\nranked_regions AS (\n  SELECT\n      mrs.*,\n      mt.total_monthly_sales,\n      ROUND(mrs.region_sales * 100.0 / mt.total_monthly_sales, 2) AS sales_percentage,\n      ROW_NUMBER() OVER (PARTITION BY mrs.order_month ORDER BY mrs.region_sales DESC) AS region_rank\n  FROM monthly_region_sales mrs\n  JOIN monthly_totals mt\n      ON mrs.order_month = mt.order_month\n  WHERE mrs.order_month IS NOT NULL\n)\n\nSELECT\n    order_month,\n    region AS top_region,\n    state AS top_state,\n    regional_manager,\n    region_sales,\n    sales_percentage\nFROM ranked_regions\nWHERE region_rank = 1\nORDER BY order_month DESC", "relation_name": "PC_DBT_DB.DBT_.top_selling_states_and_regions", "batch_results": null}], "elapsed_time": 31.864914417266846, "args": {"select": [], "show_resource_report": false, "log_format": "default", "exclude": [], "state_modified_compare_vars": false, "invocation_command": "dbt run", "log_format_file": "debug", "project_dir": "E:\\desk\\onedrive\\Desktop\\snowflake_instabee", "state_modified_compare_more_unrendered_values": false, "use_colors": true, "indirect_selection": "eager", "log_level_file": "debug", "strict_mode": false, "write_json": true, "print": true, "profiles_dir": "C:\\Users\\Venee\\.dbt", "require_explicit_package_overrides_for_builtin_materializations": true, "require_batched_execution_for_custom_microbatch_strategy": false, "macro_debugging": false, "log_file_max_bytes": 10485760, "which": "run", "partial_parse": true, "static_parser": true, "log_path": "E:\\desk\\onedrive\\Desktop\\snowflake_instabee\\logs", "skip_nodes_if_on_run_start_fails": false, "defer": false, "log_level": "info", "source_freshness_run_project_hooks": false, "empty": false, "quiet": false, "partial_parse_file_diff": true, "printer_width": 80, "require_nested_cumulative_type_params": false, "require_resource_names_without_spaces": false, "send_anonymous_usage_stats": true, "use_colors_file": true, "cache_selected_only": false, "vars": {}, "favor_state": false, "introspect": true, "warn_error_options": {"include": [], "exclude": []}, "require_yaml_configuration_for_mf_time_spines": false, "version_check": true, "populate_cache": true}}