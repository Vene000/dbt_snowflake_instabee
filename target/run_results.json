{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.9.4", "generated_at": "2025-04-21T02:21:18.915987Z", "invocation_id": "6078f521-51ef-4411-bbfc-d2ce3eaaa47e", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-21T02:21:01.505903Z", "completed_at": "2025-04-21T02:21:01.519690Z"}, {"name": "execute", "started_at": "2025-04-21T02:21:01.520873Z", "completed_at": "2025-04-21T02:21:02.659535Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.1548008918762207, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bbd3e9-0001-b43e-0002-47d20007152e"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.snowflake_instabee.my_first_dbt_model", "compiled": true, "compiled_code": "/*\n    Welcome to your first dbt model!\n    Did you know that you can also configure models directly within SQL files?\n    This will override configurations stated in dbt_project.yml\n\n    Try changing \"table\" to \"view\" below\n*/\n\n\n\nwith source_data as (\n    select 1 as id, 'Example record 1' as description\n    union all\n    select 2 as id, 'Example record 2' as description\n)\n\nselect *\nfrom source_data\n\n/*\n    Uncomment the line below to remove records with null `id` values\n*/\n\n-- where id is not null", "relation_name": "PC_DBT_DB.DBT_.my_first_dbt_model", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-21T02:21:02.668637Z", "completed_at": "2025-04-21T02:21:02.690857Z"}, {"name": "execute", "started_at": "2025-04-21T02:21:02.690857Z", "completed_at": "2025-04-21T02:21:03.299143Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.6318788528442383, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bbd3e9-0001-b42c-0002-47d20006f752"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.snowflake_instabee.stg_instabee_orders", "compiled": true, "compiled_code": "with source as (\n\n    select * from INSTABEE.PUBLIC.ORDERS\n\n),\n\nrenamed as (\n\n    select \nmd5(cast(coalesce(cast(ORDER_ID as TEXT), '') || '-' || coalesce(cast(PRODUCT_ID as TEXT), '') || '-' || coalesce(cast(ROW_ID as TEXT), '') as TEXT)) as ORDER_LINE_ID,\nROW_ID,\nORDER_ID,\t\nORDERDATE AS ORDER_DATE,\nSHIPDATE AS SHIP_DATE,\t\nSHIP_MODE,\t\nCUSTOMER_ID,\t\nCUSTOMER_NAME,\t\nSEGMENT,\nCOUNTRY,\nCITY,\nSTATE,\t\nPOSTAL_CODE,\t\nREGION,\t\nPRODUCT_ID,\t\nCATEGORY as PRODUCT_CATEGORY,\t\nSUB_CATEGORY,\t\nPRODUCT_NAME,\t\nSALES,\t\nQUANTITY,\t\nDISCOUNT,\t\nPROFIT\n\n\n    from source\n\n)\n\nselect * from renamed", "relation_name": "PC_DBT_DB.DBT_.stg_instabee_orders", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-21T02:21:03.305302Z", "completed_at": "2025-04-21T02:21:03.310302Z"}, {"name": "execute", "started_at": "2025-04-21T02:21:03.311304Z", "completed_at": "2025-04-21T02:21:03.887095Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.5828018188476562, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bbd3e9-0001-b465-0002-47d20007a0be"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.snowflake_instabee.stg_instabee_people", "compiled": true, "compiled_code": "with source as (\n\n    select * from INSTABEE.PUBLIC.PEOPLE\n\n)\n\nselect * from source", "relation_name": "PC_DBT_DB.DBT_.stg_instabee_people", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-21T02:21:03.892810Z", "completed_at": "2025-04-21T02:21:03.898359Z"}, {"name": "execute", "started_at": "2025-04-21T02:21:03.899358Z", "completed_at": "2025-04-21T02:21:04.348446Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.4566481113433838, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bbd3e9-0001-b46b-0002-47d20007b12a"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.snowflake_instabee.stg_instabee_returns", "compiled": true, "compiled_code": "WITH source AS (\n    SELECT * FROM INSTABEE.PUBLIC.RETURNS\n),\n\ndeduplicated AS (\n    SELECT order_id, MAX(returned) AS returned\n    FROM source\n    GROUP BY order_id\n)\n\nSELECT * FROM deduplicated", "relation_name": "PC_DBT_DB.DBT_.stg_instabee_returns", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-21T02:21:04.354115Z", "completed_at": "2025-04-21T02:21:04.359124Z"}, {"name": "execute", "started_at": "2025-04-21T02:21:04.359124Z", "completed_at": "2025-04-21T02:21:04.586261Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.23348617553710938, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bbd3e9-0001-b465-0002-47d20007a0c2"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.snowflake_instabee.my_second_dbt_model", "compiled": true, "compiled_code": "-- Use the `ref` function to select from other models\n\nselect *\nfrom PC_DBT_DB.DBT_.my_first_dbt_model\nwhere id = 1", "relation_name": "PC_DBT_DB.DBT_.my_second_dbt_model", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-21T02:21:04.592572Z", "completed_at": "2025-04-21T02:21:04.597616Z"}, {"name": "execute", "started_at": "2025-04-21T02:21:04.598619Z", "completed_at": "2025-04-21T02:21:06.679016Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 2.0884499549865723, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bbd3e9-0001-b44a-0002-47d20007565a"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.snowflake_instabee.dim_customers", "compiled": true, "compiled_code": "SELECT DISTINCT\n    customer_id,\n    customer_name,\n    segment\nFROM PC_DBT_DB.DBT_.stg_instabee_orders", "relation_name": "PC_DBT_DB.DBT_.dim_customers", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-21T02:21:06.685207Z", "completed_at": "2025-04-21T02:21:06.690215Z"}, {"name": "execute", "started_at": "2025-04-21T02:21:06.690215Z", "completed_at": "2025-04-21T02:21:07.744082Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.0598878860473633, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bbd3e9-0001-b42c-0002-47d20006f75e"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.snowflake_instabee.dim_products", "compiled": true, "compiled_code": "WITH ranked_products AS (\n  SELECT\n    product_id,\n    product_name,\n    product_category,\n    sub_category,\n    ROW_NUMBER() OVER (\n      PARTITION BY product_id \n      ORDER BY product_category NULLS LAST, sub_category NULLS LAST, product_name NULLS LAST\n    ) as rn\n  FROM PC_DBT_DB.DBT_.stg_instabee_orders\n  WHERE product_id IS NOT NULL\n  GROUP BY product_id, product_name, product_category, sub_category\n)\n\nSELECT\n  product_id,\n  product_name,\n  product_category,\n  sub_category\nFROM ranked_products\nWHERE rn = 1", "relation_name": "PC_DBT_DB.DBT_.dim_products", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-21T02:21:07.751608Z", "completed_at": "2025-04-21T02:21:07.758091Z"}, {"name": "execute", "started_at": "2025-04-21T02:21:07.759549Z", "completed_at": "2025-04-21T02:21:09.489788Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.7403218746185303, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bbd3e9-0001-b465-0002-47d20007a0ca"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.snowflake_instabee.dim_regions", "compiled": true, "compiled_code": "SELECT DISTINCT\n    r.region,\n    r.state,\n    p.regional_manager\nFROM PC_DBT_DB.DBT_.stg_instabee_orders r\nLEFT JOIN PC_DBT_DB.DBT_.stg_instabee_people p\n    ON r.region = p.region", "relation_name": "PC_DBT_DB.DBT_.dim_regions", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-21T02:21:09.498978Z", "completed_at": "2025-04-21T02:21:09.505026Z"}, {"name": "execute", "started_at": "2025-04-21T02:21:09.506034Z", "completed_at": "2025-04-21T02:21:12.300774Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 2.8040735721588135, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bbd3e9-0001-b46b-0002-47d20007b132"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.snowflake_instabee.fact_sales", "compiled": true, "compiled_code": "WITH base AS (\n    SELECT\n        o.order_line_id,\n        o.order_id,\n        o.order_date,\n        o.ship_date,\n        o.ship_mode,\n        o.customer_id,\n        o.product_id,\n        o.country,\n        o.region,\n        o.state,\n        o.sales,\n        o.quantity,\n        o.discount,\n        o.profit,\n        r.returned\n    FROM PC_DBT_DB.DBT_.stg_instabee_orders o\n    LEFT JOIN PC_DBT_DB.DBT_.stg_instabee_returns r\n        ON o.order_id = r.order_id\n)\n\nSELECT *\nFROM base", "relation_name": "PC_DBT_DB.DBT_.fact_sales", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-21T02:21:12.307543Z", "completed_at": "2025-04-21T02:21:12.313827Z"}, {"name": "execute", "started_at": "2025-04-21T02:21:12.313827Z", "completed_at": "2025-04-21T02:21:13.433927Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.128368854522705, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bbd3e9-0001-b44a-0002-47d200075666"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.snowflake_instabee.month_on_month_change", "compiled": true, "compiled_code": "SELECT\n    DATE_TRUNC('month', order_date) AS order_month,\n    SUM(sales) AS total_sales,\n    LAG(SUM(sales)) OVER (ORDER BY DATE_TRUNC('month', order_date)) AS previous_month_sales,\n    SUM(sales) - LAG(SUM(sales)) OVER (ORDER BY DATE_TRUNC('month', order_date)) AS change_in_sales\nFROM PC_DBT_DB.DBT_.fact_sales\nWHERE EXTRACT(YEAR FROM order_date) = 2019\nGROUP BY 1", "relation_name": "PC_DBT_DB.DBT_.month_on_month_change", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-21T02:21:13.438677Z", "completed_at": "2025-04-21T02:21:13.448208Z"}, {"name": "execute", "started_at": "2025-04-21T02:21:13.449214Z", "completed_at": "2025-04-21T02:21:14.717825Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.2806105613708496, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bbd3e9-0001-b44c-0002-47d20007817a"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.snowflake_instabee.monthly_returns_per_category", "compiled": true, "compiled_code": "select * from (SELECT\n    DATE_TRUNC('month', s.order_date) AS order_month,\n    p.product_category,P.SUB_CATEGORY,\n    COUNT(CASE WHEN s.order_id IS NOT NULL and s.returned = 'Yes' THEN 1 END) AS returned_orders\nFROM PC_DBT_DB.DBT_.fact_sales s\nJOIN PC_DBT_DB.DBT_.dim_products p\n    ON s.product_id = p.product_id\nWHERE EXTRACT(YEAR FROM s.order_date) = 2019\nGROUP BY 1, 2,3\nORDER BY 4 DESC)\nWHERE returned_orders <>0", "relation_name": "PC_DBT_DB.DBT_.monthly_returns_per_category", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-21T02:21:14.725111Z", "completed_at": "2025-04-21T02:21:14.733165Z"}, {"name": "execute", "started_at": "2025-04-21T02:21:14.733165Z", "completed_at": "2025-04-21T02:21:15.961936Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.2398149967193604, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bbd3e9-0001-b43e-0002-47d200071546"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.snowflake_instabee.sales_growth_per_category", "compiled": true, "compiled_code": "SELECT\n    DATE_TRUNC('month', s.order_date) AS order_month,\n    p.product_category,\n    SUM(s.sales) AS monthly_sales,\n    LAG(SUM(s.sales)) OVER (PARTITION BY p.product_category ORDER BY DATE_TRUNC('month', s.order_date)) AS previous_month_sales,\n    (SUM(s.sales) - LAG(SUM(s.sales)) OVER (PARTITION BY p.product_category ORDER BY DATE_TRUNC('month', s.order_date))) /\n        NULLIF(LAG(SUM(s.sales)) OVER (PARTITION BY p.product_category ORDER BY DATE_TRUNC('month', s.order_date)), 0) AS growth_rate\nFROM PC_DBT_DB.DBT_.fact_sales s\nJOIN PC_DBT_DB.DBT_.dim_products p\n    ON s.product_id = p.product_id\nWHERE EXTRACT(YEAR FROM order_date) = 2019\nGROUP BY 1, 2", "relation_name": "PC_DBT_DB.DBT_.sales_growth_per_category", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-21T02:21:15.967453Z", "completed_at": "2025-04-21T02:21:15.972564Z"}, {"name": "execute", "started_at": "2025-04-21T02:21:15.972564Z", "completed_at": "2025-04-21T02:21:17.120590Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.1541481018066406, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bbd3e9-0001-b46b-0002-47d20007b13e"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.snowflake_instabee.sales_over_time", "compiled": true, "compiled_code": "WITH monthly_sales AS (\n  SELECT\n      DATE_TRUNC('month', order_date) AS order_month,\n      p.product_category,\n      SUM(s.sales) AS category_sales\n  FROM PC_DBT_DB.DBT_.fact_sales s\n  JOIN PC_DBT_DB.DBT_.dim_products p\n      ON s.product_id = p.product_id\n  WHERE EXTRACT(YEAR FROM order_date) = 2019\n  GROUP BY 1, 2\n),\n\nmonthly_totals AS (\n  SELECT\n      order_month,\n      SUM(category_sales) AS total_monthly_sales\n  FROM monthly_sales\n  GROUP BY 1\n)\n\nSELECT\n    ms.order_month,\n    ms.product_category,\n    ms.category_sales,\n    ROUND(ms.category_sales * 100.0 / mt.total_monthly_sales, 2) AS sales_percentage\nFROM monthly_sales ms\nJOIN monthly_totals mt\n    ON ms.order_month = mt.order_month\nORDER BY 1, 4 DESC", "relation_name": "PC_DBT_DB.DBT_.sales_over_time", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-21T02:21:17.130349Z", "completed_at": "2025-04-21T02:21:17.137405Z"}, {"name": "execute", "started_at": "2025-04-21T02:21:17.138775Z", "completed_at": "2025-04-21T02:21:18.456725Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.3283884525299072, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bbd3e9-0001-b44a-0002-47d200075672"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.snowflake_instabee.top_selling_states_and_regions", "compiled": true, "compiled_code": "WITH monthly_region_sales AS(SELECT\nDATE_TRUNC('month', order_date) AS order_month,\n    s.region,\n    s.state,\n    d.regional_manager,\n    SUM(s.sales) AS region_sales\nFROM PC_DBT_DB.DBT_.fact_sales s\nLEFT JOIN PC_DBT_DB.DBT_.dim_regions d\n    ON s.region = d.region AND s.state = d.state\nWHERE EXTRACT(YEAR FROM s.order_date) = 2019\nGROUP BY 1, 2, 3,4\nORDER BY region_sales DESC),\n\nmonthly_totals AS (\n  SELECT\n      order_month,\n      SUM(region_sales) AS total_monthly_sales\n  FROM monthly_region_sales\n  GROUP BY 1\n),\n\nranked_regions AS (\n  SELECT\n      mrs.*,\n      mt.total_monthly_sales,\n      ROUND(mrs.region_sales * 100.0 / mt.total_monthly_sales, 2) AS sales_percentage,\n      ROW_NUMBER() OVER (PARTITION BY mrs.order_month ORDER BY mrs.region_sales DESC) AS region_rank\n  FROM monthly_region_sales mrs\n  JOIN monthly_totals mt\n      ON mrs.order_month = mt.order_month\n  WHERE mrs.order_month IS NOT NULL\n)\n\nSELECT\n    order_month,\n    region AS top_region,\n    state AS top_state,\n    regional_manager,\n    region_sales,\n    sales_percentage\nFROM ranked_regions\nWHERE region_rank = 1\nORDER BY order_month DESC", "relation_name": "PC_DBT_DB.DBT_.top_selling_states_and_regions", "batch_results": null}], "elapsed_time": 18.70931839942932, "args": {"defer": false, "introspect": true, "use_colors": true, "state_modified_compare_more_unrendered_values": false, "vars": {}, "require_batched_execution_for_custom_microbatch_strategy": false, "populate_cache": true, "state_modified_compare_vars": false, "log_level": "info", "print": true, "which": "run", "partial_parse": true, "cache_selected_only": false, "require_resource_names_without_spaces": false, "select": [], "warn_error_options": {"include": [], "exclude": []}, "empty": false, "require_yaml_configuration_for_mf_time_spines": false, "skip_nodes_if_on_run_start_fails": false, "source_freshness_run_project_hooks": false, "quiet": false, "require_nested_cumulative_type_params": false, "favor_state": false, "partial_parse_file_diff": true, "invocation_command": "dbt run", "project_dir": "E:\\desk\\onedrive\\Desktop\\snowflake_instabee", "log_path": "E:\\desk\\onedrive\\Desktop\\snowflake_instabee\\logs", "profiles_dir": "C:\\Users\\Venee\\.dbt", "log_level_file": "debug", "require_explicit_package_overrides_for_builtin_materializations": true, "strict_mode": false, "static_parser": true, "macro_debugging": false, "write_json": true, "printer_width": 80, "log_format": "default", "log_file_max_bytes": 10485760, "exclude": [], "show_resource_report": false, "use_colors_file": true, "version_check": true, "send_anonymous_usage_stats": true, "indirect_selection": "eager", "log_format_file": "debug"}}