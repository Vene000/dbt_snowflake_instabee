{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.9.4", "generated_at": "2025-04-22T12:14:28.493906Z", "invocation_id": "a22155ce-1904-4ec4-a3e8-72fa30866219", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-22T12:14:11.781124Z", "completed_at": "2025-04-22T12:14:11.865687Z"}, {"name": "execute", "started_at": "2025-04-22T12:14:11.865687Z", "completed_at": "2025-04-22T12:14:13.161137Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.3837645053863525, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bbdbda-0001-b51e-0002-47d20008e0f6"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.snowflake_instabee.my_first_dbt_model", "compiled": true, "compiled_code": "/*\n    Welcome to your first dbt model!\n    Did you know that you can also configure models directly within SQL files?\n    This will override configurations stated in dbt_project.yml\n\n    Try changing \"table\" to \"view\" below\n*/\n\n\n\nwith source_data as (\n    select 1 as id, 'Example record 1' as description\n    union all\n    select 2 as id, 'Example record 2' as description\n)\n\nselect *\nfrom source_data\n\n/*\n    Uncomment the line below to remove records with null `id` values\n*/\n\n-- where id is not null", "relation_name": "PC_DBT_DB.DBT_.my_first_dbt_model", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-22T12:14:13.170255Z", "completed_at": "2025-04-22T12:14:13.176275Z"}, {"name": "execute", "started_at": "2025-04-22T12:14:13.178284Z", "completed_at": "2025-04-22T12:14:13.893856Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.7266912460327148, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bbdbda-0001-b507-0002-47d2000810c6"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.snowflake_instabee.stg_instabee_orders", "compiled": true, "compiled_code": "with source as (\n\n    select * from INSTABEE.PUBLIC.ORDERS\n\n),\n\nrenamed as (\n\n    select \nmd5(concat(coalesce(cast(ORDER_ID as TEXT), ''), coalesce(cast(PRODUCT_ID as TEXT), ''), coalesce(cast(ROW_ID as TEXT), ''))) as ORDER_LINE_ID,\nROW_ID,\nORDER_ID,\t\nORDERDATE AS ORDER_DATE,\nSHIPDATE AS SHIP_DATE,\t\nSHIP_MODE,\t\nCUSTOMER_ID,\t\nCUSTOMER_NAME,\t\nSEGMENT,\nCOUNTRY,\nCITY,\nSTATE,\t\nPOSTAL_CODE,\t\nREGION,\t\nPRODUCT_ID,\t\nCATEGORY as PRODUCT_CATEGORY,\t\nSUB_CATEGORY,\t\nPRODUCT_NAME,\t\nSALES,\t\nQUANTITY,\t\nDISCOUNT,\t\nPROFIT\n\n\n    from source\n\n)\n\nselect * from renamed", "relation_name": "PC_DBT_DB.DBT_.stg_instabee_orders", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-22T12:14:13.909559Z", "completed_at": "2025-04-22T12:14:13.909559Z"}, {"name": "execute", "started_at": "2025-04-22T12:14:13.909559Z", "completed_at": "2025-04-22T12:14:14.421298Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.5117390155792236, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bbdbda-0001-b547-0002-47d20009b04e"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.snowflake_instabee.stg_instabee_people", "compiled": true, "compiled_code": "with source as (\n\n    select * from INSTABEE.PUBLIC.PEOPLE\n\n)\n\nselect * from source", "relation_name": "PC_DBT_DB.DBT_.stg_instabee_people", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-22T12:14:14.437072Z", "completed_at": "2025-04-22T12:14:14.437072Z"}, {"name": "execute", "started_at": "2025-04-22T12:14:14.437072Z", "completed_at": "2025-04-22T12:14:14.951886Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.5265014171600342, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bbdbda-0001-b582-0002-47d20009603e"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.snowflake_instabee.stg_instabee_returns", "compiled": true, "compiled_code": "WITH source AS (\n    SELECT * FROM INSTABEE.PUBLIC.RETURNS\n),\n\ndeduplicated AS (\n    SELECT order_id, MAX(returned) AS returned\n    FROM source\n    GROUP BY order_id\n)\n\nSELECT * FROM deduplicated", "relation_name": "PC_DBT_DB.DBT_.stg_instabee_returns", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-22T12:14:14.966109Z", "completed_at": "2025-04-22T12:14:14.976086Z"}, {"name": "execute", "started_at": "2025-04-22T12:14:14.978094Z", "completed_at": "2025-04-22T12:14:15.202282Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.23617291450500488, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bbdbda-0001-b529-0002-47d20008d0c2"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.snowflake_instabee.my_second_dbt_model", "compiled": true, "compiled_code": "-- Use the `ref` function to select from other models\n\nselect *\nfrom PC_DBT_DB.DBT_.my_first_dbt_model\nwhere id = 1", "relation_name": "PC_DBT_DB.DBT_.my_second_dbt_model", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-22T12:14:15.209072Z", "completed_at": "2025-04-22T12:14:15.215092Z"}, {"name": "execute", "started_at": "2025-04-22T12:14:15.215092Z", "completed_at": "2025-04-22T12:14:16.870563Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.664262294769287, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bbdbda-0001-b58c-0002-47d200097046"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.snowflake_instabee.dim_customers", "compiled": true, "compiled_code": "SELECT DISTINCT\n    customer_id,\n    customer_name,\n    segment\nFROM PC_DBT_DB.DBT_.stg_instabee_orders", "relation_name": "PC_DBT_DB.DBT_.dim_customers", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-22T12:14:16.892228Z", "completed_at": "2025-04-22T12:14:16.898250Z"}, {"name": "execute", "started_at": "2025-04-22T12:14:16.898250Z", "completed_at": "2025-04-22T12:14:18.543668Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.6574294567108154, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bbdbda-0001-b55a-0002-47d20009a04a"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.snowflake_instabee.dim_products", "compiled": true, "compiled_code": "WITH ranked_products AS (\n  SELECT\n    product_id,\n    product_name,\n    product_category,\n    sub_category,\n    ROW_NUMBER() OVER (\n      PARTITION BY product_id \n      ORDER BY product_category NULLS LAST, sub_category NULLS LAST, product_name NULLS LAST\n    ) as rn\n  FROM PC_DBT_DB.DBT_.stg_instabee_orders\n  WHERE product_id IS NOT NULL\n  GROUP BY product_id, product_name, product_category, sub_category\n)\n\nSELECT\n  product_id,\n  product_name,\n  product_category,\n  sub_category\nFROM ranked_products\nWHERE rn = 1", "relation_name": "PC_DBT_DB.DBT_.dim_products", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-22T12:14:18.543668Z", "completed_at": "2025-04-22T12:14:18.543668Z"}, {"name": "execute", "started_at": "2025-04-22T12:14:18.543668Z", "completed_at": "2025-04-22T12:14:20.325920Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.7822518348693848, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bbdbda-0001-b51e-0002-47d20008e0fe"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.snowflake_instabee.dim_regions", "compiled": true, "compiled_code": "SELECT DISTINCT\n    r.region,\n    r.state,\n    p.regional_manager\nFROM PC_DBT_DB.DBT_.stg_instabee_orders r\nLEFT JOIN PC_DBT_DB.DBT_.stg_instabee_people p\n    ON r.region = p.region", "relation_name": "PC_DBT_DB.DBT_.dim_regions", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-22T12:14:20.332951Z", "completed_at": "2025-04-22T12:14:20.342992Z"}, {"name": "execute", "started_at": "2025-04-22T12:14:20.342992Z", "completed_at": "2025-04-22T12:14:22.051342Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.7193989753723145, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bbdbda-0001-b58c-0002-47d20009704a"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.snowflake_instabee.fact_sales", "compiled": true, "compiled_code": "WITH base AS (\n    SELECT\n        o.order_line_id,\n        o.order_id,\n        o.order_date,\n        o.ship_date,\n        o.ship_mode,\n        o.customer_id,\n        o.product_id,\n        o.country,\n        o.region,\n        o.state,\n        o.sales,\n        o.quantity,\n        o.discount,\n        o.profit,\n        r.returned\n    FROM PC_DBT_DB.DBT_.stg_instabee_orders o\n    LEFT JOIN PC_DBT_DB.DBT_.stg_instabee_returns r\n        ON o.order_id = r.order_id\n)\n\nSELECT *\nFROM base", "relation_name": "PC_DBT_DB.DBT_.fact_sales", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-22T12:14:22.061385Z", "completed_at": "2025-04-22T12:14:22.071001Z"}, {"name": "execute", "started_at": "2025-04-22T12:14:22.071001Z", "completed_at": "2025-04-22T12:14:23.319001Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.2576167583465576, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bbdbda-0001-b55a-0002-47d20009a04e"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.snowflake_instabee.month_on_month_change", "compiled": true, "compiled_code": "SELECT\n    DATE_TRUNC('month', order_date) AS order_month,\n    SUM(sales) AS total_sales,\n    LAG(SUM(sales)) OVER (ORDER BY DATE_TRUNC('month', order_date)) AS previous_month_sales,\n    SUM(sales) - LAG(SUM(sales)) OVER (ORDER BY DATE_TRUNC('month', order_date)) AS change_in_sales\nFROM PC_DBT_DB.DBT_.fact_sales\nWHERE EXTRACT(YEAR FROM order_date) = 2019\nGROUP BY 1", "relation_name": "PC_DBT_DB.DBT_.month_on_month_change", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-22T12:14:23.319001Z", "completed_at": "2025-04-22T12:14:23.319001Z"}, {"name": "execute", "started_at": "2025-04-22T12:14:23.319001Z", "completed_at": "2025-04-22T12:14:24.577538Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.2585365772247314, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bbdbda-0001-b51e-0002-47d20008e102"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.snowflake_instabee.monthly_returns_per_category", "compiled": true, "compiled_code": "select * from (SELECT\n    DATE_TRUNC('month', s.order_date) AS order_month,\n    p.product_category,P.SUB_CATEGORY,\n    COUNT(CASE WHEN s.order_id IS NOT NULL and s.returned = 'Yes' THEN 1 END) AS returned_orders\nFROM PC_DBT_DB.DBT_.fact_sales s\nJOIN PC_DBT_DB.DBT_.dim_products p\n    ON s.product_id = p.product_id\nWHERE EXTRACT(YEAR FROM s.order_date) = 2019\nGROUP BY 1, 2,3\nORDER BY 4 DESC)\nWHERE returned_orders <>0", "relation_name": "PC_DBT_DB.DBT_.monthly_returns_per_category", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-22T12:14:24.577538Z", "completed_at": "2025-04-22T12:14:24.577538Z"}, {"name": "execute", "started_at": "2025-04-22T12:14:24.577538Z", "completed_at": "2025-04-22T12:14:25.778544Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.2010064125061035, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bbdbda-0001-b58c-0002-47d20009704e"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.snowflake_instabee.sales_growth_per_category", "compiled": true, "compiled_code": "SELECT\n    DATE_TRUNC('month', s.order_date) AS order_month,\n    p.product_category,\n    SUM(s.sales) AS monthly_sales,\n    LAG(SUM(s.sales)) OVER (PARTITION BY p.product_category ORDER BY DATE_TRUNC('month', s.order_date)) AS previous_month_sales,\n    (SUM(s.sales) - LAG(SUM(s.sales)) OVER (PARTITION BY p.product_category ORDER BY DATE_TRUNC('month', s.order_date))) /\n        NULLIF(LAG(SUM(s.sales)) OVER (PARTITION BY p.product_category ORDER BY DATE_TRUNC('month', s.order_date)), 0) AS growth_rate\nFROM PC_DBT_DB.DBT_.fact_sales s\nJOIN PC_DBT_DB.DBT_.dim_products p\n    ON s.product_id = p.product_id\nWHERE EXTRACT(YEAR FROM order_date) = 2019\nGROUP BY 1, 2", "relation_name": "PC_DBT_DB.DBT_.sales_growth_per_category", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-22T12:14:25.780554Z", "completed_at": "2025-04-22T12:14:25.789430Z"}, {"name": "execute", "started_at": "2025-04-22T12:14:25.791438Z", "completed_at": "2025-04-22T12:14:26.927920Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.1473660469055176, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bbdbda-0001-b55a-0002-47d20009a052"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.snowflake_instabee.sales_over_time", "compiled": true, "compiled_code": "WITH monthly_sales AS (\n  SELECT\n      DATE_TRUNC('month', order_date) AS order_month,\n      p.product_category,\n      SUM(s.sales) AS category_sales\n  FROM PC_DBT_DB.DBT_.fact_sales s\n  JOIN PC_DBT_DB.DBT_.dim_products p\n      ON s.product_id = p.product_id\n  WHERE EXTRACT(YEAR FROM order_date) = 2019\n  GROUP BY 1, 2\n),\n\nmonthly_totals AS (\n  SELECT\n      order_month,\n      SUM(category_sales) AS total_monthly_sales\n  FROM monthly_sales\n  GROUP BY 1\n)\n\nSELECT\n    ms.order_month,\n    ms.product_category,\n    ms.category_sales,\n    ROUND(ms.category_sales * 100.0 / mt.total_monthly_sales, 2) AS sales_percentage\nFROM monthly_sales ms\nJOIN monthly_totals mt\n    ON ms.order_month = mt.order_month\nORDER BY 1, 4 DESC", "relation_name": "PC_DBT_DB.DBT_.sales_over_time", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-22T12:14:26.948122Z", "completed_at": "2025-04-22T12:14:27.022770Z"}, {"name": "execute", "started_at": "2025-04-22T12:14:27.022770Z", "completed_at": "2025-04-22T12:14:28.136967Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.1911261081695557, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bbdbda-0001-b51e-0002-47d20008e106"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.snowflake_instabee.top_selling_states_and_regions", "compiled": true, "compiled_code": "WITH monthly_region_sales AS(SELECT\nDATE_TRUNC('month', order_date) AS order_month,\n    s.region,\n    s.state,\n    d.regional_manager,\n    SUM(s.sales) AS region_sales\nFROM PC_DBT_DB.DBT_.fact_sales s\nLEFT JOIN PC_DBT_DB.DBT_.dim_regions d\n    ON s.region = d.region AND s.state = d.state\nWHERE EXTRACT(YEAR FROM s.order_date) = 2019\nGROUP BY 1, 2, 3,4\nORDER BY region_sales DESC),\n\nmonthly_totals AS (\n  SELECT\n      order_month,\n      SUM(region_sales) AS total_monthly_sales\n  FROM monthly_region_sales\n  GROUP BY 1\n),\n\nranked_regions AS (\n  SELECT\n      mrs.*,\n      mt.total_monthly_sales,\n      ROUND(mrs.region_sales * 100.0 / mt.total_monthly_sales, 2) AS sales_percentage,\n      ROW_NUMBER() OVER (PARTITION BY mrs.order_month ORDER BY mrs.region_sales DESC) AS region_rank\n  FROM monthly_region_sales mrs\n  JOIN monthly_totals mt\n      ON mrs.order_month = mt.order_month\n  WHERE mrs.order_month IS NOT NULL\n)\n\nSELECT\n    order_month,\n    region AS top_region,\n    state AS top_state,\n    regional_manager,\n    region_sales,\n    sales_percentage\nFROM ranked_regions\nWHERE region_rank = 1\nORDER BY order_month DESC", "relation_name": "PC_DBT_DB.DBT_.top_selling_states_and_regions", "batch_results": null}], "elapsed_time": 17.984694480895996, "args": {"log_level_file": "debug", "strict_mode": false, "exclude": [], "empty": false, "show_resource_report": false, "partial_parse": true, "use_colors": true, "partial_parse_file_diff": true, "version_check": true, "state_modified_compare_vars": false, "log_format_file": "debug", "require_nested_cumulative_type_params": false, "print": true, "state_modified_compare_more_unrendered_values": false, "indirect_selection": "eager", "send_anonymous_usage_stats": true, "printer_width": 80, "introspect": true, "require_resource_names_without_spaces": false, "require_batched_execution_for_custom_microbatch_strategy": false, "log_path": "E:\\desk\\onedrive\\Desktop\\snowflake_instabee\\logs", "profiles_dir": "C:\\Users\\Venee\\.dbt", "log_format": "default", "require_explicit_package_overrides_for_builtin_materializations": true, "macro_debugging": false, "invocation_command": "dbt run", "write_json": true, "which": "run", "cache_selected_only": false, "quiet": false, "static_parser": true, "require_yaml_configuration_for_mf_time_spines": false, "favor_state": false, "skip_nodes_if_on_run_start_fails": false, "project_dir": "E:\\desk\\onedrive\\Desktop\\snowflake_instabee", "select": [], "source_freshness_run_project_hooks": false, "log_file_max_bytes": 10485760, "use_colors_file": true, "warn_error_options": {"include": [], "exclude": []}, "log_level": "info", "defer": false, "populate_cache": true, "vars": {}}}