{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.9.4", "generated_at": "2025-04-22T12:47:34.961709Z", "invocation_id": "5dfa87a8-fdb8-4978-858b-6c1cb9862838", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-22T12:47:12.548196Z", "completed_at": "2025-04-22T12:47:12.563496Z"}, {"name": "execute", "started_at": "2025-04-22T12:47:12.564507Z", "completed_at": "2025-04-22T12:47:13.885964Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.3392314910888672, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bbdbfb-0001-b507-0002-47d2000810ea"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.snowflake_instabee.my_first_dbt_model", "compiled": true, "compiled_code": "/*\n    Welcome to your first dbt model!\n    Did you know that you can also configure models directly within SQL files?\n    This will override configurations stated in dbt_project.yml\n\n    Try changing \"table\" to \"view\" below\n*/\n\n\n\nwith source_data as (\n    select 1 as id, 'Example record 1' as description\n    union all\n    select 2 as id, 'Example record 2' as description\n)\n\nselect *\nfrom source_data\n\n/*\n    Uncomment the line below to remove records with null `id` values\n*/\n\n-- where id is not null", "relation_name": "PC_DBT_DB.DBT_.my_first_dbt_model", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-22T12:47:13.894929Z", "completed_at": "2025-04-22T12:47:13.901321Z"}, {"name": "execute", "started_at": "2025-04-22T12:47:13.902435Z", "completed_at": "2025-04-22T12:47:14.495908Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.6029829978942871, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bbdbfb-0001-b58c-0002-47d200097062"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.snowflake_instabee.stg_instabee_people", "compiled": true, "compiled_code": "with source as (\n\n    select * from INSTABEE.PUBLIC.PEOPLE\n\n)\n\nselect * from source", "relation_name": "PC_DBT_DB.DBT_.stg_instabee_people", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-22T12:47:14.506648Z", "completed_at": "2025-04-22T12:47:14.513701Z"}, {"name": "execute", "started_at": "2025-04-22T12:47:14.515990Z", "completed_at": "2025-04-22T12:47:15.034986Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.5306665897369385, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bbdbfb-0001-b547-0002-47d20009b072"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.snowflake_instabee.stg_instabee_returns", "compiled": true, "compiled_code": "WITH source AS (\n    SELECT * FROM INSTABEE.PUBLIC.RETURNS\n),\n\ndeduplicated AS (\n    SELECT order_id, MAX(returned) AS returned\n    FROM source\n    GROUP BY order_id\n)\n\nSELECT * FROM deduplicated", "relation_name": "PC_DBT_DB.DBT_.stg_instabee_returns", "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-04-22T12:47:15.041572Z", "completed_at": "2025-04-22T12:47:15.050592Z"}, {"name": "execute", "started_at": "2025-04-22T12:47:15.051479Z", "completed_at": "2025-04-22T12:47:15.280544Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.24044132232666016, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bbdbfb-0001-b582-0002-47d200096066"}, "message": null, "failures": 0, "unique_id": "test.snowflake_instabee.dbt_utils_source_unique_combination_of_columns_instabee_ORDERS_ORDER_ID__PRODUCT_ID__ROW_ID.3f9cb81a91", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        ORDER_ID, PRODUCT_ID, ROW_ID\n    from INSTABEE.PUBLIC.ORDERS\n    group by ORDER_ID, PRODUCT_ID, ROW_ID\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-04-22T12:47:15.286700Z", "completed_at": "2025-04-22T12:47:15.300694Z"}, {"name": "execute", "started_at": "2025-04-22T12:47:15.301711Z", "completed_at": "2025-04-22T12:47:15.434309Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.1487424373626709, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bbdbfb-0001-b50d-0002-47d200089b36"}, "message": null, "failures": 0, "unique_id": "test.snowflake_instabee.source_not_null_instabee_ORDERS_ORDER_ID.160b834fca", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect ORDER_ID\nfrom INSTABEE.PUBLIC.ORDERS\nwhere ORDER_ID is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-04-22T12:47:15.440019Z", "completed_at": "2025-04-22T12:47:15.446049Z"}, {"name": "execute", "started_at": "2025-04-22T12:47:15.446049Z", "completed_at": "2025-04-22T12:47:15.537769Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.09910392761230469, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bbdbfb-0001-b507-0002-47d2000810ee"}, "message": null, "failures": 0, "unique_id": "test.snowflake_instabee.source_not_null_instabee_ORDERS_ROW_ID.e0a4286d0b", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect ROW_ID\nfrom INSTABEE.PUBLIC.ORDERS\nwhere ROW_ID is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-04-22T12:47:15.543236Z", "completed_at": "2025-04-22T12:47:15.627268Z"}, {"name": "execute", "started_at": "2025-04-22T12:47:15.628271Z", "completed_at": "2025-04-22T12:47:15.759948Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.21915173530578613, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bbdbfb-0001-b55a-0002-47d20009a06e"}, "message": null, "failures": 0, "unique_id": "test.snowflake_instabee.source_relationships_instabee_ORDERS_REGION__REGION__source_instabee_PEOPLE_.83bfea9f9b", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select REGION as from_field\n    from INSTABEE.PUBLIC.ORDERS\n    where REGION is not null\n),\n\nparent as (\n    select REGION as to_field\n    from INSTABEE.PUBLIC.PEOPLE\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-04-22T12:47:15.769380Z", "completed_at": "2025-04-22T12:47:15.776768Z"}, {"name": "execute", "started_at": "2025-04-22T12:47:15.777770Z", "completed_at": "2025-04-22T12:47:15.967986Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.20084571838378906, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bbdbfb-0001-b58f-0002-47d200094092"}, "message": null, "failures": 0, "unique_id": "test.snowflake_instabee.source_relationships_instabee_RETURNS_ORDER_ID__ORDER_ID__source_instabee_ORDERS_.6d2dc65aa4", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select ORDER_ID as from_field\n    from INSTABEE.PUBLIC.RETURNS\n    where ORDER_ID is not null\n),\n\nparent as (\n    select ORDER_ID as to_field\n    from INSTABEE.PUBLIC.ORDERS\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-04-22T12:47:15.973354Z", "completed_at": "2025-04-22T12:47:15.980711Z"}, {"name": "execute", "started_at": "2025-04-22T12:47:15.980711Z", "completed_at": "2025-04-22T12:47:16.488073Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.5171229839324951, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bbdbfb-0001-b58c-0002-47d200097066"}, "message": null, "failures": 0, "unique_id": "test.snowflake_instabee.not_null_my_first_dbt_model_id.5fb22c2710", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect id\nfrom PC_DBT_DB.DBT_.my_first_dbt_model\nwhere id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-04-22T12:47:16.493866Z", "completed_at": "2025-04-22T12:47:16.504405Z"}, {"name": "execute", "started_at": "2025-04-22T12:47:16.505671Z", "completed_at": "2025-04-22T12:47:17.075133Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.5826284885406494, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bbdbfb-0001-b590-0002-47d20009808a"}, "message": null, "failures": 0, "unique_id": "test.snowflake_instabee.unique_my_first_dbt_model_id.16e066b321", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    id as unique_field,\n    count(*) as n_records\n\nfrom (select * from PC_DBT_DB.DBT_.my_first_dbt_model where id is not null) dbt_subquery\nwhere id is not null\ngroup by id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-22T12:47:17.082132Z", "completed_at": "2025-04-22T12:47:17.091264Z"}, {"name": "execute", "started_at": "2025-04-22T12:47:17.092269Z", "completed_at": "2025-04-22T12:47:17.620675Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.5405423641204834, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bbdbfb-0001-b547-0002-47d20009b076"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.snowflake_instabee.stg_instabee_orders", "compiled": true, "compiled_code": "with source as (\n\n    select * from INSTABEE.PUBLIC.ORDERS\n\n),\n\nrenamed as (\n\n    select \nmd5(cast(coalesce(cast(ORDER_ID as TEXT), '') || '-' || coalesce(cast(PRODUCT_ID as TEXT), '') || '-' || coalesce(cast(ROW_ID as TEXT), '') as TEXT)) as ORDER_LINE_ID,\nROW_ID,\nORDER_ID,\t\nORDERDATE AS ORDER_DATE,\nSHIPDATE AS SHIP_DATE,\t\nSHIP_MODE,\t\nCUSTOMER_ID,\t\nCUSTOMER_NAME,\t\nSEGMENT,\nCOUNTRY,\nCITY,\nSTATE,\t\nPOSTAL_CODE,\t\nREGION,\t\nPRODUCT_ID,\t\nCATEGORY as PRODUCT_CATEGORY,\t\nSUB_CATEGORY,\t\nPRODUCT_NAME,\t\nSALES,\t\nQUANTITY,\t\nDISCOUNT,\t\nPROFIT\n\n\n    from source\n\n)\n\nselect * from renamed", "relation_name": "PC_DBT_DB.DBT_.stg_instabee_orders", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-22T12:47:17.627053Z", "completed_at": "2025-04-22T12:47:17.632053Z"}, {"name": "execute", "started_at": "2025-04-22T12:47:17.633979Z", "completed_at": "2025-04-22T12:47:17.825898Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.20084667205810547, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bbdbfb-0001-b582-0002-47d20009606a"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.snowflake_instabee.my_second_dbt_model", "compiled": true, "compiled_code": "-- Use the `ref` function to select from other models\n\nselect *\nfrom PC_DBT_DB.DBT_.my_first_dbt_model\nwhere id = 1", "relation_name": "PC_DBT_DB.DBT_.my_second_dbt_model", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-22T12:47:17.832360Z", "completed_at": "2025-04-22T12:47:17.838155Z"}, {"name": "execute", "started_at": "2025-04-22T12:47:17.839648Z", "completed_at": "2025-04-22T12:47:19.474690Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.6455461978912354, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bbdbfb-0001-b55a-0002-47d20009a072"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.snowflake_instabee.dim_customers", "compiled": true, "compiled_code": "SELECT DISTINCT\n    customer_id,\n    customer_name,\n    segment\nFROM PC_DBT_DB.DBT_.stg_instabee_orders", "relation_name": "PC_DBT_DB.DBT_.dim_customers", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-22T12:47:19.483114Z", "completed_at": "2025-04-22T12:47:19.489126Z"}, {"name": "execute", "started_at": "2025-04-22T12:47:19.490143Z", "completed_at": "2025-04-22T12:47:20.870560Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.3910577297210693, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bbdbfb-0001-b51e-0002-47d20008e126"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.snowflake_instabee.dim_products", "compiled": true, "compiled_code": "WITH ranked_products AS (\n  SELECT\n    product_id,\n    product_name,\n    product_category,\n    sub_category,\n    ROW_NUMBER() OVER (\n      PARTITION BY product_id \n      ORDER BY product_category NULLS LAST, sub_category NULLS LAST, product_name NULLS LAST\n    ) as rn\n  FROM PC_DBT_DB.DBT_.stg_instabee_orders\n  WHERE product_id IS NOT NULL\n  GROUP BY product_id, product_name, product_category, sub_category\n)\n\nSELECT\n  product_id,\n  product_name,\n  product_category,\n  sub_category\nFROM ranked_products\nWHERE rn = 1", "relation_name": "PC_DBT_DB.DBT_.dim_products", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-22T12:47:20.877201Z", "completed_at": "2025-04-22T12:47:20.886611Z"}, {"name": "execute", "started_at": "2025-04-22T12:47:20.887632Z", "completed_at": "2025-04-22T12:47:22.266628Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.3909168243408203, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bbdbfb-0001-b582-0002-47d20009606e"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.snowflake_instabee.dim_regions", "compiled": true, "compiled_code": "SELECT DISTINCT\n    r.region,\n    r.state,\n    p.regional_manager\nFROM PC_DBT_DB.DBT_.stg_instabee_orders r\nLEFT JOIN PC_DBT_DB.DBT_.stg_instabee_people p\n    ON r.region = p.region", "relation_name": "PC_DBT_DB.DBT_.dim_regions", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-22T12:47:22.273030Z", "completed_at": "2025-04-22T12:47:22.278172Z"}, {"name": "execute", "started_at": "2025-04-22T12:47:22.279540Z", "completed_at": "2025-04-22T12:47:24.054745Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.784053087234497, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bbdbfb-0001-b58f-0002-47d20009409a"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.snowflake_instabee.fact_sales", "compiled": true, "compiled_code": "WITH base AS (\n    SELECT\n        o.order_line_id,\n        o.order_id,\n        o.order_date,\n        o.ship_date,\n        o.ship_mode,\n        o.customer_id,\n        o.product_id,\n        o.country,\n        o.region,\n        o.state,\n        o.sales,\n        o.quantity,\n        o.discount,\n        o.profit,\n        r.returned\n    FROM PC_DBT_DB.DBT_.stg_instabee_orders o\n    LEFT JOIN PC_DBT_DB.DBT_.stg_instabee_returns r\n        ON o.order_id = r.order_id\n)\n\nSELECT *\nFROM base", "relation_name": "PC_DBT_DB.DBT_.fact_sales", "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-04-22T12:47:24.060200Z", "completed_at": "2025-04-22T12:47:24.067070Z"}, {"name": "execute", "started_at": "2025-04-22T12:47:24.068451Z", "completed_at": "2025-04-22T12:47:24.236669Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.1776869297027588, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bbdbfb-0001-b590-0002-47d200098092"}, "message": null, "failures": 0, "unique_id": "test.snowflake_instabee.not_null_my_second_dbt_model_id.151b76d778", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect id\nfrom PC_DBT_DB.DBT_.my_second_dbt_model\nwhere id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-04-22T12:47:24.242606Z", "completed_at": "2025-04-22T12:47:24.251473Z"}, {"name": "execute", "started_at": "2025-04-22T12:47:24.252565Z", "completed_at": "2025-04-22T12:47:24.659408Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.41838788986206055, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bbdbfb-0001-b51e-0002-47d20008e12a"}, "message": null, "failures": 0, "unique_id": "test.snowflake_instabee.unique_my_second_dbt_model_id.57a0f8c493", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    id as unique_field,\n    count(*) as n_records\n\nfrom PC_DBT_DB.DBT_.my_second_dbt_model\nwhere id is not null\ngroup by id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-04-22T12:47:24.668230Z", "completed_at": "2025-04-22T12:47:24.668230Z"}, {"name": "execute", "started_at": "2025-04-22T12:47:24.668230Z", "completed_at": "2025-04-22T12:47:25.182852Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.5197834968566895, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bbdbfb-0001-b529-0002-47d20008d0f2"}, "message": null, "failures": 0, "unique_id": "test.snowflake_instabee.not_null_dim_customers_customer_id.dd91cd1c8d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_id\nfrom PC_DBT_DB.DBT_.dim_customers\nwhere customer_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-04-22T12:47:25.182852Z", "completed_at": "2025-04-22T12:47:25.199381Z"}, {"name": "execute", "started_at": "2025-04-22T12:47:25.199381Z", "completed_at": "2025-04-22T12:47:25.745427Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.5625755786895752, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bbdbfb-0001-b547-0002-47d20009b07e"}, "message": null, "failures": 0, "unique_id": "test.snowflake_instabee.unique_dim_customers_customer_id.15c9f1e2fd", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    customer_id as unique_field,\n    count(*) as n_records\n\nfrom PC_DBT_DB.DBT_.dim_customers\nwhere customer_id is not null\ngroup by customer_id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-04-22T12:47:25.753761Z", "completed_at": "2025-04-22T12:47:25.760827Z"}, {"name": "execute", "started_at": "2025-04-22T12:47:25.760827Z", "completed_at": "2025-04-22T12:47:26.229037Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.47730231285095215, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bbdbfb-0001-b514-0002-47d20008c0fa"}, "message": null, "failures": 0, "unique_id": "test.snowflake_instabee.not_null_dim_products_product_id.c8aba288d1", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect product_id\nfrom PC_DBT_DB.DBT_.dim_products\nwhere product_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-04-22T12:47:26.234714Z", "completed_at": "2025-04-22T12:47:26.244264Z"}, {"name": "execute", "started_at": "2025-04-22T12:47:26.245628Z", "completed_at": "2025-04-22T12:47:26.648200Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.41587066650390625, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bbdbfb-0001-b582-0002-47d200096072"}, "message": null, "failures": 0, "unique_id": "test.snowflake_instabee.unique_dim_products_product_id.ef7b2a9985", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    product_id as unique_field,\n    count(*) as n_records\n\nfrom PC_DBT_DB.DBT_.dim_products\nwhere product_id is not null\ngroup by product_id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-04-22T12:47:26.652632Z", "completed_at": "2025-04-22T12:47:26.735980Z"}, {"name": "execute", "started_at": "2025-04-22T12:47:26.737568Z", "completed_at": "2025-04-22T12:47:27.212616Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.5613465309143066, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bbdbfb-0001-b50d-0002-47d200089b42"}, "message": null, "failures": 0, "unique_id": "test.snowflake_instabee.not_null_dim_regions_region.935ece66be", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect region\nfrom PC_DBT_DB.DBT_.dim_regions\nwhere region is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-04-22T12:47:27.217215Z", "completed_at": "2025-04-22T12:47:27.218656Z"}, {"name": "execute", "started_at": "2025-04-22T12:47:27.218656Z", "completed_at": "2025-04-22T12:47:27.424181Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.20928001403808594, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bbdbfb-0001-b507-0002-47d2000810fa"}, "message": null, "failures": 0, "unique_id": "test.snowflake_instabee.not_null_fact_sales_order_id.f6f073d70b", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect order_id\nfrom PC_DBT_DB.DBT_.fact_sales\nwhere order_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-04-22T12:47:27.430310Z", "completed_at": "2025-04-22T12:47:27.437396Z"}, {"name": "execute", "started_at": "2025-04-22T12:47:27.438717Z", "completed_at": "2025-04-22T12:47:27.751155Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.3226346969604492, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bbdbfb-0001-b55a-0002-47d20009a07a"}, "message": null, "failures": 0, "unique_id": "test.snowflake_instabee.not_null_fact_sales_order_line_id.224e5eff48", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect order_line_id\nfrom PC_DBT_DB.DBT_.fact_sales\nwhere order_line_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-04-22T12:47:27.759217Z", "completed_at": "2025-04-22T12:47:27.767732Z"}, {"name": "execute", "started_at": "2025-04-22T12:47:27.767732Z", "completed_at": "2025-04-22T12:47:28.219649Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.46271204948425293, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bbdbfb-0001-b58f-0002-47d20009409e"}, "message": null, "failures": 0, "unique_id": "test.snowflake_instabee.unique_fact_sales_order_line_id.317c4be9bd", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    order_line_id as unique_field,\n    count(*) as n_records\n\nfrom PC_DBT_DB.DBT_.fact_sales\nwhere order_line_id is not null\ngroup by order_line_id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-22T12:47:28.225276Z", "completed_at": "2025-04-22T12:47:28.232298Z"}, {"name": "execute", "started_at": "2025-04-22T12:47:28.232298Z", "completed_at": "2025-04-22T12:47:29.308898Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.084627389907837, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bbdbfb-0001-b51e-0002-47d20008e12e"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.snowflake_instabee.month_on_month_change", "compiled": true, "compiled_code": "SELECT\n    DATE_TRUNC('month', order_date) AS order_month,\n    SUM(sales) AS total_sales,\n    LAG(SUM(sales)) OVER (ORDER BY DATE_TRUNC('month', order_date)) AS previous_month_sales,\n    SUM(sales) - LAG(SUM(sales)) OVER (ORDER BY DATE_TRUNC('month', order_date)) AS change_in_sales\nFROM PC_DBT_DB.DBT_.fact_sales\nWHERE EXTRACT(YEAR FROM order_date) = 2019\nGROUP BY 1", "relation_name": "PC_DBT_DB.DBT_.month_on_month_change", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-22T12:47:29.315937Z", "completed_at": "2025-04-22T12:47:29.323084Z"}, {"name": "execute", "started_at": "2025-04-22T12:47:29.324233Z", "completed_at": "2025-04-22T12:47:30.557581Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.2436630725860596, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bbdbfb-0001-b582-0002-47d200096076"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.snowflake_instabee.monthly_returns_per_category", "compiled": true, "compiled_code": "select * from (SELECT\n    DATE_TRUNC('month', s.order_date) AS order_month,\n    p.product_category,P.SUB_CATEGORY,\n    COUNT(CASE WHEN s.order_id IS NOT NULL and s.returned = 'Yes' THEN 1 END) AS returned_orders\nFROM PC_DBT_DB.DBT_.fact_sales s\nJOIN PC_DBT_DB.DBT_.dim_products p\n    ON s.product_id = p.product_id\nWHERE EXTRACT(YEAR FROM s.order_date) = 2019\nGROUP BY 1, 2,3\nORDER BY 4 DESC)\nWHERE returned_orders <>0", "relation_name": "PC_DBT_DB.DBT_.monthly_returns_per_category", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-22T12:47:30.565017Z", "completed_at": "2025-04-22T12:47:30.570052Z"}, {"name": "execute", "started_at": "2025-04-22T12:47:30.571094Z", "completed_at": "2025-04-22T12:47:31.859816Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.296818733215332, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bbdbfb-0001-b590-0002-47d20009809a"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.snowflake_instabee.sales_growth_per_category", "compiled": true, "compiled_code": "SELECT\n    DATE_TRUNC('month', s.order_date) AS order_month,\n    p.product_category,\n    SUM(s.sales) AS monthly_sales,\n    LAG(SUM(s.sales)) OVER (PARTITION BY p.product_category ORDER BY DATE_TRUNC('month', s.order_date)) AS previous_month_sales,\n    (SUM(s.sales) - LAG(SUM(s.sales)) OVER (PARTITION BY p.product_category ORDER BY DATE_TRUNC('month', s.order_date))) /\n        NULLIF(LAG(SUM(s.sales)) OVER (PARTITION BY p.product_category ORDER BY DATE_TRUNC('month', s.order_date)), 0) AS growth_rate\nFROM PC_DBT_DB.DBT_.fact_sales s\nJOIN PC_DBT_DB.DBT_.dim_products p\n    ON s.product_id = p.product_id\nWHERE EXTRACT(YEAR FROM order_date) = 2019\nGROUP BY 1, 2", "relation_name": "PC_DBT_DB.DBT_.sales_growth_per_category", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-22T12:47:31.866289Z", "completed_at": "2025-04-22T12:47:31.871316Z"}, {"name": "execute", "started_at": "2025-04-22T12:47:31.872686Z", "completed_at": "2025-04-22T12:47:33.214551Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.3492701053619385, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bbdbfb-0001-b514-0002-47d20008c102"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.snowflake_instabee.sales_over_time", "compiled": true, "compiled_code": "WITH monthly_sales AS (\n  SELECT\n      DATE_TRUNC('month', order_date) AS order_month,\n      p.product_category,\n      SUM(s.sales) AS category_sales\n  FROM PC_DBT_DB.DBT_.fact_sales s\n  JOIN PC_DBT_DB.DBT_.dim_products p\n      ON s.product_id = p.product_id\n  WHERE EXTRACT(YEAR FROM order_date) = 2019\n  GROUP BY 1, 2\n),\n\nmonthly_totals AS (\n  SELECT\n      order_month,\n      SUM(category_sales) AS total_monthly_sales\n  FROM monthly_sales\n  GROUP BY 1\n)\n\nSELECT\n    ms.order_month,\n    ms.product_category,\n    ms.category_sales,\n    ROUND(ms.category_sales * 100.0 / mt.total_monthly_sales, 2) AS sales_percentage\nFROM monthly_sales ms\nJOIN monthly_totals mt\n    ON ms.order_month = mt.order_month\nORDER BY 1, 4 DESC", "relation_name": "PC_DBT_DB.DBT_.sales_over_time", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-22T12:47:33.219850Z", "completed_at": "2025-04-22T12:47:33.305418Z"}, {"name": "execute", "started_at": "2025-04-22T12:47:33.306418Z", "completed_at": "2025-04-22T12:47:34.561481Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.3426308631896973, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01bbdbfb-0001-b55a-0002-47d20009a082"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.snowflake_instabee.top_selling_states_and_regions", "compiled": true, "compiled_code": "WITH monthly_region_sales AS(SELECT\nDATE_TRUNC('month', order_date) AS order_month,\n    s.region,\n    s.state,\n    d.regional_manager,\n    SUM(s.sales) AS region_sales\nFROM PC_DBT_DB.DBT_.fact_sales s\nLEFT JOIN PC_DBT_DB.DBT_.dim_regions d\n    ON s.region = d.region AND s.state = d.state\nWHERE EXTRACT(YEAR FROM s.order_date) = 2019\nGROUP BY 1, 2, 3,4\nORDER BY region_sales DESC),\n\nmonthly_totals AS (\n  SELECT\n      order_month,\n      SUM(region_sales) AS total_monthly_sales\n  FROM monthly_region_sales\n  GROUP BY 1\n),\n\nranked_regions AS (\n  SELECT\n      mrs.*,\n      mt.total_monthly_sales,\n      ROUND(mrs.region_sales * 100.0 / mt.total_monthly_sales, 2) AS sales_percentage,\n      ROW_NUMBER() OVER (PARTITION BY mrs.order_month ORDER BY mrs.region_sales DESC) AS region_rank\n  FROM monthly_region_sales mrs\n  JOIN monthly_totals mt\n      ON mrs.order_month = mt.order_month\n  WHERE mrs.order_month IS NOT NULL\n)\n\nSELECT\n    order_month,\n    region AS top_region,\n    state AS top_state,\n    regional_manager,\n    region_sales,\n    sales_percentage\nFROM ranked_regions\nWHERE region_rank = 1\nORDER BY order_month DESC", "relation_name": "PC_DBT_DB.DBT_.top_selling_states_and_regions", "batch_results": null}], "elapsed_time": 23.845285415649414, "args": {"log_level_file": "debug", "profiles_dir": "C:\\Users\\Venee\\.dbt", "strict_mode": false, "select": [], "source_freshness_run_project_hooks": false, "skip_nodes_if_on_run_start_fails": false, "log_path": "E:\\desk\\onedrive\\Desktop\\snowflake_instabee\\logs", "invocation_command": "dbt build", "log_file_max_bytes": 10485760, "defer": false, "introspect": true, "vars": {}, "macro_debugging": false, "warn_error_options": {"include": [], "exclude": []}, "exclude": [], "require_yaml_configuration_for_mf_time_spines": false, "use_colors": true, "require_batched_execution_for_custom_microbatch_strategy": false, "use_colors_file": true, "static_parser": true, "cache_selected_only": false, "export_saved_queries": false, "favor_state": false, "exclude_resource_types": [], "partial_parse": true, "populate_cache": true, "project_dir": "E:\\desk\\onedrive\\Desktop\\snowflake_instabee", "state_modified_compare_more_unrendered_values": false, "require_nested_cumulative_type_params": false, "partial_parse_file_diff": true, "printer_width": 80, "include_saved_query": false, "resource_types": [], "which": "build", "write_json": true, "quiet": false, "indirect_selection": "eager", "print": true, "require_resource_names_without_spaces": false, "log_level": "info", "log_format_file": "debug", "show_resource_report": false, "state_modified_compare_vars": false, "version_check": true, "log_format": "default", "empty": false, "require_explicit_package_overrides_for_builtin_materializations": true, "send_anonymous_usage_stats": true, "show": false}}